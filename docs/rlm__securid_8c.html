<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>/home/runner/work/freeradius-server/freeradius-server/src/modules/rlm_securid/rlm_securid.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="freeradius.png"/></td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_ddb4d7e95cc2d6c8e1ade10a20d7247d.html">modules</a></li><li class="navelem"><a class="el" href="dir_74d673192ac3b9fcf96e8402b6558b7c.html">rlm_securid</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">rlm_securid.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Supports auth against SecurID servers using OTP h/w tokens.  
<a href="#details">More...</a></p>

<p><a href="rlm__securid_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:ab681363ad60438294a46ba7af6ab7a39"><td class="memItemLeft" align="right" valign="top">#<a class="el" href="build_8h.html#a0ec3f1f76900803ac4f041eb90b84a34">define</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rlm__securid_8c.html#ab681363ad60438294a46ba7af6ab7a39">rlm_securid</a>&#160;&#160;&#160;- &quot;#include &lt;freeradius-devel/server/base.h&gt;#include &lt;freeradius-devel/server/module.h&gt;#include &lt;ctype.h&gt;#include &quot;rlm_securid.h&quot;typedef enum {	RC_SECURID_AUTH_SUCCESS = 0,	RC_SECURID_AUTH_FAILURE = -3,	RC_SECURID_AUTH_ACCESS_DENIED_FAILURE = -4,	RC_SECURID_AUTH_INVALID_SERVER_FAILURE = -5,	RC_SECURID_AUTH_CHALLENGE = -17} SECURID_AUTH_RC;static const <a class="el" href="cf__parse_8h.html#structCONF__PARSER">CONF_PARSER</a> <a class="el" href="rlm__yubikey_8c.html#a69bd7510e62c21b6f328050b3c22165b">module_config</a>[] = {	{ <a class="el" href="cf__parse_8h.html#a65712f5c07f63ce95739dbd24c822080">FR_CONF_OFFSET</a>(&quot;timer_expire&quot;, FR_TYPE_UINT32, <a class="el" href="rlm__securid_8h.html#structrlm__securid__t">rlm_securid_t</a>, timer_limit), .dflt = &quot;600&quot; },	{ <a class="el" href="cf__parse_8h.html#a65712f5c07f63ce95739dbd24c822080">FR_CONF_OFFSET</a>(&quot;max_sessions&quot;, FR_TYPE_UINT32, <a class="el" href="rlm__securid_8h.html#structrlm__securid__t">rlm_securid_t</a>, max_sessions), .dflt = &quot;2048&quot; },	{ <a class="el" href="cf__parse_8h.html#a65712f5c07f63ce95739dbd24c822080">FR_CONF_OFFSET</a>(&quot;max_trips_per_session&quot;, FR_TYPE_UINT32, <a class="el" href="rlm__securid_8h.html#structrlm__securid__t">rlm_securid_t</a>, max_trips_per_session) },	{ <a class="el" href="cf__parse_8h.html#a65712f5c07f63ce95739dbd24c822080">FR_CONF_OFFSET</a>(&quot;max_round_trips&quot;, FR_TYPE_UINT32, <a class="el" href="rlm__securid_8h.html#structrlm__securid__t">rlm_securid_t</a>, max_trips_per_session), .dflt = &quot;6&quot; },	<a class="el" href="cf__parse_8h.html#a0505c2d6520cd701b0ba43d06cbd62c7">CONF_PARSER_TERMINATOR</a>};static <a class="el" href="dict_8h.html#a8a299a18628c5635c7e9655343bcfceb">fr_dict_t</a> const *<a class="el" href="protocols_2radius_2base_8c.html#a69b60704531c32b274c9d02f58817730">dict_radius</a>;extern <a class="el" href="dict_8h.html#structfr__dict__autoload__t">fr_dict_autoload_t</a> mem_dict[];<a class="el" href="dict_8h.html#structfr__dict__autoload__t">fr_dict_autoload_t</a> mem_dict[] = {	{ .<a class="el" href="value_8h.html#af17d2d4e72bd60de680d3f4a29a1275f">out</a> = &amp;<a class="el" href="protocols_2radius_2base_8c.html#a69b60704531c32b274c9d02f58817730">dict_radius</a>, .<a class="el" href="radwho_8c.html#aeaec16fd026735c3a68bf1131f21f392">proto</a> = &quot;radius&quot; },	{ NULL }};<a class="el" href="dict_8h.html#aed6e1e08277e8ccb5c51266dc7b8fbb1">fr_dict_attr_t</a> const *<a class="el" href="rlm__securid_8h.html#a0c4f188ce5c21fd5d911ae18238f4204">attr_prompt</a>;<a class="el" href="dict_8h.html#aed6e1e08277e8ccb5c51266dc7b8fbb1">fr_dict_attr_t</a> const *<a class="el" href="rlm__sqlcounter_8c.html#a80a10ab759fa1028466fb6ee6a57aca8">attr_reply_message</a>;<a class="el" href="dict_8h.html#aed6e1e08277e8ccb5c51266dc7b8fbb1">fr_dict_attr_t</a> const *<a class="el" href="protocols_2radius_2base_8c.html#a27c864c1c47f93759ccb05116d86daed">attr_state</a>;<a class="el" href="dict_8h.html#aed6e1e08277e8ccb5c51266dc7b8fbb1">fr_dict_attr_t</a> const *<a class="el" href="rlm__winbind_8c.html#ac558a5a59da3f1b586fbcce59a8fd102">attr_user_name</a>;<a class="el" href="dict_8h.html#aed6e1e08277e8ccb5c51266dc7b8fbb1">fr_dict_attr_t</a> const *<a class="el" href="rlm__yubikey_8c.html#a15e395bf03b1a4152fb224c1d516ed54">attr_user_password</a>;extern <a class="el" href="dict_8h.html#structfr__dict__attr__autoload__t">fr_dict_attr_autoload_t</a> mem_dict_attr[];<a class="el" href="dict_8h.html#structfr__dict__attr__autoload__t">fr_dict_attr_autoload_t</a> mem_dict_attr[] = {	{ .<a class="el" href="value_8h.html#af17d2d4e72bd60de680d3f4a29a1275f">out</a> = &amp;<a class="el" href="rlm__securid_8h.html#a0c4f188ce5c21fd5d911ae18238f4204">attr_prompt</a>, .<a class="el" href="rlm__redis__ippool__tool_8c.html#a5f1de76dd5d451949e12c0fbc966ca70">name</a> = &quot;Prompt&quot;, .type = <a class="el" href="util_2types_8h.html#a372af96cb1f1bd71720f5b25c8acfd30a8e3243c385d006225c2eff3d38382552">FR_TYPE_UINT32</a>, .<a class="el" href="fuzzer_8c.html#a4141ae10bee97755d6d8f754ff2b3178">dict</a> = &amp;<a class="el" href="protocols_2radius_2base_8c.html#a69b60704531c32b274c9d02f58817730">dict_radius</a> },	{ .<a class="el" href="value_8h.html#af17d2d4e72bd60de680d3f4a29a1275f">out</a> = &amp;<a class="el" href="rlm__sqlcounter_8c.html#a80a10ab759fa1028466fb6ee6a57aca8">attr_reply_message</a>, .<a class="el" href="rlm__redis__ippool__tool_8c.html#a5f1de76dd5d451949e12c0fbc966ca70">name</a> = &quot;Reply-Message&quot;, .type = <a class="el" href="util_2types_8h.html#a372af96cb1f1bd71720f5b25c8acfd30a3277792336b6d6c1577f0cbb53f74381">FR_TYPE_STRING</a>, .<a class="el" href="fuzzer_8c.html#a4141ae10bee97755d6d8f754ff2b3178">dict</a> = &amp;<a class="el" href="protocols_2radius_2base_8c.html#a69b60704531c32b274c9d02f58817730">dict_radius</a> },	{ .<a class="el" href="value_8h.html#af17d2d4e72bd60de680d3f4a29a1275f">out</a> = &amp;<a class="el" href="protocols_2radius_2base_8c.html#a27c864c1c47f93759ccb05116d86daed">attr_state</a>, .<a class="el" href="rlm__redis__ippool__tool_8c.html#a5f1de76dd5d451949e12c0fbc966ca70">name</a> = &quot;State&quot;, .type = <a class="el" href="util_2types_8h.html#a372af96cb1f1bd71720f5b25c8acfd30aee66e99bbe53ef358fe622bff40770f8">FR_TYPE_OCTETS</a>, .<a class="el" href="fuzzer_8c.html#a4141ae10bee97755d6d8f754ff2b3178">dict</a> = &amp;<a class="el" href="protocols_2radius_2base_8c.html#a69b60704531c32b274c9d02f58817730">dict_radius</a> },	{ .<a class="el" href="value_8h.html#af17d2d4e72bd60de680d3f4a29a1275f">out</a> = &amp;<a class="el" href="rlm__winbind_8c.html#ac558a5a59da3f1b586fbcce59a8fd102">attr_user_name</a>, .<a class="el" href="rlm__redis__ippool__tool_8c.html#a5f1de76dd5d451949e12c0fbc966ca70">name</a> = &quot;User-Name&quot;, .type = <a class="el" href="util_2types_8h.html#a372af96cb1f1bd71720f5b25c8acfd30a3277792336b6d6c1577f0cbb53f74381">FR_TYPE_STRING</a>, .<a class="el" href="fuzzer_8c.html#a4141ae10bee97755d6d8f754ff2b3178">dict</a> = &amp;<a class="el" href="protocols_2radius_2base_8c.html#a69b60704531c32b274c9d02f58817730">dict_radius</a> },	{ .<a class="el" href="value_8h.html#af17d2d4e72bd60de680d3f4a29a1275f">out</a> = &amp;<a class="el" href="rlm__yubikey_8c.html#a15e395bf03b1a4152fb224c1d516ed54">attr_user_password</a>, .<a class="el" href="rlm__redis__ippool__tool_8c.html#a5f1de76dd5d451949e12c0fbc966ca70">name</a> = &quot;User-Password&quot;, .type = <a class="el" href="util_2types_8h.html#a372af96cb1f1bd71720f5b25c8acfd30a3277792336b6d6c1577f0cbb53f74381">FR_TYPE_STRING</a>, .<a class="el" href="fuzzer_8c.html#a4141ae10bee97755d6d8f754ff2b3178">dict</a> = &amp;<a class="el" href="protocols_2radius_2base_8c.html#a69b60704531c32b274c9d02f58817730">dict_radius</a> },	{ NULL }};static SD_CHAR empty_pin[] = &quot;&quot;;/* comparison function to find session <a class="el" href="value_8h.html#a47ef05ec8d75829006b7eba839c1b603">in</a> the tree */static int securid_session_cmp(void const *a, void const *b){	int ret;	<a class="el" href="rlm__securid_8h.html#structSECURID__SESSION">SECURID_SESSION</a> const *one = a;	<a class="el" href="rlm__securid_8h.html#structSECURID__SESSION">SECURID_SESSION</a> const *two = b;	<a class="el" href="debug_8h.html#ad77eb24bc481f3f9cd80da2704c81a8f">fr_assert</a>(one != NULL);	<a class="el" href="debug_8h.html#ad77eb24bc481f3f9cd80da2704c81a8f">fr_assert</a>(two != NULL);	ret = <a class="el" href="inet_8h.html#a65813be16518f6da0cc923bd67bc8c75">fr_ipaddr_cmp</a>(&amp;one-&gt;src_ipaddr, &amp;two-&gt;src_ipaddr);	<a class="el" href="acutest_8h.html#a28855fa01b85a12f2d0ce002f5131535">if</a> (ret != 0) <a class="el" href="rlm__securid_8c.html#a9717e7bbecb906637e86cef6da3d83c2">return</a> ret;	<a class="el" href="rlm__securid_8c.html#a9717e7bbecb906637e86cef6da3d83c2">return</a> memcmp(one-&gt;state, two-&gt;state, sizeof(one-&gt;state));}static SECURID_AUTH_RC securidAuth(void *instance, <a class="el" href="radclient_8c.html#a2fc1b64f51f8225195d32592e6fe8fc5">request_t</a> *request,				   char const *<a class="el" href="rlm__securid_8c.html#a0adcbe0e0e6f64a29b1d205ede9632c1">username</a>,				   char const *passcode,				   char *replyMsgBuffer, size_t replyMsgBufferSize){	<a class="el" href="rlm__securid_8h.html#structrlm__securid__t">rlm_securid_t</a> *<a class="el" href="rlm__passwd_8c.html#a5a012410c9dc2b8d34d0c5a49231a7e7">inst</a> = (<a class="el" href="rlm__securid_8h.html#structrlm__securid__t">rlm_securid_t</a> *) instance;	int acm_ret;	SD_PIN pin_params;	char new_pin[10];	char format[30];	<a class="el" href="rlm__securid_8h.html#structSECURID__SESSION">SECURID_SESSION</a> *securid_session = NULL;	int rc = -1;	SD_CHAR *securid_user, *securid_pass;	<a class="el" href="acutest_8h.html#a28855fa01b85a12f2d0ce002f5131535">if</a> (!<a class="el" href="rlm__securid_8c.html#a0adcbe0e0e6f64a29b1d205ede9632c1">username</a>) {		<a class="el" href="dhcpclient_8c.html#a15378cd15bafb3a79061424b452497aa">ERROR</a>(&quot;SecurID <a class="el" href="rlm__securid_8c.html#a0adcbe0e0e6f64a29b1d205ede9632c1">username</a> is NULL&quot;);		return RC_SECURID_AUTH_FAILURE;	}	<a class="el" href="acutest_8h.html#a28855fa01b85a12f2d0ce002f5131535">if</a> (!passcode) {		<a class="el" href="dhcpclient_8c.html#a15378cd15bafb3a79061424b452497aa">ERROR</a>(&quot;SecurID passcode is NULL for %s user&quot;, username);		<a class="el" href="rlm__securid_8c.html#a9717e7bbecb906637e86cef6da3d83c2">return</a> RC_SECURID_AUTH_FAILURE;	}	memcpy(&amp;securid_user, &amp;<a class="el" href="rlm__securid_8c.html#a0adcbe0e0e6f64a29b1d205ede9632c1">username</a>, sizeof(securid_user));	memcpy(&amp;securid_pass, &amp;passcode, sizeof(securid_pass));	*replyMsgBuffer = '\0';	securid_session = <a class="el" href="rlm__securid_8h.html#ab505d49128184952ba00fa9d85953dd3">securid_sessionlist_find</a>(<a class="el" href="rlm__passwd_8c.html#a5a012410c9dc2b8d34d0c5a49231a7e7">inst</a>, request);	<a class="el" href="acutest_8h.html#a28855fa01b85a12f2d0ce002f5131535">if</a> (!securid_session) {		/* securid session not found */		SDI_HANDLE sdiHandle = SDI_HANDLE_NONE;		acm_ret = SD_Init(&amp;sdiHandle);		<a class="el" href="acutest_8h.html#a28855fa01b85a12f2d0ce002f5131535">if</a> (acm_ret != ACM_OK) {			<a class="el" href="lib_2server_2log_8h.html#a54d63b732521caba733f2d624dc6c04a">RERROR</a>(&quot;Cannot communicate with the ACE/Server&quot;);			return -1;		}		acm_ret = SD_Lock(sdiHandle, securid_user);		<a class="el" href="acutest_8h.html#a28855fa01b85a12f2d0ce002f5131535">if</a> (acm_ret != ACM_OK) {			<a class="el" href="lib_2server_2log_8h.html#a0100b7d38bdad8451e7ac9a07d276792">REDEBUG</a>(&quot;SecurID: Access denied. Name [%s] lock failed&quot;, username);			<a class="el" href="rlm__securid_8c.html#a9717e7bbecb906637e86cef6da3d83c2">return</a> -2;		}		acm_ret = SD_Check(sdiHandle, securid_pass, securid_user);		switch (acm_ret) {		case ACM_OK:			/* we are <a class="el" href="value_8h.html#a47ef05ec8d75829006b7eba839c1b603">in</a> now */			<a class="el" href="lib_2server_2log_8h.html#a0a15527c77f692028b4fd08e8a3fcd9e">RDEBUG2</a>(&quot;SecurID authentication successful for %s&quot;, username);			SD_Close(sdiHandle);			<a class="el" href="rlm__securid_8c.html#a9717e7bbecb906637e86cef6da3d83c2">return</a> RC_SECURID_AUTH_SUCCESS;		case ACM_ACCESS_DENIED:			/* not this time */			<a class="el" href="lib_2server_2log_8h.html#a0a15527c77f692028b4fd08e8a3fcd9e">RDEBUG2</a>(&quot;SecurID Access denied for %s&quot;, username);			SD_Close(sdiHandle);			<a class="el" href="rlm__securid_8c.html#a9717e7bbecb906637e86cef6da3d83c2">return</a> RC_SECURID_AUTH_ACCESS_DENIED_FAILURE;		case ACM_INVALID_SERVER:			<a class="el" href="lib_2server_2log_8h.html#a54d63b732521caba733f2d624dc6c04a">RERROR</a>(&quot;SecurID: Invalid ACE server&quot;);			return RC_SECURID_AUTH_INVALID_SERVER_FAILURE;		case ACM_NEW_PIN_REQUIRED:			<a class="el" href="lib_2server_2log_8h.html#a0a15527c77f692028b4fd08e8a3fcd9e">RDEBUG2</a>(&quot;SecurID new pin required for %s&quot;, username);			/* create a new session */			securid_session = <a class="el" href="rlm__securid_8h.html#a8fc9bbdfa13e65b0fcfecde5a7574b01">securid_session_alloc</a>();			securid_session-&gt;sdiHandle = sdiHandle; /* save ACE handle for future use */			securid_session-&gt;securidSessionState = <a class="el" href="rlm__securid_8h.html#ad1331b73a03f873b01f69e66e32a8883a60f094cda48e7ed2b9b2ef6819eb6c2d">NEW_PIN_REQUIRED_STATE</a>;			securid_session-&gt;identity = <a class="el" href="talloc_8h.html#a3536feb85c89aa239851ef0830b72e64">talloc_typed_strdup</a>(securid_session, <a class="el" href="rlm__securid_8c.html#a0adcbe0e0e6f64a29b1d205ede9632c1">username</a>);			/* Get PIN requirements */			acm_ret = AceGetPinParams(sdiHandle, &amp;pin_params);			/* If a system-generated PIN is required */			<a class="el" href="acutest_8h.html#a28855fa01b85a12f2d0ce002f5131535">if</a> (pin_params.Selectable == CANNOT_CHOOSE_PIN) {				/* Prompt user to accept a system generated PIN */				<a class="el" href="snprintf_8c.html#a8da10a1735da7051de5c298ca7448eee">snprintf</a>(replyMsgBuffer, replyMsgBufferSize,					 &quot;\r\nAre you prepared to accept a new system-generated PIN [y/<a class="el" href="acutest_8h.html#a4eacae1d9e7c39f8236bb36d4ececa77">n</a>]?&quot;);				securid_session-&gt;securidSessionState = <a class="el" href="rlm__securid_8h.html#ad1331b73a03f873b01f69e66e32a8883abe4555fa0f5cae073b38ba046857acb3">NEW_PIN_SYSTEM_ACCEPT_STATE</a>;			} <a class="el" href="acutest_8h.html#a0544c3fe466e421738dae463968b70ba">else</a> <a class="el" href="acutest_8h.html#a28855fa01b85a12f2d0ce002f5131535">if</a> (pin_params.Selectable == USER_SELECTABLE) { //may be returned by AM 6.x servers.				<a class="el" href="snprintf_8c.html#a8da10a1735da7051de5c298ca7448eee">snprintf</a>(replyMsgBuffer, replyMsgBufferSize,					 &quot;\r\nPress 'y' to generate a new <a class="el" href="acutest_8h.html#a4eacae1d9e7c39f8236bb36d4ececa77">PIN\r\nOR\r\n</a>'<a class="el" href="acutest_8h.html#a4eacae1d9e7c39f8236bb36d4ececa77">n</a>'to enter a new PIN yourself [y/<a class="el" href="acutest_8h.html#a4eacae1d9e7c39f8236bb36d4ececa77">n</a>]&quot;);				securid_session-&gt;securidSessionState = <a class="el" href="rlm__securid_8h.html#ad1331b73a03f873b01f69e66e32a8883a91d0cfac1397ecc2cb1d34d8b5f7c674">NEW_PIN_USER_SELECT_STATE</a>;			} <a class="el" href="acutest_8h.html#a0544c3fe466e421738dae463968b70ba">else</a> {				<a class="el" href="acutest_8h.html#a28855fa01b85a12f2d0ce002f5131535">if</a> (pin_params.Alphanumeric) {					strcpy(format, &quot;alphanumeric characters&quot;);				} else {					strcpy(format, &quot;digits&quot;);				}				snprintf(replyMsgBuffer, replyMsgBufferSize,					 &quot; \r\n   Enter your new PIN of %d to %d %s, \<a class="el" href="acutest_8h.html#a4eacae1d9e7c39f8236bb36d4ececa77">r\n</a>		<a class="el" href="acutest_8h.html#a4eacae1d9e7c39f8236bb36d4ececa77">or\r\n</a>   &lt;Ctrl-D&gt; to cancel the New PIN procedure:&quot;,					 pin_params.Min, pin_params.Max, format);			}			/* insert new session <a class="el" href="value_8h.html#a47ef05ec8d75829006b7eba839c1b603">in</a> the session list */			<a class="el" href="rlm__securid_8h.html#a19a0f963092887cb5c7a50538776a0fc">securid_sessionlist_add</a>(<a class="el" href="rlm__passwd_8c.html#a5a012410c9dc2b8d34d0c5a49231a7e7">inst</a>, request, securid_session);			<a class="el" href="rlm__securid_8c.html#a9717e7bbecb906637e86cef6da3d83c2">return</a> RC_SECURID_AUTH_CHALLENGE;		case ACM_NEXT_CODE_REQUIRED:			<a class="el" href="lib_2server_2log_8h.html#a0a15527c77f692028b4fd08e8a3fcd9e">RDEBUG2</a>(&quot;Next securid token code required for %s&quot;,				username);			/* create a new session */			securid_session = <a class="el" href="rlm__securid_8h.html#a8fc9bbdfa13e65b0fcfecde5a7574b01">securid_session_alloc</a>();			securid_session-&gt;sdiHandle = sdiHandle;			securid_session-&gt;securidSessionState = <a class="el" href="rlm__securid_8h.html#ad1331b73a03f873b01f69e66e32a8883ae725e8528e98d0401237e0cefa40a17e">NEXT_CODE_REQUIRED_STATE</a>;			securid_session-&gt;identity = <a class="el" href="talloc_8h.html#a3536feb85c89aa239851ef0830b72e64">talloc_typed_strdup</a>(securid_session, <a class="el" href="rlm__securid_8c.html#a0adcbe0e0e6f64a29b1d205ede9632c1">username</a>);			/* insert new session <a class="el" href="value_8h.html#a47ef05ec8d75829006b7eba839c1b603">in</a> the session list */			<a class="el" href="rlm__securid_8h.html#a19a0f963092887cb5c7a50538776a0fc">securid_sessionlist_add</a>(<a class="el" href="rlm__passwd_8c.html#a5a012410c9dc2b8d34d0c5a49231a7e7">inst</a>, request, securid_session);			<a class="el" href="strlcpy_8c.html#a59f9599e77ee687b1daaa179f8b9a2f3">strlcpy</a>(replyMsgBuffer, &quot;\r\nPlease Enter the Next Code from Your Token:&quot;, replyMsgBufferSize);			<a class="el" href="rlm__securid_8c.html#a9717e7bbecb906637e86cef6da3d83c2">return</a> RC_SECURID_AUTH_CHALLENGE;		default:			<a class="el" href="dhcpclient_8c.html#a15378cd15bafb3a79061424b452497aa">ERROR</a>(&quot;SecurID: Unexpected error from ACE/Agent API acm_ret=%d&quot;, acm_ret);			<a class="el" href="rlm__securid_8h.html#a918cf7252f7368977388ddcbc39b0612">securid_session_free</a>(<a class="el" href="rlm__passwd_8c.html#a5a012410c9dc2b8d34d0c5a49231a7e7">inst</a>, request, securid_session);			<a class="el" href="rlm__securid_8c.html#a9717e7bbecb906637e86cef6da3d83c2">return</a> RC_SECURID_AUTH_FAILURE;		}	} <a class="el" href="acutest_8h.html#a0544c3fe466e421738dae463968b70ba">else</a> {		/* existing session found */		<a class="el" href="lib_2server_2log_8h.html#a0a15527c77f692028b4fd08e8a3fcd9e">RDEBUG2</a>(&quot;Continuing previous session found for user [%s]&quot;, username);		/* continue previous session */		switch (securid_session-&gt;securidSessionState) {		case NEXT_CODE_REQUIRED_STATE:			<a class="el" href="lib_2server_2log_8h.html#a06ba507a9538ae220b90139545fb7ba8">DEBUG2</a>(&quot;Securid NEXT_CODE_REQUIRED_STATE: User [%s]&quot;, username);			/* next token code mode */			acm_ret = SD_Next(securid_session-&gt;sdiHandle, securid_pass);			<a class="el" href="acutest_8h.html#a28855fa01b85a12f2d0ce002f5131535">if</a> (acm_ret == ACM_OK) {				<a class="el" href="lib_2server_2log_8h.html#a79e06bb5462f23cf40113958bd51819e">INFO</a>(&quot;Next SecurID token accepted for [%s].&quot;, securid_session-&gt;identity);				rc = RC_SECURID_AUTH_SUCCESS;			} <a class="el" href="acutest_8h.html#a0544c3fe466e421738dae463968b70ba">else</a> {				<a class="el" href="lib_2server_2log_8h.html#a79e06bb5462f23cf40113958bd51819e">INFO</a>(&quot;SecurID: Next token rejected for [%s].&quot;, securid_session-&gt;identity);				rc = RC_SECURID_AUTH_FAILURE;			}			/* deallocate session */			<a class="el" href="rlm__securid_8h.html#a918cf7252f7368977388ddcbc39b0612">securid_session_free</a>(<a class="el" href="rlm__passwd_8c.html#a5a012410c9dc2b8d34d0c5a49231a7e7">inst</a>, request, securid_session);			<a class="el" href="rlm__securid_8c.html#a9717e7bbecb906637e86cef6da3d83c2">return</a> rc;		case NEW_PIN_REQUIRED_STATE:			<a class="el" href="lib_2server_2log_8h.html#a0a15527c77f692028b4fd08e8a3fcd9e">RDEBUG2</a>(&quot;SecurID <a class="el" href="rlm__securid_8h.html#ad1331b73a03f873b01f69e66e32a8883a60f094cda48e7ed2b9b2ef6819eb6c2d">NEW_PIN_REQUIRED_STATE</a> for %s&quot;,				username);			/* save the previous pin */			<a class="el" href="acutest_8h.html#a28855fa01b85a12f2d0ce002f5131535">if</a> (securid_session-&gt;pin) TALLOC_FREE(securid_session-&gt;pin);			securid_session-&gt;pin = <a class="el" href="talloc_8h.html#a3536feb85c89aa239851ef0830b72e64">talloc_typed_strdup</a>(securid_session, passcode);			<a class="el" href="strlcpy_8c.html#a59f9599e77ee687b1daaa179f8b9a2f3">strlcpy</a>(replyMsgBuffer, &quot;\r\n		 Please re-enter new PIN:&quot;, replyMsgBufferSize);			/* set next state */			securid_session-&gt;securidSessionState = <a class="el" href="rlm__securid_8h.html#ad1331b73a03f873b01f69e66e32a8883afc9f782e42b551f564bf70a08cceb4db">NEW_PIN_USER_CONFIRM_STATE</a>;			/* insert the updated session <a class="el" href="value_8h.html#a47ef05ec8d75829006b7eba839c1b603">in</a> the session list */			<a class="el" href="rlm__securid_8h.html#a19a0f963092887cb5c7a50538776a0fc">securid_sessionlist_add</a>(<a class="el" href="rlm__passwd_8c.html#a5a012410c9dc2b8d34d0c5a49231a7e7">inst</a>, request, securid_session);			<a class="el" href="rlm__securid_8c.html#a9717e7bbecb906637e86cef6da3d83c2">return</a> RC_SECURID_AUTH_CHALLENGE;		case NEW_PIN_USER_CONFIRM_STATE:			<a class="el" href="lib_2server_2log_8h.html#a0a15527c77f692028b4fd08e8a3fcd9e">RDEBUG2</a>(&quot;SecurID NEW_PIN_USER_CONFIRM_STATE: User [%s]&quot;, username);			/* compare previous pin and current pin */			<a class="el" href="acutest_8h.html#a28855fa01b85a12f2d0ce002f5131535">if</a> (!securid_session-&gt;pin || strcmp(securid_session-&gt;pin, passcode)) {				<a class="el" href="lib_2server_2log_8h.html#a0a15527c77f692028b4fd08e8a3fcd9e">RDEBUG2</a>(&quot;Pin confirmation failed. Pins do not match [%s] and [%s]&quot;,				       SAFE_STR(securid_session-&gt;pin), securid_pass);				/* pins do not match */				/* challenge the user again */				AceGetPinParams(securid_session-&gt;sdiHandle, &amp;pin_params);				<a class="el" href="acutest_8h.html#a28855fa01b85a12f2d0ce002f5131535">if</a> (pin_params.Alphanumeric) {					strcpy(format, &quot;alphanumeric characters&quot;);				} else {					strcpy(format, &quot;digits&quot;);				}				snprintf(replyMsgBuffer, replyMsgBufferSize,					 &quot; \r\n   Pins do not match--Please try <a class="el" href="acutest_8h.html#a4eacae1d9e7c39f8236bb36d4ececa77">again.\r\n</a>   Enter your new PIN of %d to %d %s, \<a class="el" href="acutest_8h.html#a4eacae1d9e7c39f8236bb36d4ececa77">r\n</a>		<a class="el" href="acutest_8h.html#a4eacae1d9e7c39f8236bb36d4ececa77">or\r\n</a>   &lt;Ctrl-D&gt; to cancel the New PIN procedure:&quot;,					 pin_params.Min, pin_params.Max, format);				securid_session-&gt;securidSessionState = <a class="el" href="rlm__securid_8h.html#ad1331b73a03f873b01f69e66e32a8883a60f094cda48e7ed2b9b2ef6819eb6c2d">NEW_PIN_REQUIRED_STATE</a>;				/* insert the updated session <a class="el" href="value_8h.html#a47ef05ec8d75829006b7eba839c1b603">in</a> the session list */				<a class="el" href="rlm__securid_8h.html#a19a0f963092887cb5c7a50538776a0fc">securid_sessionlist_add</a>(<a class="el" href="rlm__passwd_8c.html#a5a012410c9dc2b8d34d0c5a49231a7e7">inst</a>, request, securid_session);				rc = RC_SECURID_AUTH_CHALLENGE;			} <a class="el" href="acutest_8h.html#a0544c3fe466e421738dae463968b70ba">else</a> {				/* pins match */				<a class="el" href="lib_2server_2log_8h.html#a0a15527c77f692028b4fd08e8a3fcd9e">RDEBUG2</a>(&quot;Pin confirmation succeeded. Pins match&quot;);				acm_ret = SD_Pin(securid_session-&gt;sdiHandle, securid_pass);				<a class="el" href="acutest_8h.html#a28855fa01b85a12f2d0ce002f5131535">if</a> (acm_ret == ACM_NEW_PIN_ACCEPTED) {					<a class="el" href="lib_2server_2log_8h.html#a0a15527c77f692028b4fd08e8a3fcd9e">RDEBUG2</a>(&quot;New SecurID pin accepted for %s.&quot;, securid_session-&gt;identity);					securid_session-&gt;securidSessionState = <a class="el" href="rlm__securid_8h.html#ad1331b73a03f873b01f69e66e32a8883ab66854883b53d18fd05efa42d5650590">NEW_PIN_AUTH_VALIDATE_STATE</a>;					/* insert the updated session <a class="el" href="value_8h.html#a47ef05ec8d75829006b7eba839c1b603">in</a> the session list */					<a class="el" href="rlm__securid_8h.html#a19a0f963092887cb5c7a50538776a0fc">securid_sessionlist_add</a>(<a class="el" href="rlm__passwd_8c.html#a5a012410c9dc2b8d34d0c5a49231a7e7">inst</a>, request, securid_session);					rc = RC_SECURID_AUTH_CHALLENGE;					<a class="el" href="strlcpy_8c.html#a59f9599e77ee687b1daaa179f8b9a2f3">strlcpy</a>(replyMsgBuffer, &quot; \r\n\r\nWait for the code on your card to change, then enter new PIN and TokenCode\r\n\r\nEnter PASSCODE:&quot;, replyMsgBufferSize);				} <a class="el" href="acutest_8h.html#a0544c3fe466e421738dae463968b70ba">else</a> {					<a class="el" href="lib_2server_2log_8h.html#a0a15527c77f692028b4fd08e8a3fcd9e">RDEBUG2</a>(&quot;SecurID: New SecurID pin rejected for %s.&quot;, securid_session-&gt;identity);					SD_Pin(securid_session-&gt;sdiHandle, &amp;empty_pin[0]);  /* cancel PIN */					rc = RC_SECURID_AUTH_FAILURE;					/* deallocate session */					<a class="el" href="rlm__securid_8h.html#a918cf7252f7368977388ddcbc39b0612">securid_session_free</a>(<a class="el" href="rlm__passwd_8c.html#a5a012410c9dc2b8d34d0c5a49231a7e7">inst</a>, request, securid_session);				}			}			<a class="el" href="rlm__securid_8c.html#a9717e7bbecb906637e86cef6da3d83c2">return</a> rc;		case NEW_PIN_AUTH_VALIDATE_STATE:			acm_ret = SD_Check(securid_session-&gt;sdiHandle, securid_pass, securid_user);			<a class="el" href="acutest_8h.html#a28855fa01b85a12f2d0ce002f5131535">if</a> (acm_ret == ACM_OK) {				<a class="el" href="lib_2server_2log_8h.html#a0a15527c77f692028b4fd08e8a3fcd9e">RDEBUG2</a>(&quot;New SecurID passcode accepted for %s&quot;, securid_session-&gt;identity);				rc = RC_SECURID_AUTH_SUCCESS;			} <a class="el" href="acutest_8h.html#a0544c3fe466e421738dae463968b70ba">else</a> {				<a class="el" href="lib_2server_2log_8h.html#a79e06bb5462f23cf40113958bd51819e">INFO</a>(&quot;SecurID: New passcode rejected for [%s]&quot;, securid_session-&gt;identity);				rc = RC_SECURID_AUTH_FAILURE;			}			/* deallocate session */			<a class="el" href="rlm__securid_8h.html#a918cf7252f7368977388ddcbc39b0612">securid_session_free</a>(<a class="el" href="rlm__passwd_8c.html#a5a012410c9dc2b8d34d0c5a49231a7e7">inst</a>, request, securid_session);			<a class="el" href="rlm__securid_8c.html#a9717e7bbecb906637e86cef6da3d83c2">return</a> rc;		case NEW_PIN_SYSTEM_ACCEPT_STATE:			<a class="el" href="acutest_8h.html#a28855fa01b85a12f2d0ce002f5131535">if</a> (!strcmp(passcode, &quot;y&quot;)) {				AceGetSystemPin(securid_session-&gt;sdiHandle, new_pin);				/* Save the PIN for the next session				 * continuation */				<a class="el" href="acutest_8h.html#a28855fa01b85a12f2d0ce002f5131535">if</a> (securid_session-&gt;pin) TALLOC_FREE(securid_session-&gt;pin);				securid_session-&gt;pin = <a class="el" href="talloc_8h.html#a3536feb85c89aa239851ef0830b72e64">talloc_typed_strdup</a>(securid_session, new_pin);				<a class="el" href="snprintf_8c.html#a8da10a1735da7051de5c298ca7448eee">snprintf</a>(replyMsgBuffer, replyMsgBufferSize,					 &quot;\r\nYour new PIN is: %s\r\nDo you accept this [y/<a class="el" href="acutest_8h.html#a4eacae1d9e7c39f8236bb36d4ececa77">n</a>]?&quot;,					 new_pin);				securid_session-&gt;securidSessionState = <a class="el" href="rlm__securid_8h.html#ad1331b73a03f873b01f69e66e32a8883a558a10f9b7e68e56660fb45819aaa4d2">NEW_PIN_SYSTEM_CONFIRM_STATE</a>;				/* insert the updated session <a class="el" href="value_8h.html#a47ef05ec8d75829006b7eba839c1b603">in</a> the				 * session list */				<a class="el" href="rlm__securid_8h.html#a19a0f963092887cb5c7a50538776a0fc">securid_sessionlist_add</a>(<a class="el" href="rlm__passwd_8c.html#a5a012410c9dc2b8d34d0c5a49231a7e7">inst</a>, request, securid_session);				rc = RC_SECURID_AUTH_CHALLENGE;			} <a class="el" href="acutest_8h.html#a0544c3fe466e421738dae463968b70ba">else</a> {				SD_Pin(securid_session-&gt;sdiHandle, &amp;empty_pin[0]); //Cancel new PIN				/* deallocate session */				<a class="el" href="rlm__securid_8h.html#a918cf7252f7368977388ddcbc39b0612">securid_session_free</a>(<a class="el" href="rlm__passwd_8c.html#a5a012410c9dc2b8d34d0c5a49231a7e7">inst</a>, request, securid_session);				rc = RC_SECURID_AUTH_FAILURE;			}			<a class="el" href="rlm__securid_8c.html#a9717e7bbecb906637e86cef6da3d83c2">return</a> rc;		case NEW_PIN_SYSTEM_CONFIRM_STATE:			acm_ret = SD_Pin(securid_session-&gt;sdiHandle, (SD_CHAR*)securid_session-&gt;pin);			<a class="el" href="acutest_8h.html#a28855fa01b85a12f2d0ce002f5131535">if</a> (acm_ret == ACM_NEW_PIN_ACCEPTED) {				<a class="el" href="strlcpy_8c.html#a59f9599e77ee687b1daaa179f8b9a2f3">strlcpy</a>(replyMsgBuffer, &quot; \r\n\r\nPin Accepted. Wait for the code on your card to change, then enter new PIN and TokenCode\r\n\r\nEnter PASSCODE:&quot;, replyMsgBufferSize);				securid_session-&gt;securidSessionState = <a class="el" href="rlm__securid_8h.html#ad1331b73a03f873b01f69e66e32a8883ab66854883b53d18fd05efa42d5650590">NEW_PIN_AUTH_VALIDATE_STATE</a>;				/* insert the updated session <a class="el" href="value_8h.html#a47ef05ec8d75829006b7eba839c1b603">in</a> the session list */				<a class="el" href="rlm__securid_8h.html#a19a0f963092887cb5c7a50538776a0fc">securid_sessionlist_add</a>(<a class="el" href="rlm__passwd_8c.html#a5a012410c9dc2b8d34d0c5a49231a7e7">inst</a>, request, securid_session);				rc = RC_SECURID_AUTH_CHALLENGE;			} <a class="el" href="acutest_8h.html#a0544c3fe466e421738dae463968b70ba">else</a> {				SD_Pin(securid_session-&gt;sdiHandle, &amp;empty_pin[0]); //Cancel new PIN				<a class="el" href="strlcpy_8c.html#a59f9599e77ee687b1daaa179f8b9a2f3">strlcpy</a>(replyMsgBuffer, &quot; \r\n\r\nPin Rejected. Wait for the code on your card to change, then try again.\r\n\r\nEnter PASSCODE:&quot;, replyMsgBufferSize);				/* deallocate session */				<a class="el" href="rlm__securid_8h.html#a918cf7252f7368977388ddcbc39b0612">securid_session_free</a>(<a class="el" href="rlm__passwd_8c.html#a5a012410c9dc2b8d34d0c5a49231a7e7">inst</a>, request, securid_session);				rc = RC_SECURID_AUTH_FAILURE;			}			<a class="el" href="rlm__securid_8c.html#a9717e7bbecb906637e86cef6da3d83c2">return</a> rc;			/* USER_SELECTABLE state should be implemented to preserve compatibility with AM 6.x servers, which can <a class="el" href="rlm__securid_8c.html#a9717e7bbecb906637e86cef6da3d83c2">return</a> this state */		case NEW_PIN_USER_SELECT_STATE:			<a class="el" href="acutest_8h.html#a28855fa01b85a12f2d0ce002f5131535">if</a> (!strcmp(passcode, &quot;y&quot;)) {				/* User has opted for a system-generated PIN */				AceGetSystemPin(securid_session-&gt;sdiHandle, new_pin);				<a class="el" href="snprintf_8c.html#a8da10a1735da7051de5c298ca7448eee">snprintf</a>(replyMsgBuffer, replyMsgBufferSize,					 &quot;\r\nYour new PIN is: %s\r\nDo you accept this [y/<a class="el" href="acutest_8h.html#a4eacae1d9e7c39f8236bb36d4ececa77">n</a>]?&quot;,					 new_pin);				securid_session-&gt;securidSessionState = <a class="el" href="rlm__securid_8h.html#ad1331b73a03f873b01f69e66e32a8883a558a10f9b7e68e56660fb45819aaa4d2">NEW_PIN_SYSTEM_CONFIRM_STATE</a>;				/* insert the updated session <a class="el" href="value_8h.html#a47ef05ec8d75829006b7eba839c1b603">in</a> the session list */				<a class="el" href="rlm__securid_8h.html#a19a0f963092887cb5c7a50538776a0fc">securid_sessionlist_add</a>(<a class="el" href="rlm__passwd_8c.html#a5a012410c9dc2b8d34d0c5a49231a7e7">inst</a>, request,							securid_session);				rc = RC_SECURID_AUTH_CHALLENGE;			} <a class="el" href="acutest_8h.html#a0544c3fe466e421738dae463968b70ba">else</a> {				/* User has opted for a user-defined PIN */				AceGetPinParams(securid_session-&gt;sdiHandle,						&amp;pin_params);				<a class="el" href="acutest_8h.html#a28855fa01b85a12f2d0ce002f5131535">if</a> (pin_params.Alphanumeric) {					strcpy(format, &quot;alphanumeric characters&quot;);				} else {					strcpy(format, &quot;digits&quot;);				}				snprintf(replyMsgBuffer, replyMsgBufferSize,					 &quot; \r\n   Enter your new PIN of %d to %d %s, \<a class="el" href="acutest_8h.html#a4eacae1d9e7c39f8236bb36d4ececa77">r\n</a>		<a class="el" href="acutest_8h.html#a4eacae1d9e7c39f8236bb36d4ececa77">or\r\n</a>   &lt;Ctrl-D&gt; to cancel the New PIN procedure:&quot;,					 pin_params.Min, pin_params.Max, format);				securid_session-&gt;securidSessionState = <a class="el" href="rlm__securid_8h.html#ad1331b73a03f873b01f69e66e32a8883a60f094cda48e7ed2b9b2ef6819eb6c2d">NEW_PIN_REQUIRED_STATE</a>;				/* insert the updated session <a class="el" href="value_8h.html#a47ef05ec8d75829006b7eba839c1b603">in</a> the session list */				<a class="el" href="rlm__securid_8h.html#a19a0f963092887cb5c7a50538776a0fc">securid_sessionlist_add</a>(<a class="el" href="rlm__passwd_8c.html#a5a012410c9dc2b8d34d0c5a49231a7e7">inst</a>, request,							securid_session);				rc = RC_SECURID_AUTH_CHALLENGE;			}			<a class="el" href="rlm__securid_8c.html#a9717e7bbecb906637e86cef6da3d83c2">return</a> rc;		default:			<a class="el" href="dhcpclient_8c.html#a15378cd15bafb3a79061424b452497aa">ERROR</a>(&quot;Invalid session state %d for user \&quot;%s\&quot;&quot;, securid_session-&gt;securidSessionState,</td></tr>
<tr class="separator:ab681363ad60438294a46ba7af6ab7a39"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a6dab4bbc315ece5039fc5c69f93cda26"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="action_8h.html#ad02ab717522305fe70aab72d152fc812">unlang_action_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rlm__securid_8c.html#a6dab4bbc315ece5039fc5c69f93cda26">mod_authenticate</a> (<a class="el" href="rcode_8h.html#adcc711080df76349e177fc29a641d1fb">rlm_rcode_t</a> *p_result, <a class="el" href="server_2module_8h.html#a9bcf8e012c49bd2f269dd276981a72a0">module_ctx_t</a> const *mctx, <a class="el" href="radclient_8c.html#a2fc1b64f51f8225195d32592e6fe8fc5">request_t</a> *request)</td></tr>
<tr class="separator:a6dab4bbc315ece5039fc5c69f93cda26"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a58558dfc841067f4efe9262f6452ead0"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rlm__securid_8c.html#a58558dfc841067f4efe9262f6452ead0">mod_detach</a> (void *instance)</td></tr>
<tr class="separator:a58558dfc841067f4efe9262f6452ead0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0af0fa030319c2f5835b37c159cbbf28"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rlm__securid_8c.html#a0af0fa030319c2f5835b37c159cbbf28">mod_instantiate</a> (void *instance, <a class="el" href="build_8h.html#addf5ec070e9499d36b7f2009ce736076">UNUSED</a> <a class="el" href="cf__util_8h.html#a0f39d8043920472ea4c687c97f7173b3">CONF_SECTION</a> *<a class="el" href="radsniff_8c.html#ae9b08c8e16b52f7ab0e5c13fb7775156">conf</a>)</td></tr>
<tr class="separator:a0af0fa030319c2f5835b37c159cbbf28"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a91cf6fbebedd86150a36e5ac3d5d3bfc"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rlm__securid_8c.html#a91cf6fbebedd86150a36e5ac3d5d3bfc">break</a></td></tr>
<tr class="separator:a91cf6fbebedd86150a36e5ac3d5d3bfc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9717e7bbecb906637e86cef6da3d83c2"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rlm__securid_8c.html#a9717e7bbecb906637e86cef6da3d83c2">return</a></td></tr>
<tr class="separator:a9717e7bbecb906637e86cef6da3d83c2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab681363ad60438294a46ba7af6ab7a39"><td class="memItemLeft" align="right" valign="top"><a class="el" href="server_2module_8h.html#a6eb2350874d0c396b230f58b4b5d6ff1">module_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rlm__securid_8c.html#ab681363ad60438294a46ba7af6ab7a39">rlm_securid</a></td></tr>
<tr class="separator:ab681363ad60438294a46ba7af6ab7a39"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0adcbe0e0e6f64a29b1d205ede9632c1"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rlm__securid_8c.html#a0adcbe0e0e6f64a29b1d205ede9632c1">username</a></td></tr>
<tr class="separator:a0adcbe0e0e6f64a29b1d205ede9632c1"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Supports auth against SecurID servers using OTP h/w tokens. </p>
<dl class="section rcs"><dt>Id</dt><dd>ed94e442202e91d7c92126e90706a1156d525134 </dd></dl>
<p>Supports "next-token code" and "new-pin" modes.</p>
<dl class="section copyright"><dt>Copyright</dt><dd>2012 The FreeRADIUS server project </dd>
<dd>
2012 Alan DeKok (<a href="#" onclick="location.href='mai'+'lto:'+'ala'+'nd'+'@ne'+'tw'+'ork'+'ra'+'diu'+'s.'+'com'; return false;">aland<span style="display: none;">.nosp@m.</span>@net<span style="display: none;">.nosp@m.</span>workr<span style="display: none;">.nosp@m.</span>adiu<span style="display: none;">.nosp@m.</span>s.com</a>) </dd></dl>

<p class="definition">Definition in file <a class="el" href="rlm__securid_8c_source.html">rlm_securid.c</a>.</p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="ab681363ad60438294a46ba7af6ab7a39"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab681363ad60438294a46ba7af6ab7a39">&#9670;&nbsp;</a></span>rlm_securid</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="server_2module_8h.html#a6eb2350874d0c396b230f58b4b5d6ff1">module_t</a> rlm_securid&#160;&#160;&#160;- &quot;#include &lt;freeradius-devel/server/base.h&gt;#include &lt;freeradius-devel/server/module.h&gt;#include &lt;ctype.h&gt;#include &quot;rlm_securid.h&quot;typedef enum {	RC_SECURID_AUTH_SUCCESS = 0,	RC_SECURID_AUTH_FAILURE = -3,	RC_SECURID_AUTH_ACCESS_DENIED_FAILURE = -4,	RC_SECURID_AUTH_INVALID_SERVER_FAILURE = -5,	RC_SECURID_AUTH_CHALLENGE = -17} SECURID_AUTH_RC;static const <a class="el" href="cf__parse_8h.html#structCONF__PARSER">CONF_PARSER</a> <a class="el" href="rlm__yubikey_8c.html#a69bd7510e62c21b6f328050b3c22165b">module_config</a>[] = {	{ <a class="el" href="cf__parse_8h.html#a65712f5c07f63ce95739dbd24c822080">FR_CONF_OFFSET</a>(&quot;timer_expire&quot;, FR_TYPE_UINT32, <a class="el" href="rlm__securid_8h.html#structrlm__securid__t">rlm_securid_t</a>, timer_limit), .dflt = &quot;600&quot; },	{ <a class="el" href="cf__parse_8h.html#a65712f5c07f63ce95739dbd24c822080">FR_CONF_OFFSET</a>(&quot;max_sessions&quot;, FR_TYPE_UINT32, <a class="el" href="rlm__securid_8h.html#structrlm__securid__t">rlm_securid_t</a>, max_sessions), .dflt = &quot;2048&quot; },	{ <a class="el" href="cf__parse_8h.html#a65712f5c07f63ce95739dbd24c822080">FR_CONF_OFFSET</a>(&quot;max_trips_per_session&quot;, FR_TYPE_UINT32, <a class="el" href="rlm__securid_8h.html#structrlm__securid__t">rlm_securid_t</a>, max_trips_per_session) },	{ <a class="el" href="cf__parse_8h.html#a65712f5c07f63ce95739dbd24c822080">FR_CONF_OFFSET</a>(&quot;max_round_trips&quot;, FR_TYPE_UINT32, <a class="el" href="rlm__securid_8h.html#structrlm__securid__t">rlm_securid_t</a>, max_trips_per_session), .dflt = &quot;6&quot; },	<a class="el" href="cf__parse_8h.html#a0505c2d6520cd701b0ba43d06cbd62c7">CONF_PARSER_TERMINATOR</a>};static <a class="el" href="dict_8h.html#a8a299a18628c5635c7e9655343bcfceb">fr_dict_t</a> const *<a class="el" href="protocols_2radius_2base_8c.html#a69b60704531c32b274c9d02f58817730">dict_radius</a>;extern <a class="el" href="dict_8h.html#structfr__dict__autoload__t">fr_dict_autoload_t</a> mem_dict[];<a class="el" href="dict_8h.html#structfr__dict__autoload__t">fr_dict_autoload_t</a> mem_dict[] = {	{ .<a class="el" href="value_8h.html#af17d2d4e72bd60de680d3f4a29a1275f">out</a> = &amp;<a class="el" href="protocols_2radius_2base_8c.html#a69b60704531c32b274c9d02f58817730">dict_radius</a>, .<a class="el" href="radwho_8c.html#aeaec16fd026735c3a68bf1131f21f392">proto</a> = &quot;radius&quot; },	{ NULL }};<a class="el" href="dict_8h.html#aed6e1e08277e8ccb5c51266dc7b8fbb1">fr_dict_attr_t</a> const *<a class="el" href="rlm__securid_8h.html#a0c4f188ce5c21fd5d911ae18238f4204">attr_prompt</a>;<a class="el" href="dict_8h.html#aed6e1e08277e8ccb5c51266dc7b8fbb1">fr_dict_attr_t</a> const *<a class="el" href="rlm__sqlcounter_8c.html#a80a10ab759fa1028466fb6ee6a57aca8">attr_reply_message</a>;<a class="el" href="dict_8h.html#aed6e1e08277e8ccb5c51266dc7b8fbb1">fr_dict_attr_t</a> const *<a class="el" href="protocols_2radius_2base_8c.html#a27c864c1c47f93759ccb05116d86daed">attr_state</a>;<a class="el" href="dict_8h.html#aed6e1e08277e8ccb5c51266dc7b8fbb1">fr_dict_attr_t</a> const *<a class="el" href="rlm__winbind_8c.html#ac558a5a59da3f1b586fbcce59a8fd102">attr_user_name</a>;<a class="el" href="dict_8h.html#aed6e1e08277e8ccb5c51266dc7b8fbb1">fr_dict_attr_t</a> const *<a class="el" href="rlm__yubikey_8c.html#a15e395bf03b1a4152fb224c1d516ed54">attr_user_password</a>;extern <a class="el" href="dict_8h.html#structfr__dict__attr__autoload__t">fr_dict_attr_autoload_t</a> mem_dict_attr[];<a class="el" href="dict_8h.html#structfr__dict__attr__autoload__t">fr_dict_attr_autoload_t</a> mem_dict_attr[] = {	{ .<a class="el" href="value_8h.html#af17d2d4e72bd60de680d3f4a29a1275f">out</a> = &amp;<a class="el" href="rlm__securid_8h.html#a0c4f188ce5c21fd5d911ae18238f4204">attr_prompt</a>, .<a class="el" href="rlm__redis__ippool__tool_8c.html#a5f1de76dd5d451949e12c0fbc966ca70">name</a> = &quot;Prompt&quot;, .type = <a class="el" href="util_2types_8h.html#a372af96cb1f1bd71720f5b25c8acfd30a8e3243c385d006225c2eff3d38382552">FR_TYPE_UINT32</a>, .<a class="el" href="fuzzer_8c.html#a4141ae10bee97755d6d8f754ff2b3178">dict</a> = &amp;<a class="el" href="protocols_2radius_2base_8c.html#a69b60704531c32b274c9d02f58817730">dict_radius</a> },	{ .<a class="el" href="value_8h.html#af17d2d4e72bd60de680d3f4a29a1275f">out</a> = &amp;<a class="el" href="rlm__sqlcounter_8c.html#a80a10ab759fa1028466fb6ee6a57aca8">attr_reply_message</a>, .<a class="el" href="rlm__redis__ippool__tool_8c.html#a5f1de76dd5d451949e12c0fbc966ca70">name</a> = &quot;Reply-Message&quot;, .type = <a class="el" href="util_2types_8h.html#a372af96cb1f1bd71720f5b25c8acfd30a3277792336b6d6c1577f0cbb53f74381">FR_TYPE_STRING</a>, .<a class="el" href="fuzzer_8c.html#a4141ae10bee97755d6d8f754ff2b3178">dict</a> = &amp;<a class="el" href="protocols_2radius_2base_8c.html#a69b60704531c32b274c9d02f58817730">dict_radius</a> },	{ .<a class="el" href="value_8h.html#af17d2d4e72bd60de680d3f4a29a1275f">out</a> = &amp;<a class="el" href="protocols_2radius_2base_8c.html#a27c864c1c47f93759ccb05116d86daed">attr_state</a>, .<a class="el" href="rlm__redis__ippool__tool_8c.html#a5f1de76dd5d451949e12c0fbc966ca70">name</a> = &quot;State&quot;, .type = <a class="el" href="util_2types_8h.html#a372af96cb1f1bd71720f5b25c8acfd30aee66e99bbe53ef358fe622bff40770f8">FR_TYPE_OCTETS</a>, .<a class="el" href="fuzzer_8c.html#a4141ae10bee97755d6d8f754ff2b3178">dict</a> = &amp;<a class="el" href="protocols_2radius_2base_8c.html#a69b60704531c32b274c9d02f58817730">dict_radius</a> },	{ .<a class="el" href="value_8h.html#af17d2d4e72bd60de680d3f4a29a1275f">out</a> = &amp;<a class="el" href="rlm__winbind_8c.html#ac558a5a59da3f1b586fbcce59a8fd102">attr_user_name</a>, .<a class="el" href="rlm__redis__ippool__tool_8c.html#a5f1de76dd5d451949e12c0fbc966ca70">name</a> = &quot;User-Name&quot;, .type = <a class="el" href="util_2types_8h.html#a372af96cb1f1bd71720f5b25c8acfd30a3277792336b6d6c1577f0cbb53f74381">FR_TYPE_STRING</a>, .<a class="el" href="fuzzer_8c.html#a4141ae10bee97755d6d8f754ff2b3178">dict</a> = &amp;<a class="el" href="protocols_2radius_2base_8c.html#a69b60704531c32b274c9d02f58817730">dict_radius</a> },	{ .<a class="el" href="value_8h.html#af17d2d4e72bd60de680d3f4a29a1275f">out</a> = &amp;<a class="el" href="rlm__yubikey_8c.html#a15e395bf03b1a4152fb224c1d516ed54">attr_user_password</a>, .<a class="el" href="rlm__redis__ippool__tool_8c.html#a5f1de76dd5d451949e12c0fbc966ca70">name</a> = &quot;User-Password&quot;, .type = <a class="el" href="util_2types_8h.html#a372af96cb1f1bd71720f5b25c8acfd30a3277792336b6d6c1577f0cbb53f74381">FR_TYPE_STRING</a>, .<a class="el" href="fuzzer_8c.html#a4141ae10bee97755d6d8f754ff2b3178">dict</a> = &amp;<a class="el" href="protocols_2radius_2base_8c.html#a69b60704531c32b274c9d02f58817730">dict_radius</a> },	{ NULL }};static SD_CHAR empty_pin[] = &quot;&quot;;/* comparison function to find session <a class="el" href="value_8h.html#a47ef05ec8d75829006b7eba839c1b603">in</a> the tree */static int securid_session_cmp(void const *a, void const *b){	int ret;	<a class="el" href="rlm__securid_8h.html#structSECURID__SESSION">SECURID_SESSION</a> const *one = a;	<a class="el" href="rlm__securid_8h.html#structSECURID__SESSION">SECURID_SESSION</a> const *two = b;	<a class="el" href="debug_8h.html#ad77eb24bc481f3f9cd80da2704c81a8f">fr_assert</a>(one != NULL);	<a class="el" href="debug_8h.html#ad77eb24bc481f3f9cd80da2704c81a8f">fr_assert</a>(two != NULL);	ret = <a class="el" href="inet_8h.html#a65813be16518f6da0cc923bd67bc8c75">fr_ipaddr_cmp</a>(&amp;one-&gt;src_ipaddr, &amp;two-&gt;src_ipaddr);	<a class="el" href="acutest_8h.html#a28855fa01b85a12f2d0ce002f5131535">if</a> (ret != 0) <a class="el" href="rlm__securid_8c.html#a9717e7bbecb906637e86cef6da3d83c2">return</a> ret;	<a class="el" href="rlm__securid_8c.html#a9717e7bbecb906637e86cef6da3d83c2">return</a> memcmp(one-&gt;state, two-&gt;state, sizeof(one-&gt;state));}static SECURID_AUTH_RC securidAuth(void *instance, <a class="el" href="radclient_8c.html#a2fc1b64f51f8225195d32592e6fe8fc5">request_t</a> *request,				   char const *<a class="el" href="rlm__securid_8c.html#a0adcbe0e0e6f64a29b1d205ede9632c1">username</a>,				   char const *passcode,				   char *replyMsgBuffer, size_t replyMsgBufferSize){	<a class="el" href="rlm__securid_8h.html#structrlm__securid__t">rlm_securid_t</a> *<a class="el" href="rlm__passwd_8c.html#a5a012410c9dc2b8d34d0c5a49231a7e7">inst</a> = (<a class="el" href="rlm__securid_8h.html#structrlm__securid__t">rlm_securid_t</a> *) instance;	int acm_ret;	SD_PIN pin_params;	char new_pin[10];	char format[30];	<a class="el" href="rlm__securid_8h.html#structSECURID__SESSION">SECURID_SESSION</a> *securid_session = NULL;	int rc = -1;	SD_CHAR *securid_user, *securid_pass;	<a class="el" href="acutest_8h.html#a28855fa01b85a12f2d0ce002f5131535">if</a> (!<a class="el" href="rlm__securid_8c.html#a0adcbe0e0e6f64a29b1d205ede9632c1">username</a>) {		<a class="el" href="dhcpclient_8c.html#a15378cd15bafb3a79061424b452497aa">ERROR</a>(&quot;SecurID <a class="el" href="rlm__securid_8c.html#a0adcbe0e0e6f64a29b1d205ede9632c1">username</a> is NULL&quot;);		return RC_SECURID_AUTH_FAILURE;	}	<a class="el" href="acutest_8h.html#a28855fa01b85a12f2d0ce002f5131535">if</a> (!passcode) {		<a class="el" href="dhcpclient_8c.html#a15378cd15bafb3a79061424b452497aa">ERROR</a>(&quot;SecurID passcode is NULL for %s user&quot;, username);		<a class="el" href="rlm__securid_8c.html#a9717e7bbecb906637e86cef6da3d83c2">return</a> RC_SECURID_AUTH_FAILURE;	}	memcpy(&amp;securid_user, &amp;<a class="el" href="rlm__securid_8c.html#a0adcbe0e0e6f64a29b1d205ede9632c1">username</a>, sizeof(securid_user));	memcpy(&amp;securid_pass, &amp;passcode, sizeof(securid_pass));	*replyMsgBuffer = '\0';	securid_session = <a class="el" href="rlm__securid_8h.html#ab505d49128184952ba00fa9d85953dd3">securid_sessionlist_find</a>(<a class="el" href="rlm__passwd_8c.html#a5a012410c9dc2b8d34d0c5a49231a7e7">inst</a>, request);	<a class="el" href="acutest_8h.html#a28855fa01b85a12f2d0ce002f5131535">if</a> (!securid_session) {		/* securid session not found */		SDI_HANDLE sdiHandle = SDI_HANDLE_NONE;		acm_ret = SD_Init(&amp;sdiHandle);		<a class="el" href="acutest_8h.html#a28855fa01b85a12f2d0ce002f5131535">if</a> (acm_ret != ACM_OK) {			<a class="el" href="lib_2server_2log_8h.html#a54d63b732521caba733f2d624dc6c04a">RERROR</a>(&quot;Cannot communicate with the ACE/Server&quot;);			return -1;		}		acm_ret = SD_Lock(sdiHandle, securid_user);		<a class="el" href="acutest_8h.html#a28855fa01b85a12f2d0ce002f5131535">if</a> (acm_ret != ACM_OK) {			<a class="el" href="lib_2server_2log_8h.html#a0100b7d38bdad8451e7ac9a07d276792">REDEBUG</a>(&quot;SecurID: Access denied. Name [%s] lock failed&quot;, username);			<a class="el" href="rlm__securid_8c.html#a9717e7bbecb906637e86cef6da3d83c2">return</a> -2;		}		acm_ret = SD_Check(sdiHandle, securid_pass, securid_user);		switch (acm_ret) {		case ACM_OK:			/* we are <a class="el" href="value_8h.html#a47ef05ec8d75829006b7eba839c1b603">in</a> now */			<a class="el" href="lib_2server_2log_8h.html#a0a15527c77f692028b4fd08e8a3fcd9e">RDEBUG2</a>(&quot;SecurID authentication successful for %s&quot;, username);			SD_Close(sdiHandle);			<a class="el" href="rlm__securid_8c.html#a9717e7bbecb906637e86cef6da3d83c2">return</a> RC_SECURID_AUTH_SUCCESS;		case ACM_ACCESS_DENIED:			/* not this time */			<a class="el" href="lib_2server_2log_8h.html#a0a15527c77f692028b4fd08e8a3fcd9e">RDEBUG2</a>(&quot;SecurID Access denied for %s&quot;, username);			SD_Close(sdiHandle);			<a class="el" href="rlm__securid_8c.html#a9717e7bbecb906637e86cef6da3d83c2">return</a> RC_SECURID_AUTH_ACCESS_DENIED_FAILURE;		case ACM_INVALID_SERVER:			<a class="el" href="lib_2server_2log_8h.html#a54d63b732521caba733f2d624dc6c04a">RERROR</a>(&quot;SecurID: Invalid ACE server&quot;);			return RC_SECURID_AUTH_INVALID_SERVER_FAILURE;		case ACM_NEW_PIN_REQUIRED:			<a class="el" href="lib_2server_2log_8h.html#a0a15527c77f692028b4fd08e8a3fcd9e">RDEBUG2</a>(&quot;SecurID new pin required for %s&quot;, username);			/* create a new session */			securid_session = <a class="el" href="rlm__securid_8h.html#a8fc9bbdfa13e65b0fcfecde5a7574b01">securid_session_alloc</a>();			securid_session-&gt;sdiHandle = sdiHandle; /* save ACE handle for future use */			securid_session-&gt;securidSessionState = <a class="el" href="rlm__securid_8h.html#ad1331b73a03f873b01f69e66e32a8883a60f094cda48e7ed2b9b2ef6819eb6c2d">NEW_PIN_REQUIRED_STATE</a>;			securid_session-&gt;identity = <a class="el" href="talloc_8h.html#a3536feb85c89aa239851ef0830b72e64">talloc_typed_strdup</a>(securid_session, <a class="el" href="rlm__securid_8c.html#a0adcbe0e0e6f64a29b1d205ede9632c1">username</a>);			/* Get PIN requirements */			acm_ret = AceGetPinParams(sdiHandle, &amp;pin_params);			/* If a system-generated PIN is required */			<a class="el" href="acutest_8h.html#a28855fa01b85a12f2d0ce002f5131535">if</a> (pin_params.Selectable == CANNOT_CHOOSE_PIN) {				/* Prompt user to accept a system generated PIN */				<a class="el" href="snprintf_8c.html#a8da10a1735da7051de5c298ca7448eee">snprintf</a>(replyMsgBuffer, replyMsgBufferSize,					 &quot;\r\nAre you prepared to accept a new system-generated PIN [y/<a class="el" href="acutest_8h.html#a4eacae1d9e7c39f8236bb36d4ececa77">n</a>]?&quot;);				securid_session-&gt;securidSessionState = <a class="el" href="rlm__securid_8h.html#ad1331b73a03f873b01f69e66e32a8883abe4555fa0f5cae073b38ba046857acb3">NEW_PIN_SYSTEM_ACCEPT_STATE</a>;			} <a class="el" href="acutest_8h.html#a0544c3fe466e421738dae463968b70ba">else</a> <a class="el" href="acutest_8h.html#a28855fa01b85a12f2d0ce002f5131535">if</a> (pin_params.Selectable == USER_SELECTABLE) { //may be returned by AM 6.x servers.				<a class="el" href="snprintf_8c.html#a8da10a1735da7051de5c298ca7448eee">snprintf</a>(replyMsgBuffer, replyMsgBufferSize,					 &quot;\r\nPress 'y' to generate a new <a class="el" href="acutest_8h.html#a4eacae1d9e7c39f8236bb36d4ececa77">PIN\r\nOR\r\n</a>'<a class="el" href="acutest_8h.html#a4eacae1d9e7c39f8236bb36d4ececa77">n</a>'to enter a new PIN yourself [y/<a class="el" href="acutest_8h.html#a4eacae1d9e7c39f8236bb36d4ececa77">n</a>]&quot;);				securid_session-&gt;securidSessionState = <a class="el" href="rlm__securid_8h.html#ad1331b73a03f873b01f69e66e32a8883a91d0cfac1397ecc2cb1d34d8b5f7c674">NEW_PIN_USER_SELECT_STATE</a>;			} <a class="el" href="acutest_8h.html#a0544c3fe466e421738dae463968b70ba">else</a> {				<a class="el" href="acutest_8h.html#a28855fa01b85a12f2d0ce002f5131535">if</a> (pin_params.Alphanumeric) {					strcpy(format, &quot;alphanumeric characters&quot;);				} else {					strcpy(format, &quot;digits&quot;);				}				snprintf(replyMsgBuffer, replyMsgBufferSize,					 &quot; \r\n   Enter your new PIN of %d to %d %s, \<a class="el" href="acutest_8h.html#a4eacae1d9e7c39f8236bb36d4ececa77">r\n</a>		<a class="el" href="acutest_8h.html#a4eacae1d9e7c39f8236bb36d4ececa77">or\r\n</a>   &lt;Ctrl-D&gt; to cancel the New PIN procedure:&quot;,					 pin_params.Min, pin_params.Max, format);			}			/* insert new session <a class="el" href="value_8h.html#a47ef05ec8d75829006b7eba839c1b603">in</a> the session list */			<a class="el" href="rlm__securid_8h.html#a19a0f963092887cb5c7a50538776a0fc">securid_sessionlist_add</a>(<a class="el" href="rlm__passwd_8c.html#a5a012410c9dc2b8d34d0c5a49231a7e7">inst</a>, request, securid_session);			<a class="el" href="rlm__securid_8c.html#a9717e7bbecb906637e86cef6da3d83c2">return</a> RC_SECURID_AUTH_CHALLENGE;		case ACM_NEXT_CODE_REQUIRED:			<a class="el" href="lib_2server_2log_8h.html#a0a15527c77f692028b4fd08e8a3fcd9e">RDEBUG2</a>(&quot;Next securid token code required for %s&quot;,				username);			/* create a new session */			securid_session = <a class="el" href="rlm__securid_8h.html#a8fc9bbdfa13e65b0fcfecde5a7574b01">securid_session_alloc</a>();			securid_session-&gt;sdiHandle = sdiHandle;			securid_session-&gt;securidSessionState = <a class="el" href="rlm__securid_8h.html#ad1331b73a03f873b01f69e66e32a8883ae725e8528e98d0401237e0cefa40a17e">NEXT_CODE_REQUIRED_STATE</a>;			securid_session-&gt;identity = <a class="el" href="talloc_8h.html#a3536feb85c89aa239851ef0830b72e64">talloc_typed_strdup</a>(securid_session, <a class="el" href="rlm__securid_8c.html#a0adcbe0e0e6f64a29b1d205ede9632c1">username</a>);			/* insert new session <a class="el" href="value_8h.html#a47ef05ec8d75829006b7eba839c1b603">in</a> the session list */			<a class="el" href="rlm__securid_8h.html#a19a0f963092887cb5c7a50538776a0fc">securid_sessionlist_add</a>(<a class="el" href="rlm__passwd_8c.html#a5a012410c9dc2b8d34d0c5a49231a7e7">inst</a>, request, securid_session);			<a class="el" href="strlcpy_8c.html#a59f9599e77ee687b1daaa179f8b9a2f3">strlcpy</a>(replyMsgBuffer, &quot;\r\nPlease Enter the Next Code from Your Token:&quot;, replyMsgBufferSize);			<a class="el" href="rlm__securid_8c.html#a9717e7bbecb906637e86cef6da3d83c2">return</a> RC_SECURID_AUTH_CHALLENGE;		default:			<a class="el" href="dhcpclient_8c.html#a15378cd15bafb3a79061424b452497aa">ERROR</a>(&quot;SecurID: Unexpected error from ACE/Agent API acm_ret=%d&quot;, acm_ret);			<a class="el" href="rlm__securid_8h.html#a918cf7252f7368977388ddcbc39b0612">securid_session_free</a>(<a class="el" href="rlm__passwd_8c.html#a5a012410c9dc2b8d34d0c5a49231a7e7">inst</a>, request, securid_session);			<a class="el" href="rlm__securid_8c.html#a9717e7bbecb906637e86cef6da3d83c2">return</a> RC_SECURID_AUTH_FAILURE;		}	} <a class="el" href="acutest_8h.html#a0544c3fe466e421738dae463968b70ba">else</a> {		/* existing session found */		<a class="el" href="lib_2server_2log_8h.html#a0a15527c77f692028b4fd08e8a3fcd9e">RDEBUG2</a>(&quot;Continuing previous session found for user [%s]&quot;, username);		/* continue previous session */		switch (securid_session-&gt;securidSessionState) {		case NEXT_CODE_REQUIRED_STATE:			<a class="el" href="lib_2server_2log_8h.html#a06ba507a9538ae220b90139545fb7ba8">DEBUG2</a>(&quot;Securid NEXT_CODE_REQUIRED_STATE: User [%s]&quot;, username);			/* next token code mode */			acm_ret = SD_Next(securid_session-&gt;sdiHandle, securid_pass);			<a class="el" href="acutest_8h.html#a28855fa01b85a12f2d0ce002f5131535">if</a> (acm_ret == ACM_OK) {				<a class="el" href="lib_2server_2log_8h.html#a79e06bb5462f23cf40113958bd51819e">INFO</a>(&quot;Next SecurID token accepted for [%s].&quot;, securid_session-&gt;identity);				rc = RC_SECURID_AUTH_SUCCESS;			} <a class="el" href="acutest_8h.html#a0544c3fe466e421738dae463968b70ba">else</a> {				<a class="el" href="lib_2server_2log_8h.html#a79e06bb5462f23cf40113958bd51819e">INFO</a>(&quot;SecurID: Next token rejected for [%s].&quot;, securid_session-&gt;identity);				rc = RC_SECURID_AUTH_FAILURE;			}			/* deallocate session */			<a class="el" href="rlm__securid_8h.html#a918cf7252f7368977388ddcbc39b0612">securid_session_free</a>(<a class="el" href="rlm__passwd_8c.html#a5a012410c9dc2b8d34d0c5a49231a7e7">inst</a>, request, securid_session);			<a class="el" href="rlm__securid_8c.html#a9717e7bbecb906637e86cef6da3d83c2">return</a> rc;		case NEW_PIN_REQUIRED_STATE:			<a class="el" href="lib_2server_2log_8h.html#a0a15527c77f692028b4fd08e8a3fcd9e">RDEBUG2</a>(&quot;SecurID <a class="el" href="rlm__securid_8h.html#ad1331b73a03f873b01f69e66e32a8883a60f094cda48e7ed2b9b2ef6819eb6c2d">NEW_PIN_REQUIRED_STATE</a> for %s&quot;,				username);			/* save the previous pin */			<a class="el" href="acutest_8h.html#a28855fa01b85a12f2d0ce002f5131535">if</a> (securid_session-&gt;pin) TALLOC_FREE(securid_session-&gt;pin);			securid_session-&gt;pin = <a class="el" href="talloc_8h.html#a3536feb85c89aa239851ef0830b72e64">talloc_typed_strdup</a>(securid_session, passcode);			<a class="el" href="strlcpy_8c.html#a59f9599e77ee687b1daaa179f8b9a2f3">strlcpy</a>(replyMsgBuffer, &quot;\r\n		 Please re-enter new PIN:&quot;, replyMsgBufferSize);			/* set next state */			securid_session-&gt;securidSessionState = <a class="el" href="rlm__securid_8h.html#ad1331b73a03f873b01f69e66e32a8883afc9f782e42b551f564bf70a08cceb4db">NEW_PIN_USER_CONFIRM_STATE</a>;			/* insert the updated session <a class="el" href="value_8h.html#a47ef05ec8d75829006b7eba839c1b603">in</a> the session list */			<a class="el" href="rlm__securid_8h.html#a19a0f963092887cb5c7a50538776a0fc">securid_sessionlist_add</a>(<a class="el" href="rlm__passwd_8c.html#a5a012410c9dc2b8d34d0c5a49231a7e7">inst</a>, request, securid_session);			<a class="el" href="rlm__securid_8c.html#a9717e7bbecb906637e86cef6da3d83c2">return</a> RC_SECURID_AUTH_CHALLENGE;		case NEW_PIN_USER_CONFIRM_STATE:			<a class="el" href="lib_2server_2log_8h.html#a0a15527c77f692028b4fd08e8a3fcd9e">RDEBUG2</a>(&quot;SecurID NEW_PIN_USER_CONFIRM_STATE: User [%s]&quot;, username);			/* compare previous pin and current pin */			<a class="el" href="acutest_8h.html#a28855fa01b85a12f2d0ce002f5131535">if</a> (!securid_session-&gt;pin || strcmp(securid_session-&gt;pin, passcode)) {				<a class="el" href="lib_2server_2log_8h.html#a0a15527c77f692028b4fd08e8a3fcd9e">RDEBUG2</a>(&quot;Pin confirmation failed. Pins do not match [%s] and [%s]&quot;,				       SAFE_STR(securid_session-&gt;pin), securid_pass);				/* pins do not match */				/* challenge the user again */				AceGetPinParams(securid_session-&gt;sdiHandle, &amp;pin_params);				<a class="el" href="acutest_8h.html#a28855fa01b85a12f2d0ce002f5131535">if</a> (pin_params.Alphanumeric) {					strcpy(format, &quot;alphanumeric characters&quot;);				} else {					strcpy(format, &quot;digits&quot;);				}				snprintf(replyMsgBuffer, replyMsgBufferSize,					 &quot; \r\n   Pins do not match--Please try <a class="el" href="acutest_8h.html#a4eacae1d9e7c39f8236bb36d4ececa77">again.\r\n</a>   Enter your new PIN of %d to %d %s, \<a class="el" href="acutest_8h.html#a4eacae1d9e7c39f8236bb36d4ececa77">r\n</a>		<a class="el" href="acutest_8h.html#a4eacae1d9e7c39f8236bb36d4ececa77">or\r\n</a>   &lt;Ctrl-D&gt; to cancel the New PIN procedure:&quot;,					 pin_params.Min, pin_params.Max, format);				securid_session-&gt;securidSessionState = <a class="el" href="rlm__securid_8h.html#ad1331b73a03f873b01f69e66e32a8883a60f094cda48e7ed2b9b2ef6819eb6c2d">NEW_PIN_REQUIRED_STATE</a>;				/* insert the updated session <a class="el" href="value_8h.html#a47ef05ec8d75829006b7eba839c1b603">in</a> the session list */				<a class="el" href="rlm__securid_8h.html#a19a0f963092887cb5c7a50538776a0fc">securid_sessionlist_add</a>(<a class="el" href="rlm__passwd_8c.html#a5a012410c9dc2b8d34d0c5a49231a7e7">inst</a>, request, securid_session);				rc = RC_SECURID_AUTH_CHALLENGE;			} <a class="el" href="acutest_8h.html#a0544c3fe466e421738dae463968b70ba">else</a> {				/* pins match */				<a class="el" href="lib_2server_2log_8h.html#a0a15527c77f692028b4fd08e8a3fcd9e">RDEBUG2</a>(&quot;Pin confirmation succeeded. Pins match&quot;);				acm_ret = SD_Pin(securid_session-&gt;sdiHandle, securid_pass);				<a class="el" href="acutest_8h.html#a28855fa01b85a12f2d0ce002f5131535">if</a> (acm_ret == ACM_NEW_PIN_ACCEPTED) {					<a class="el" href="lib_2server_2log_8h.html#a0a15527c77f692028b4fd08e8a3fcd9e">RDEBUG2</a>(&quot;New SecurID pin accepted for %s.&quot;, securid_session-&gt;identity);					securid_session-&gt;securidSessionState = <a class="el" href="rlm__securid_8h.html#ad1331b73a03f873b01f69e66e32a8883ab66854883b53d18fd05efa42d5650590">NEW_PIN_AUTH_VALIDATE_STATE</a>;					/* insert the updated session <a class="el" href="value_8h.html#a47ef05ec8d75829006b7eba839c1b603">in</a> the session list */					<a class="el" href="rlm__securid_8h.html#a19a0f963092887cb5c7a50538776a0fc">securid_sessionlist_add</a>(<a class="el" href="rlm__passwd_8c.html#a5a012410c9dc2b8d34d0c5a49231a7e7">inst</a>, request, securid_session);					rc = RC_SECURID_AUTH_CHALLENGE;					<a class="el" href="strlcpy_8c.html#a59f9599e77ee687b1daaa179f8b9a2f3">strlcpy</a>(replyMsgBuffer, &quot; \r\n\r\nWait for the code on your card to change, then enter new PIN and TokenCode\r\n\r\nEnter PASSCODE:&quot;, replyMsgBufferSize);				} <a class="el" href="acutest_8h.html#a0544c3fe466e421738dae463968b70ba">else</a> {					<a class="el" href="lib_2server_2log_8h.html#a0a15527c77f692028b4fd08e8a3fcd9e">RDEBUG2</a>(&quot;SecurID: New SecurID pin rejected for %s.&quot;, securid_session-&gt;identity);					SD_Pin(securid_session-&gt;sdiHandle, &amp;empty_pin[0]);  /* cancel PIN */					rc = RC_SECURID_AUTH_FAILURE;					/* deallocate session */					<a class="el" href="rlm__securid_8h.html#a918cf7252f7368977388ddcbc39b0612">securid_session_free</a>(<a class="el" href="rlm__passwd_8c.html#a5a012410c9dc2b8d34d0c5a49231a7e7">inst</a>, request, securid_session);				}			}			<a class="el" href="rlm__securid_8c.html#a9717e7bbecb906637e86cef6da3d83c2">return</a> rc;		case NEW_PIN_AUTH_VALIDATE_STATE:			acm_ret = SD_Check(securid_session-&gt;sdiHandle, securid_pass, securid_user);			<a class="el" href="acutest_8h.html#a28855fa01b85a12f2d0ce002f5131535">if</a> (acm_ret == ACM_OK) {				<a class="el" href="lib_2server_2log_8h.html#a0a15527c77f692028b4fd08e8a3fcd9e">RDEBUG2</a>(&quot;New SecurID passcode accepted for %s&quot;, securid_session-&gt;identity);				rc = RC_SECURID_AUTH_SUCCESS;			} <a class="el" href="acutest_8h.html#a0544c3fe466e421738dae463968b70ba">else</a> {				<a class="el" href="lib_2server_2log_8h.html#a79e06bb5462f23cf40113958bd51819e">INFO</a>(&quot;SecurID: New passcode rejected for [%s]&quot;, securid_session-&gt;identity);				rc = RC_SECURID_AUTH_FAILURE;			}			/* deallocate session */			<a class="el" href="rlm__securid_8h.html#a918cf7252f7368977388ddcbc39b0612">securid_session_free</a>(<a class="el" href="rlm__passwd_8c.html#a5a012410c9dc2b8d34d0c5a49231a7e7">inst</a>, request, securid_session);			<a class="el" href="rlm__securid_8c.html#a9717e7bbecb906637e86cef6da3d83c2">return</a> rc;		case NEW_PIN_SYSTEM_ACCEPT_STATE:			<a class="el" href="acutest_8h.html#a28855fa01b85a12f2d0ce002f5131535">if</a> (!strcmp(passcode, &quot;y&quot;)) {				AceGetSystemPin(securid_session-&gt;sdiHandle, new_pin);				/* Save the PIN for the next session				 * continuation */				<a class="el" href="acutest_8h.html#a28855fa01b85a12f2d0ce002f5131535">if</a> (securid_session-&gt;pin) TALLOC_FREE(securid_session-&gt;pin);				securid_session-&gt;pin = <a class="el" href="talloc_8h.html#a3536feb85c89aa239851ef0830b72e64">talloc_typed_strdup</a>(securid_session, new_pin);				<a class="el" href="snprintf_8c.html#a8da10a1735da7051de5c298ca7448eee">snprintf</a>(replyMsgBuffer, replyMsgBufferSize,					 &quot;\r\nYour new PIN is: %s\r\nDo you accept this [y/<a class="el" href="acutest_8h.html#a4eacae1d9e7c39f8236bb36d4ececa77">n</a>]?&quot;,					 new_pin);				securid_session-&gt;securidSessionState = <a class="el" href="rlm__securid_8h.html#ad1331b73a03f873b01f69e66e32a8883a558a10f9b7e68e56660fb45819aaa4d2">NEW_PIN_SYSTEM_CONFIRM_STATE</a>;				/* insert the updated session <a class="el" href="value_8h.html#a47ef05ec8d75829006b7eba839c1b603">in</a> the				 * session list */				<a class="el" href="rlm__securid_8h.html#a19a0f963092887cb5c7a50538776a0fc">securid_sessionlist_add</a>(<a class="el" href="rlm__passwd_8c.html#a5a012410c9dc2b8d34d0c5a49231a7e7">inst</a>, request, securid_session);				rc = RC_SECURID_AUTH_CHALLENGE;			} <a class="el" href="acutest_8h.html#a0544c3fe466e421738dae463968b70ba">else</a> {				SD_Pin(securid_session-&gt;sdiHandle, &amp;empty_pin[0]); //Cancel new PIN				/* deallocate session */				<a class="el" href="rlm__securid_8h.html#a918cf7252f7368977388ddcbc39b0612">securid_session_free</a>(<a class="el" href="rlm__passwd_8c.html#a5a012410c9dc2b8d34d0c5a49231a7e7">inst</a>, request, securid_session);				rc = RC_SECURID_AUTH_FAILURE;			}			<a class="el" href="rlm__securid_8c.html#a9717e7bbecb906637e86cef6da3d83c2">return</a> rc;		case NEW_PIN_SYSTEM_CONFIRM_STATE:			acm_ret = SD_Pin(securid_session-&gt;sdiHandle, (SD_CHAR*)securid_session-&gt;pin);			<a class="el" href="acutest_8h.html#a28855fa01b85a12f2d0ce002f5131535">if</a> (acm_ret == ACM_NEW_PIN_ACCEPTED) {				<a class="el" href="strlcpy_8c.html#a59f9599e77ee687b1daaa179f8b9a2f3">strlcpy</a>(replyMsgBuffer, &quot; \r\n\r\nPin Accepted. Wait for the code on your card to change, then enter new PIN and TokenCode\r\n\r\nEnter PASSCODE:&quot;, replyMsgBufferSize);				securid_session-&gt;securidSessionState = <a class="el" href="rlm__securid_8h.html#ad1331b73a03f873b01f69e66e32a8883ab66854883b53d18fd05efa42d5650590">NEW_PIN_AUTH_VALIDATE_STATE</a>;				/* insert the updated session <a class="el" href="value_8h.html#a47ef05ec8d75829006b7eba839c1b603">in</a> the session list */				<a class="el" href="rlm__securid_8h.html#a19a0f963092887cb5c7a50538776a0fc">securid_sessionlist_add</a>(<a class="el" href="rlm__passwd_8c.html#a5a012410c9dc2b8d34d0c5a49231a7e7">inst</a>, request, securid_session);				rc = RC_SECURID_AUTH_CHALLENGE;			} <a class="el" href="acutest_8h.html#a0544c3fe466e421738dae463968b70ba">else</a> {				SD_Pin(securid_session-&gt;sdiHandle, &amp;empty_pin[0]); //Cancel new PIN				<a class="el" href="strlcpy_8c.html#a59f9599e77ee687b1daaa179f8b9a2f3">strlcpy</a>(replyMsgBuffer, &quot; \r\n\r\nPin Rejected. Wait for the code on your card to change, then try again.\r\n\r\nEnter PASSCODE:&quot;, replyMsgBufferSize);				/* deallocate session */				<a class="el" href="rlm__securid_8h.html#a918cf7252f7368977388ddcbc39b0612">securid_session_free</a>(<a class="el" href="rlm__passwd_8c.html#a5a012410c9dc2b8d34d0c5a49231a7e7">inst</a>, request, securid_session);				rc = RC_SECURID_AUTH_FAILURE;			}			<a class="el" href="rlm__securid_8c.html#a9717e7bbecb906637e86cef6da3d83c2">return</a> rc;			/* USER_SELECTABLE state should be implemented to preserve compatibility with AM 6.x servers, which can <a class="el" href="rlm__securid_8c.html#a9717e7bbecb906637e86cef6da3d83c2">return</a> this state */		case NEW_PIN_USER_SELECT_STATE:			<a class="el" href="acutest_8h.html#a28855fa01b85a12f2d0ce002f5131535">if</a> (!strcmp(passcode, &quot;y&quot;)) {				/* User has opted for a system-generated PIN */				AceGetSystemPin(securid_session-&gt;sdiHandle, new_pin);				<a class="el" href="snprintf_8c.html#a8da10a1735da7051de5c298ca7448eee">snprintf</a>(replyMsgBuffer, replyMsgBufferSize,					 &quot;\r\nYour new PIN is: %s\r\nDo you accept this [y/<a class="el" href="acutest_8h.html#a4eacae1d9e7c39f8236bb36d4ececa77">n</a>]?&quot;,					 new_pin);				securid_session-&gt;securidSessionState = <a class="el" href="rlm__securid_8h.html#ad1331b73a03f873b01f69e66e32a8883a558a10f9b7e68e56660fb45819aaa4d2">NEW_PIN_SYSTEM_CONFIRM_STATE</a>;				/* insert the updated session <a class="el" href="value_8h.html#a47ef05ec8d75829006b7eba839c1b603">in</a> the session list */				<a class="el" href="rlm__securid_8h.html#a19a0f963092887cb5c7a50538776a0fc">securid_sessionlist_add</a>(<a class="el" href="rlm__passwd_8c.html#a5a012410c9dc2b8d34d0c5a49231a7e7">inst</a>, request,							securid_session);				rc = RC_SECURID_AUTH_CHALLENGE;			} <a class="el" href="acutest_8h.html#a0544c3fe466e421738dae463968b70ba">else</a> {				/* User has opted for a user-defined PIN */				AceGetPinParams(securid_session-&gt;sdiHandle,						&amp;pin_params);				<a class="el" href="acutest_8h.html#a28855fa01b85a12f2d0ce002f5131535">if</a> (pin_params.Alphanumeric) {					strcpy(format, &quot;alphanumeric characters&quot;);				} else {					strcpy(format, &quot;digits&quot;);				}				snprintf(replyMsgBuffer, replyMsgBufferSize,					 &quot; \r\n   Enter your new PIN of %d to %d %s, \<a class="el" href="acutest_8h.html#a4eacae1d9e7c39f8236bb36d4ececa77">r\n</a>		<a class="el" href="acutest_8h.html#a4eacae1d9e7c39f8236bb36d4ececa77">or\r\n</a>   &lt;Ctrl-D&gt; to cancel the New PIN procedure:&quot;,					 pin_params.Min, pin_params.Max, format);				securid_session-&gt;securidSessionState = <a class="el" href="rlm__securid_8h.html#ad1331b73a03f873b01f69e66e32a8883a60f094cda48e7ed2b9b2ef6819eb6c2d">NEW_PIN_REQUIRED_STATE</a>;				/* insert the updated session <a class="el" href="value_8h.html#a47ef05ec8d75829006b7eba839c1b603">in</a> the session list */				<a class="el" href="rlm__securid_8h.html#a19a0f963092887cb5c7a50538776a0fc">securid_sessionlist_add</a>(<a class="el" href="rlm__passwd_8c.html#a5a012410c9dc2b8d34d0c5a49231a7e7">inst</a>, request,							securid_session);				rc = RC_SECURID_AUTH_CHALLENGE;			}			<a class="el" href="rlm__securid_8c.html#a9717e7bbecb906637e86cef6da3d83c2">return</a> rc;		default:			<a class="el" href="dhcpclient_8c.html#a15378cd15bafb3a79061424b452497aa">ERROR</a>(&quot;Invalid session state %d for user \&quot;%s\&quot;&quot;, securid_session-&gt;securidSessionState,</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="rlm__securid_8c_source.html#l00027">27</a> of file <a class="el" href="rlm__securid_8c_source.html">rlm_securid.c</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a6dab4bbc315ece5039fc5c69f93cda26"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6dab4bbc315ece5039fc5c69f93cda26">&#9670;&nbsp;</a></span>mod_authenticate()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="action_8h.html#ad02ab717522305fe70aab72d152fc812">unlang_action_t</a> mod_authenticate </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="rcode_8h.html#adcc711080df76349e177fc29a641d1fb">rlm_rcode_t</a> *&#160;</td>
          <td class="paramname"><em>p_result</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="server_2module_8h.html#a9bcf8e012c49bd2f269dd276981a72a0">module_ctx_t</a> const *&#160;</td>
          <td class="paramname"><em>mctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="radclient_8c.html#a2fc1b64f51f8225195d32592e6fe8fc5">request_t</a> *&#160;</td>
          <td class="paramname"><em>request</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="rlm__securid_8c_source.html#l00468">468</a> of file <a class="el" href="rlm__securid_8c_source.html">rlm_securid.c</a>.</p>
<div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="rlm__securid_8c_a6dab4bbc315ece5039fc5c69f93cda26_cgraph.svg" width="100%" height="491"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>

</div>
</div>
<a id="a58558dfc841067f4efe9262f6452ead0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a58558dfc841067f4efe9262f6452ead0">&#9670;&nbsp;</a></span>mod_detach()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int mod_detach </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>instance</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="rlm__securid_8c_source.html#l00430">430</a> of file <a class="el" href="rlm__securid_8c_source.html">rlm_securid.c</a>.</p>

</div>
</div>
<a id="a0af0fa030319c2f5835b37c159cbbf28"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0af0fa030319c2f5835b37c159cbbf28">&#9670;&nbsp;</a></span>mod_instantiate()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int mod_instantiate </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>instance</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="build_8h.html#addf5ec070e9499d36b7f2009ce736076">UNUSED</a> <a class="el" href="cf__util_8h.html#a0f39d8043920472ea4c687c97f7173b3">CONF_SECTION</a> *&#160;</td>
          <td class="paramname"><em>conf</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="rlm__securid_8c_source.html#l00446">446</a> of file <a class="el" href="rlm__securid_8c_source.html">rlm_securid.c</a>.</p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a91cf6fbebedd86150a36e5ac3d5d3bfc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a91cf6fbebedd86150a36e5ac3d5d3bfc">&#9670;&nbsp;</a></span>break</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">break</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="rlm__securid_8c_source.html#l00421">421</a> of file <a class="el" href="rlm__securid_8c_source.html">rlm_securid.c</a>.</p>

</div>
</div>
<a id="a9717e7bbecb906637e86cef6da3d83c2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9717e7bbecb906637e86cef6da3d83c2">&#9670;&nbsp;</a></span>return</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">return</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="rlm__securid_8c_source.html#l00425">425</a> of file <a class="el" href="rlm__securid_8c_source.html">rlm_securid.c</a>.</p>

</div>
</div>
<a id="ab681363ad60438294a46ba7af6ab7a39"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab681363ad60438294a46ba7af6ab7a39">&#9670;&nbsp;</a></span>rlm_securid</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="server_2module_8h.html#a6eb2350874d0c396b230f58b4b5d6ff1">module_t</a> rlm_securid</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {</div><div class="line">        .magic          = <a class="code" href="dl__module_8h.html#aff47f8c16fc4985996ff84b7fb037e30">RLM_MODULE_INIT</a>,</div><div class="line">        .name           = <span class="stringliteral">&quot;securid&quot;</span>,</div><div class="line">        .inst_size      = <span class="keyword">sizeof</span>(<a class="code" href="rlm__securid_8h.html#structrlm__securid__t">rlm_securid_t</a>),</div><div class="line">        .<a class="code" href="bsc_8c.html#a74bb62276efdf39dd94048e007fca05b">config</a>         = <a class="code" href="radwho_8c.html#a69bd7510e62c21b6f328050b3c22165b">module_config</a>,</div><div class="line">        .instantiate    = <a class="code" href="rlm__securid_8c.html#a0af0fa030319c2f5835b37c159cbbf28">mod_instantiate</a>,</div><div class="line">        .detach         = <a class="code" href="rlm__securid_8c.html#a58558dfc841067f4efe9262f6452ead0">mod_detach</a>,</div><div class="line">        .methods = {</div><div class="line">                [<a class="code" href="components_8h.html#a390dde0bbf527b9f0eda144be1492223af7b3fcb2fc57455d499810957686ee37">MOD_AUTHENTICATE</a>]      = <a class="code" href="rlm__securid_8c.html#a6dab4bbc315ece5039fc5c69f93cda26">mod_authenticate</a></div><div class="line">        },</div><div class="line">}</div><div class="ttc" id="rlm__securid_8c_html_a0af0fa030319c2f5835b37c159cbbf28"><div class="ttname"><a href="rlm__securid_8c.html#a0af0fa030319c2f5835b37c159cbbf28">mod_instantiate</a></div><div class="ttdeci">static int mod_instantiate(void *instance, UNUSED CONF_SECTION *conf)</div><div class="ttdef"><b>Definition:</b> <a href="rlm__securid_8c_source.html#l00446">rlm_securid.c:446</a></div></div>
<div class="ttc" id="dl__module_8h_html_aff47f8c16fc4985996ff84b7fb037e30"><div class="ttname"><a href="dl__module_8h.html#aff47f8c16fc4985996ff84b7fb037e30">RLM_MODULE_INIT</a></div><div class="ttdeci">#define RLM_MODULE_INIT</div><div class="ttdoc">Stop people using different module/library/server versions together. </div><div class="ttdef"><b>Definition:</b> <a href="dl__module_8h_source.html#l00053">dl_module.h:53</a></div></div>
<div class="ttc" id="rlm__securid_8h_html_structrlm__securid__t"><div class="ttname"><a href="rlm__securid_8h.html#structrlm__securid__t">rlm_securid_t</a></div><div class="ttdef"><b>Definition:</b> <a href="rlm__securid_8h_source.html#l00064">rlm_securid.h:64</a></div></div>
<div class="ttc" id="rlm__securid_8c_html_a6dab4bbc315ece5039fc5c69f93cda26"><div class="ttname"><a href="rlm__securid_8c.html#a6dab4bbc315ece5039fc5c69f93cda26">mod_authenticate</a></div><div class="ttdeci">static unlang_action_t mod_authenticate(rlm_rcode_t *p_result, module_ctx_t const *mctx, request_t *request)</div><div class="ttdef"><b>Definition:</b> <a href="rlm__securid_8c_source.html#l00468">rlm_securid.c:468</a></div></div>
<div class="ttc" id="radwho_8c_html_a69bd7510e62c21b6f328050b3c22165b"><div class="ttname"><a href="radwho_8c.html#a69bd7510e62c21b6f328050b3c22165b">module_config</a></div><div class="ttdeci">static const CONF_PARSER module_config[]</div><div class="ttdef"><b>Definition:</b> <a href="radwho_8c_source.html#l00059">radwho.c:59</a></div></div>
<div class="ttc" id="bsc_8c_html_a74bb62276efdf39dd94048e007fca05b"><div class="ttname"><a href="bsc_8c.html#a74bb62276efdf39dd94048e007fca05b">config</a></div><div class="ttdeci">char * config</div><div class="ttdef"><b>Definition:</b> <a href="bsc_8c_source.html#l00056">bsc.c:56</a></div></div>
<div class="ttc" id="rlm__securid_8c_html_a58558dfc841067f4efe9262f6452ead0"><div class="ttname"><a href="rlm__securid_8c.html#a58558dfc841067f4efe9262f6452ead0">mod_detach</a></div><div class="ttdeci">static int mod_detach(void *instance)</div><div class="ttdef"><b>Definition:</b> <a href="rlm__securid_8c_source.html#l00430">rlm_securid.c:430</a></div></div>
<div class="ttc" id="components_8h_html_a390dde0bbf527b9f0eda144be1492223af7b3fcb2fc57455d499810957686ee37"><div class="ttname"><a href="components_8h.html#a390dde0bbf527b9f0eda144be1492223af7b3fcb2fc57455d499810957686ee37">MOD_AUTHENTICATE</a></div><div class="ttdoc">0 methods index for authenticate section. </div><div class="ttdef"><b>Definition:</b> <a href="components_8h_source.html#l00033">components.h:33</a></div></div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="rlm__securid_8c_source.html#l00554">554</a> of file <a class="el" href="rlm__securid_8c_source.html">rlm_securid.c</a>.</p>

</div>
</div>
<a id="a0adcbe0e0e6f64a29b1d205ede9632c1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0adcbe0e0e6f64a29b1d205ede9632c1">&#9670;&nbsp;</a></span>username</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">username</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="rlm__securid_8c_source.html#l00420">420</a> of file <a class="el" href="rlm__securid_8c_source.html">rlm_securid.c</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Fri Nov 13 2020 22:09:01 by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
