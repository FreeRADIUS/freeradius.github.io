<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>/home/runner/work/freeradius-server/freeradius-server/src/lib/sim/comp128.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="freeradius.png"/></td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_c85d3e3c5052e9ad9ce18c6863244a25.html">lib</a></li><li class="navelem"><a class="el" href="dir_794c1bacd89d5c58c75c4338ddce4a3f.html">sim</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">comp128.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Implementations of comp128v1, comp128v2, comp128v3 algorithms.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="comp128_8h_source.html">comp128.h</a>&quot;</code><br />
<code>#include &lt;stdio.h&gt;</code><br />
</div><div class="textblock"><div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="closed.png" alt="+"/> Include dependency graph for comp128.c:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="comp128_8c__incl.svg" width="278" height="216"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</div>
<p><a href="comp128_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a5e99217608aeb1dabc679eeb9d2b22fd"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="comp128_8c.html#a5e99217608aeb1dabc679eeb9d2b22fd">_comp128_bitsfrombytes</a> (uint8_t *x, uint8_t *bits)</td></tr>
<tr class="separator:a5e99217608aeb1dabc679eeb9d2b22fd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7f442d38026c015efd256e76a921990b"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="comp128_8c.html#a7f442d38026c015efd256e76a921990b">_comp128_compression</a> (uint8_t *x)</td></tr>
<tr class="separator:a7f442d38026c015efd256e76a921990b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0304701c01325fbee210e956ecfb5d8a"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="comp128_8c.html#a0304701c01325fbee210e956ecfb5d8a">_comp128_compression_round</a> (uint8_t *x, int <a class="el" href="acutest_8h.html#a4eacae1d9e7c39f8236bb36d4ececa77">n</a>, const uint8_t *tbl)</td></tr>
<tr class="separator:a0304701c01325fbee210e956ecfb5d8a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4c473f3b288df76d3bed9004d14ac1e5"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="comp128_8c.html#a4c473f3b288df76d3bed9004d14ac1e5">_comp128_permutation</a> (uint8_t *x, uint8_t *bits)</td></tr>
<tr class="separator:a4c473f3b288df76d3bed9004d14ac1e5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa9ad473cf971e220b69a35299eaaf4de"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="comp128_8c.html#aa9ad473cf971e220b69a35299eaaf4de">_comp128v23</a> (uint8_t *rand, uint8_t const *kxor)</td></tr>
<tr class="separator:aa9ad473cf971e220b69a35299eaaf4de"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a35fa4083227dc609086c80b66d05950d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="comp128_8c.html#a35fa4083227dc609086c80b66d05950d">comp128v1</a> (uint8_t sres[static 4], uint8_t kc[static 8], uint8_t const ki[static 16], uint8_t const rand[static 16])</td></tr>
<tr class="memdesc:a35fa4083227dc609086c80b66d05950d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate comp128v1 sres and kc from ki and rand.  <a href="#a35fa4083227dc609086c80b66d05950d">More...</a><br /></td></tr>
<tr class="separator:a35fa4083227dc609086c80b66d05950d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5d4168028ccd505946cb69b67abdd297"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="comp128_8c.html#a5d4168028ccd505946cb69b67abdd297">comp128v23</a> (uint8_t sres[static 4], uint8_t kc[static 8], uint8_t const ki[static 16], uint8_t const rand[static 16], bool v2)</td></tr>
<tr class="memdesc:a5d4168028ccd505946cb69b67abdd297"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate comp128v2 or comp128v3 sres and kc from ki and rand.  <a href="#a5d4168028ccd505946cb69b67abdd297">More...</a><br /></td></tr>
<tr class="separator:a5d4168028ccd505946cb69b67abdd297"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a42272c5ea4fe63c408555f27382406e3"><td class="memItemLeft" align="right" valign="top">static uint8_t const  *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="comp128_8c.html#a42272c5ea4fe63c408555f27382406e3">_comp128_table</a> [] = { <a class="el" href="comp128_8c.html#a62590521aad292649cc57f0a453c8489">comp128v1_t0</a>, <a class="el" href="comp128_8c.html#ad4bff799d424f4f9897aed3c53f973fb">comp128v1_t1</a>, <a class="el" href="comp128_8c.html#a63efe01c33d76cb7f35cd6bb1bbe95ee">comp128v1_t2</a>, <a class="el" href="comp128_8c.html#ab449497d51d9e65dabf2cd58626fbb90">comp128v1_t3</a>, <a class="el" href="comp128_8c.html#a0b3902d4a7d63906b187e14a8c4e6ee5">comp128v1_t4</a> }</td></tr>
<tr class="separator:a42272c5ea4fe63c408555f27382406e3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a62590521aad292649cc57f0a453c8489"><td class="memItemLeft" align="right" valign="top">static uint8_t const&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="comp128_8c.html#a62590521aad292649cc57f0a453c8489">comp128v1_t0</a> []</td></tr>
<tr class="separator:a62590521aad292649cc57f0a453c8489"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad4bff799d424f4f9897aed3c53f973fb"><td class="memItemLeft" align="right" valign="top">static uint8_t const&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="comp128_8c.html#ad4bff799d424f4f9897aed3c53f973fb">comp128v1_t1</a> []</td></tr>
<tr class="separator:ad4bff799d424f4f9897aed3c53f973fb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a63efe01c33d76cb7f35cd6bb1bbe95ee"><td class="memItemLeft" align="right" valign="top">static uint8_t const&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="comp128_8c.html#a63efe01c33d76cb7f35cd6bb1bbe95ee">comp128v1_t2</a> []</td></tr>
<tr class="separator:a63efe01c33d76cb7f35cd6bb1bbe95ee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab449497d51d9e65dabf2cd58626fbb90"><td class="memItemLeft" align="right" valign="top">static uint8_t const&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="comp128_8c.html#ab449497d51d9e65dabf2cd58626fbb90">comp128v1_t3</a> []</td></tr>
<tr class="separator:ab449497d51d9e65dabf2cd58626fbb90"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0b3902d4a7d63906b187e14a8c4e6ee5"><td class="memItemLeft" align="right" valign="top">static uint8_t const&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="comp128_8c.html#a0b3902d4a7d63906b187e14a8c4e6ee5">comp128v1_t4</a> []</td></tr>
<tr class="separator:a0b3902d4a7d63906b187e14a8c4e6ee5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abc535633e21fb26749aef59a84158d41"><td class="memItemLeft" align="right" valign="top">static uint8_t const&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="comp128_8c.html#abc535633e21fb26749aef59a84158d41">comp128v23_t0</a> []</td></tr>
<tr class="separator:abc535633e21fb26749aef59a84158d41"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1bf5be18cea6234a518954a54ccc9f4d"><td class="memItemLeft" align="right" valign="top">static uint8_t const&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="comp128_8c.html#a1bf5be18cea6234a518954a54ccc9f4d">comp128v23_t1</a> []</td></tr>
<tr class="separator:a1bf5be18cea6234a518954a54ccc9f4d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Implementations of comp128v1, comp128v2, comp128v3 algorithms. </p>
<p>Comp128v1 was inspired by code from: Marc Briceno <a href="#" onclick="location.href='mai'+'lto:'+'mar'+'c@'+'sca'+'rd'+'.or'+'g'; return false;">marc@<span style="display: none;">.nosp@m.</span>scar<span style="display: none;">.nosp@m.</span>d.org</a>, Ian Goldberg <a href="#" onclick="location.href='mai'+'lto:'+'ian'+'g@'+'cs.'+'be'+'rke'+'le'+'y.e'+'du'; return false;">iang@<span style="display: none;">.nosp@m.</span>cs.b<span style="display: none;">.nosp@m.</span>erkel<span style="display: none;">.nosp@m.</span>ey.e<span style="display: none;">.nosp@m.</span>du</a>, and David Wagner <a href="#" onclick="location.href='mai'+'lto:'+'daw'+'@c'+'s.b'+'er'+'kel'+'ey'+'.ed'+'u'; return false;">daw@c<span style="display: none;">.nosp@m.</span>s.be<span style="display: none;">.nosp@m.</span>rkele<span style="display: none;">.nosp@m.</span>y.ed<span style="display: none;">.nosp@m.</span>u</a></p>
<p>But it has been fully rewritten (Sylvain Munaut <a href="#" onclick="location.href='mai'+'lto:'+'tnt'+'@2'+'46t'+'Nt'+'.co'+'m'; return false;">tnt@2<span style="display: none;">.nosp@m.</span>46tN<span style="display: none;">.nosp@m.</span>t.com</a>) from various PDFs found online describing the algorithm because the licence of the code referenced above was unclear. A comment snippet from the original code is included below, it describes where the doc came from and how the algorithm was reverse engineered.</p>
<p>Comp128v2 &amp; v3 is a port of the python code from: <a href="http://www.hackingprojects.net/">http://www.hackingprojects.net/</a> The author of the original code is Tamas Jos <a href="#" onclick="location.href='mai'+'lto:'+'tam'+'as'+'.jo'+'s@'+'ske'+'ls'+'ec.'+'co'+'m'; return false;">tamas<span style="display: none;">.nosp@m.</span>.jos<span style="display: none;">.nosp@m.</span>@skel<span style="display: none;">.nosp@m.</span>sec.<span style="display: none;">.nosp@m.</span>com</a></p>
<dl class="section note"><dt>Note</dt><dd>The above GPL license only applies to comp128v1, the license for comp128v2 and comp128v3 is unknown.</dd></dl>
<dl class="section copyright"><dt>Copyright</dt><dd>2013 The FreeRADIUS server project </dd>
<dd>
2013 Hacking projects [<a href="http://www.hackingprojects.net/">http://www.hackingprojects.net/</a>] </dd>
<dd>
2009 Sylvain Munaut (<a href="#" onclick="location.href='mai'+'lto:'+'tnt'+'@2'+'46t'+'Nt'+'.co'+'m'; return false;">tnt@2<span style="display: none;">.nosp@m.</span>46tN<span style="display: none;">.nosp@m.</span>t.com</a>) </dd></dl>

<p class="definition">Definition in file <a class="el" href="comp128_8c_source.html">comp128.c</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a5e99217608aeb1dabc679eeb9d2b22fd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5e99217608aeb1dabc679eeb9d2b22fd">&#9670;&nbsp;</a></span>_comp128_bitsfrombytes()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void _comp128_bitsfrombytes </td>
          <td>(</td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>bits</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="comp128_8c_source.html#l00187">187</a> of file <a class="el" href="comp128_8c_source.html">comp128.c</a>.</p>

</div>
</div>
<a id="a7f442d38026c015efd256e76a921990b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7f442d38026c015efd256e76a921990b">&#9670;&nbsp;</a></span>_comp128_compression()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void _comp128_compression </td>
          <td>(</td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>x</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="comp128_8c_source.html#l00179">179</a> of file <a class="el" href="comp128_8c_source.html">comp128.c</a>.</p>
<div id="dynsection-1" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-1-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-1-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-1-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="comp128_8c_a7f442d38026c015efd256e76a921990b_cgraph.svg" width="384" height="52"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a0304701c01325fbee210e956ecfb5d8a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0304701c01325fbee210e956ecfb5d8a">&#9670;&nbsp;</a></span>_comp128_compression_round()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void _comp128_compression_round </td>
          <td>(</td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>tbl</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="comp128_8c_source.html#l00163">163</a> of file <a class="el" href="comp128_8c_source.html">comp128.c</a>.</p>

</div>
</div>
<a id="a4c473f3b288df76d3bed9004d14ac1e5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4c473f3b288df76d3bed9004d14ac1e5">&#9670;&nbsp;</a></span>_comp128_permutation()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void _comp128_permutation </td>
          <td>(</td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>bits</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="comp128_8c_source.html#l00199">199</a> of file <a class="el" href="comp128_8c_source.html">comp128.c</a>.</p>

</div>
</div>
<a id="aa9ad473cf971e220b69a35299eaaf4de"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa9ad473cf971e220b69a35299eaaf4de">&#9670;&nbsp;</a></span>_comp128v23()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void _comp128v23 </td>
          <td>(</td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>rand</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t const *&#160;</td>
          <td class="paramname"><em>kxor</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="comp128_8c_source.html#l00289">289</a> of file <a class="el" href="comp128_8c_source.html">comp128.c</a>.</p>

</div>
</div>
<a id="a35fa4083227dc609086c80b66d05950d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a35fa4083227dc609086c80b66d05950d">&#9670;&nbsp;</a></span>comp128v1()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void comp128v1 </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>sres</em>[static 4], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>kc</em>[static 8], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t const&#160;</td>
          <td class="paramname"><em>ki</em>[static 16], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t const&#160;</td>
          <td class="paramname"><em>rand</em>[static 16]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate comp128v1 sres and kc from ki and rand. </p>
<p>This code derived from a leaked document from the GSM standards. Some missing pieces were filled in by reverse-engineering a working SIM. We have verified that this is the correct COMP128 algorithm.</p>
<p>The first page of the document identifies it as <em>Technical Information: GSM System Security Study</em>. 10-1617-01, 10th June 1988. The bottom of the title page is marked Racal Research Ltd. Worton Drive, Worton Grange Industrial Estate, Reading, Berks. RG2 0SB, England. Telephone: Reading (0734) 868601 Telex: 847152 The relevant bits are in Part I, Section 20 (pages 66&ndash;67). Enjoy!</p>
<p>Note: There are three typos in the spec (discovered by reverse-engineering). First, "z = (2 * x[n] + x[n]) mod 2^(9-j)" should clearly read "z = (2 * x[m] + x[n]) mod 2^(9-j)". Second, the "k" loop in the "Form bits from bytes" section is severely botched: the k index should run only from 0 to 3, and clearly the range on "the (8-k)th bit of byte j" is also off (should be 0..7, not 1..8, to be consistent with the subsequent section). Third, SRES is taken from the first 8 nibbles of x[], not the last 8 as claimed in the document. (And the document doesn't specify how Kc is derived, but that was also easily discovered with reverse engineering.) All of these typos have been corrected in the following code.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">sres</td><td>4 byte value derived from ki and rand. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">kc</td><td>8 byte value derived from ki and rand. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ki</td><td>known only by the SIM and AuC (us in this case). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rand</td><td>16 bytes of randomness. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="comp128_8c_source.html#l00241">241</a> of file <a class="el" href="comp128_8c_source.html">comp128.c</a>.</p>
<div id="dynsection-2" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-2-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-2-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-2-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="comp128_8c_a35fa4083227dc609086c80b66d05950d_cgraph.svg" width="527" height="147"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a5d4168028ccd505946cb69b67abdd297"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5d4168028ccd505946cb69b67abdd297">&#9670;&nbsp;</a></span>comp128v23()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void comp128v23 </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>sres</em>[static 4], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>kc</em>[static 8], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t const&#160;</td>
          <td class="paramname"><em>ki</em>[static 16], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t const&#160;</td>
          <td class="paramname"><em>rand</em>[static 16], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>v2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate comp128v2 or comp128v3 sres and kc from ki and rand. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">sres</td><td>4 byte value derived from ki and rand. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">kc</td><td>8 byte value derived from ki and rand. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ki</td><td>known only by the SIM and AuC (us in this case). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rand</td><td>16 bytes of randomness. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">v2</td><td>if true we use version comp128-2 else we use comp128-3. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="comp128_8c_source.html#l00336">336</a> of file <a class="el" href="comp128_8c_source.html">comp128.c</a>.</p>
<div id="dynsection-3" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-3-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-3-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-3-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="comp128_8c_a5d4168028ccd505946cb69b67abdd297_cgraph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a42272c5ea4fe63c408555f27382406e3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a42272c5ea4fe63c408555f27382406e3">&#9670;&nbsp;</a></span>_comp128_table</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t const* _comp128_table[] = { <a class="el" href="comp128_8c.html#a62590521aad292649cc57f0a453c8489">comp128v1_t0</a>, <a class="el" href="comp128_8c.html#ad4bff799d424f4f9897aed3c53f973fb">comp128v1_t1</a>, <a class="el" href="comp128_8c.html#a63efe01c33d76cb7f35cd6bb1bbe95ee">comp128v1_t2</a>, <a class="el" href="comp128_8c.html#ab449497d51d9e65dabf2cd58626fbb90">comp128v1_t3</a>, <a class="el" href="comp128_8c.html#a0b3902d4a7d63906b187e14a8c4e6ee5">comp128v1_t4</a> }</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="comp128_8c_source.html#l00121">121</a> of file <a class="el" href="comp128_8c_source.html">comp128.c</a>.</p>

</div>
</div>
<a id="a62590521aad292649cc57f0a453c8489"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a62590521aad292649cc57f0a453c8489">&#9670;&nbsp;</a></span>comp128v1_t0</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t const comp128v1_t0[]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="comp128_8c_source.html#l00045">45</a> of file <a class="el" href="comp128_8c_source.html">comp128.c</a>.</p>

</div>
</div>
<a id="ad4bff799d424f4f9897aed3c53f973fb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad4bff799d424f4f9897aed3c53f973fb">&#9670;&nbsp;</a></span>comp128v1_t1</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t const comp128v1_t1[]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {</div><div class="line">        19,  11,  80,  114, 43,  1,   69,  94,  39,  18,  127, 117, 97,  3,   85,  43,</div><div class="line">        27,  124, 70,  83,  47,  71,  63,  10,  47,  89,  79,  4,   14,  59,  11,  5,</div><div class="line">        35,  107, 103, 68,  21,  86,  36,  91,  85,  126, 32,  50,  109, 94,  120, 6,</div><div class="line">        53,  79,  28,  45,  99,  95,  41,  34,  88,  68,  93,  55,  110, 125, 105, 20,</div><div class="line">        90,  80,  76,  96,  23,  60,  89,  64,  121, 56,  14,  74,  101, 8,   19,  78,</div><div class="line">        76,  66,  104, 46,  111, 50,  32,  3,   39,  0,   58,  25,  92,  22,  18,  51,</div><div class="line">        57,  65,  119, 116, 22,  109, 7,   86,  59,  93,  62,  110, 78,  99,  77,  67,</div><div class="line">        12,  113, 87,  98,  102, 5,   88,  33,  38,  56,  23,  8,   75,  45,  13,  75,</div><div class="line">        95,  63,  28,  49,  123, 120, 20,  112, 44,  30,  15,  98,  106, 2,   103, 29,</div><div class="line">        82,  107, 42,  124, 24,  30,  41,  16,  108, 100, 117, 40,  73,  40,  7,   114,</div><div class="line">        82,  115, 36,  112, 12,  102, 100, 84,  92,  48,  72,  97,  9,   54,  55,  74,</div><div class="line">        113, 123, 17,  26,  53,  58,  4,   9,   69,  122, 21,  118, 42,  60,  27,  73,</div><div class="line">        118, 125, 34,  15,  65,  115, 84,  64,  62,  81,  70,  1,   24,  111, 121, 83,</div><div class="line">        104, 81,  49,  127, 48,  105, 31,  10,  6,   91,  87,  37,  16,  54,  116, 126,</div><div class="line">        31,  38,  13,  0,   72,  106, 77,  61,  26,  67,  46,  29,  96,  37,  61,  52,</div><div class="line">        101, 17,  44,  108, 71,  52,  66,  57,  33,  51,  25,  90,  2,   119, 122, 35}</div></div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="comp128_8c_source.html#l00080">80</a> of file <a class="el" href="comp128_8c_source.html">comp128.c</a>.</p>

</div>
</div>
<a id="a63efe01c33d76cb7f35cd6bb1bbe95ee"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a63efe01c33d76cb7f35cd6bb1bbe95ee">&#9670;&nbsp;</a></span>comp128v1_t2</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t const comp128v1_t2[]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {</div><div class="line">        52,  50,  44,   6,  21,  49,  41,  59,  39,  51,  25,  32,  51,  47,  52,  43,</div><div class="line">        37,  4,   40,  34,  61,  12,  28,   4,  58,  23,   8,  15,  12,  22,   9,  18,</div><div class="line">        55,  10,  33,  35,  50,   1,  43,   3,  57,  13,  62,  14,   7,  42,  44,  59,</div><div class="line">        62,  57,  27,   6,   8,  31,  26,  54,  41,  22,  45,  20,  39,   3,  16,  56,</div><div class="line">        48,  2,   21,  28,  36,  42,  60,  33,  34,  18,   0,  11,  24,  10,  17,  61,</div><div class="line">        29,  14,  45,  26,  55,  46,  11,  17,  54,  46,   9,  24,  30,  60,  32,   0,</div><div class="line">        20,  38,  2,   30,  58,  35,   1,  16,  56,  40,  23,  48,  13,  19,  19,  27,</div><div class="line">        31,  53,  47,  38,  63,  15,  49,   5,  37,  53,  25,  36,  63,  29,   5,   7}</div></div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="comp128_8c_source.html#l00099">99</a> of file <a class="el" href="comp128_8c_source.html">comp128.c</a>.</p>

</div>
</div>
<a id="ab449497d51d9e65dabf2cd58626fbb90"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab449497d51d9e65dabf2cd58626fbb90">&#9670;&nbsp;</a></span>comp128v1_t3</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t const comp128v1_t3[]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {</div><div class="line">        1,   5,   29,  6,   25,  1,   18,  23,  17,  19,  0,   9,   24,  25,  6,   31,</div><div class="line">        28,  20,  24,  30,  4,   27,  3,   13,  15,  16,  14,  18,  4,   3,   8,   9,</div><div class="line">        20,  0,   12,  26,  21,  8,   28,  2,   29,  2,   15,  7,   11,  22,  14,  10,</div><div class="line">        17,  21,  12,  30,  26,  27,  16,  31,  11,  7,   13,  23,  10,  5,   22,  19}</div></div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="comp128_8c_source.html#l00110">110</a> of file <a class="el" href="comp128_8c_source.html">comp128.c</a>.</p>

</div>
</div>
<a id="a0b3902d4a7d63906b187e14a8c4e6ee5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0b3902d4a7d63906b187e14a8c4e6ee5">&#9670;&nbsp;</a></span>comp128v1_t4</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t const comp128v1_t4[]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {</div><div class="line">        15,  12,  10,  4,   1,   14,  11,  7,   5,   0,   14,  7,   1,   2,   13,  8,</div><div class="line">        10,  3,   4,   9,   6,   0,   3,   2,   5,   6,   8,   9,   11,  13,  15,  12}</div></div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="comp128_8c_source.html#l00117">117</a> of file <a class="el" href="comp128_8c_source.html">comp128.c</a>.</p>

</div>
</div>
<a id="abc535633e21fb26749aef59a84158d41"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abc535633e21fb26749aef59a84158d41">&#9670;&nbsp;</a></span>comp128v23_t0</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t const comp128v23_t0[]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {</div><div class="line">        197, 235, 60,  151, 98,  96,  3,   100, 248, 118, 42,  117, 172, 211, 181, 203,</div><div class="line">        61,  126, 156, 87,  149, 224, 55,  132, 186, 63,  238, 255, 85,  83,  152, 33,</div><div class="line">        160, 184, 210, 219, 159, 11,  180, 194, 130, 212, 147, 5,   215, 92,  27,  46,</div><div class="line">        113, 187, 52,  25,  185, 79,  221, 48,  70,  31,  101, 15,  195, 201, 50,  222,</div><div class="line">        137, 233, 229, 106, 122, 183, 178, 177, 144, 207, 234, 182, 37,  254, 227, 231,</div><div class="line">        54,  209, 133, 65,  202, 69,  237, 220, 189, 146, 120, 68,  21,  125, 38,  30,</div><div class="line">        2,   155, 53,  196, 174, 176, 51,  246, 167, 76,  110, 20,  82,  121, 103, 112,</div><div class="line">        56,  173, 49,  217, 252, 0,   114, 228, 123, 12,  93,  161, 253, 232, 240, 175,</div><div class="line">        67,  128, 22,  158, 89,  18,  77,  109, 190, 17,  62,  4,   153, 163, 59,  145,</div><div class="line">        138, 7,   74,  205, 10,  162, 80,  45,  104, 111, 150, 214, 154, 28,  191, 169,</div><div class="line">        213, 88,  193, 198, 200, 245, 39,  164, 124, 84,  78,  1,   188, 170, 23,  86,</div><div class="line">        226, 141, 32,  6,   131, 127, 199, 40,  135, 16,  57,  71,  91,  225, 168, 242,</div><div class="line">        206, 97,  166, 44,  14,  90,  236, 239, 230, 244, 223, 108, 102, 119, 148, 251,</div><div class="line">        29,  216, 8,   9,   249, 208, 24,  105, 94,  34,  64,  95,  115, 72,  134, 204,</div><div class="line">        43,  247, 243, 218, 47,  58,  73,  107, 241, 179, 116, 66,  36,  143, 81,  250,</div><div class="line">        139, 19,  13,  142, 140, 129, 192, 99,  171, 157, 136, 41,  75,  35,  165, 26</div><div class="line">}</div></div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="comp128_8c_source.html#l00124">124</a> of file <a class="el" href="comp128_8c_source.html">comp128.c</a>.</p>

</div>
</div>
<a id="a1bf5be18cea6234a518954a54ccc9f4d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1bf5be18cea6234a518954a54ccc9f4d">&#9670;&nbsp;</a></span>comp128v23_t1</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t const comp128v23_t1[]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {</div><div class="line">        170, 42,  95,  141, 109, 30,  71,  89,  26,  147, 231, 205, 239, 212, 124, 129,</div><div class="line">        216, 79,  15,  185, 153, 14,  251, 162, 0,   241, 172, 197, 43,  10,  194, 235,</div><div class="line">        6,   20,  72,  45,  143, 104, 161, 119, 41,  136, 38,  189, 135, 25,  93,  18,</div><div class="line">        224, 171, 252, 195, 63,  19,  58,  165, 23,  55,  133, 254, 214, 144, 220, 178,</div><div class="line">        156, 52,  110, 225, 97,  183, 140, 39,  53,  88,  219, 167, 16,  198, 62,  222,</div><div class="line">        76,  139, 175, 94,  51,  134, 115, 22,  67,  1,   249, 217, 3,   5,   232, 138,</div><div class="line">        31,  56,  116, 163, 70,  128, 234, 132, 229, 184, 244, 13,  34,  73,  233, 154,</div><div class="line">        179, 131, 215, 236, 142, 223, 27,  57,  246, 108, 211, 8,   253, 85,  66,  245,</div><div class="line">        193, 78,  190, 4,   17,  7,   150, 127, 152, 213, 37,  186, 2,   243, 46,  169,</div><div class="line">        68,  101, 60,  174, 208, 158, 176, 69,  238, 191, 90,  83,  166, 125, 77,  59,</div><div class="line">        21,  92,  49,  151, 168, 99,  9,   50,  146, 113, 117, 228, 65,  230, 40,  82,</div><div class="line">        54,  237, 227, 102, 28,  36,  107, 24,  44,  126, 206, 201, 61,  114, 164, 207,</div><div class="line">        181, 29,  91,  64,  221, 255, 48,  155, 192, 111, 180, 210, 182, 247, 203, 148,</div><div class="line">        209, 98,  173, 11,  75,  123, 250, 118, 32,  47,  240, 202, 74,  177, 100, 80,</div><div class="line">        196, 33,  248, 86,  157, 137, 120, 130, 84,  204, 122, 81,  242, 188, 200, 149,</div><div class="line">        226, 218, 160, 187, 106, 35,  87,  105, 96,  145, 199, 159, 12,  121, 103, 112</div><div class="line">}</div></div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="comp128_8c_source.html#l00144">144</a> of file <a class="el" href="comp128_8c_source.html">comp128.c</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Thu Nov 12 2020 23:27:14 by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
