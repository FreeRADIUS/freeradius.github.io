<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>/home/runner/work/freeradius-server/freeradius-server/src/lib/unlang/unlang_priv.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="freeradius.png"/></td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_c85d3e3c5052e9ad9ce18c6863244a25.html">lib</a></li><li class="navelem"><a class="el" href="dir_8bd9041bb00c2961befd0c0eb73aa27b.html">unlang</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">unlang_priv.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="unlang__priv_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="preprocessor">#pragma once</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"> *  This program is free software; you can redistribute it and/or modify</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"> *  it under the terms of the GNU General Public License as published by</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment"> *  the Free Software Foundation; either version 2, or (at your option)</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment"> *  any later version.</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment"> *  This program is distributed in the hope that it will be useful,</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment"> *  but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment"> *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment"> *  GNU General Public License for more details.</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment"> *  You should have received a copy of the GNU General Public License</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment"> *  along with this program; if not, write to the Free Software Foundation,</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment"> *  Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301, USA.</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">/**</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment"> * $Id: 72a2f8e363c67a2592b6370efe2c1f35b4bf948d $</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment"> * @file unlang/unlang_priv.h</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment"> * @brief Private interpreter structures and functions</span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment"> * @author Alan DeKok (aland@freeradius.org)</span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment"> * @copyright 2016-2019 The FreeRADIUS server project</span></div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="preprocessor">#include &lt;freeradius-devel/server/cf_util.h&gt;</span> <span class="comment">/* Need CONF_* definitions */</span></div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="preprocessor">#include &lt;freeradius-devel/server/cond_eval.h&gt;</span></div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="preprocessor">#include &lt;freeradius-devel/server/map_proc.h&gt;</span></div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="preprocessor">#include &lt;freeradius-devel/server/modpriv.h&gt;</span></div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="preprocessor">#include &lt;freeradius-devel/util/debug.h&gt;</span></div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#include &lt;freeradius-devel/unlang/base.h&gt;</span></div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="preprocessor">#include &lt;freeradius-devel/io/listen.h&gt;</span></div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="preprocessor">#ifdef __cplusplus</span></div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="keyword">extern</span> <span class="stringliteral">&quot;C&quot;</span> {</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="comment">/* Actions may be a positive integer (the highest one returned in the group</span></div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="comment"> * will be returned), or the keyword &quot;return&quot;, represented here by</span></div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment"> * MOD_ACTION_RETURN, to cause an immediate return.</span></div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="comment"> * There&#39;s also the keyword &quot;reject&quot;, represented here by MOD_ACTION_REJECT</span></div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment"> * to cause an immediate reject. */</span></div><div class="line"><a name="l00045"></a><span class="lineno"><a class="line" href="unlang__priv_8h.html#a78b546656241739add8991afbebc0493">   45</a></span>&#160;<span class="preprocessor">#define MOD_ACTION_RETURN  (-1)</span></div><div class="line"><a name="l00046"></a><span class="lineno"><a class="line" href="unlang__priv_8h.html#a495a96628c21f5483dfd27fef1c6aa6a">   46</a></span>&#160;<span class="preprocessor">#define MOD_ACTION_REJECT  (-2)</span></div><div class="line"><a name="l00047"></a><span class="lineno"><a class="line" href="unlang__priv_8h.html#a82703dc9659f9f55562e47c172d1037d">   47</a></span>&#160;<span class="preprocessor">#define MOD_PRIORITY_MAX   (64)</span></div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="comment">/** Types of unlang_t nodes</span></div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="comment"> * Here are our basic types: unlang_t, unlang_group_t, and unlang_module_t. For an</span></div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="comment"> * explanation of what they are all about, see doc/unlang/configurable_failover.adoc</span></div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00054"></a><span class="lineno"><a class="line" href="unlang__priv_8h.html#a9125308c5289036c4809f39fc5fcf7eb">   54</a></span>&#160;<span class="keyword">typedef</span> <span class="keyword">enum</span> {</div><div class="line"><a name="l00055"></a><span class="lineno"><a class="line" href="unlang__priv_8h.html#a9125308c5289036c4809f39fc5fcf7ebab34824e2fe477ee8b4c671d8d1d8de31">   55</a></span>&#160;        <a class="code" href="unlang__priv_8h.html#a9125308c5289036c4809f39fc5fcf7ebab34824e2fe477ee8b4c671d8d1d8de31">UNLANG_TYPE_NULL</a> = 0,                   <span class="comment">//!&lt; unlang type not set.</span></div><div class="line"><a name="l00056"></a><span class="lineno"><a class="line" href="unlang__priv_8h.html#a9125308c5289036c4809f39fc5fcf7ebad3feb6676ba8189507cbe9be815a0854">   56</a></span>&#160;<span class="comment"></span>        <a class="code" href="unlang__priv_8h.html#a9125308c5289036c4809f39fc5fcf7ebad3feb6676ba8189507cbe9be815a0854">UNLANG_TYPE_MODULE</a> = 1,                 <span class="comment">//!&lt; Module method.</span></div><div class="line"><a name="l00057"></a><span class="lineno"><a class="line" href="unlang__priv_8h.html#a9125308c5289036c4809f39fc5fcf7ebae09a7b73744305b3b6eedfda7b432225">   57</a></span>&#160;<span class="comment"></span>        <a class="code" href="unlang__priv_8h.html#a9125308c5289036c4809f39fc5fcf7ebae09a7b73744305b3b6eedfda7b432225">UNLANG_TYPE_FUNCTION</a>,                   <span class="comment">//!&lt; Internal call to a function or submodule.</span></div><div class="line"><a name="l00058"></a><span class="lineno"><a class="line" href="unlang__priv_8h.html#a9125308c5289036c4809f39fc5fcf7eba4fe21c7d7bdb7561266e4c8bfd91aee9">   58</a></span>&#160;<span class="comment"></span>        <a class="code" href="unlang__priv_8h.html#a9125308c5289036c4809f39fc5fcf7eba4fe21c7d7bdb7561266e4c8bfd91aee9">UNLANG_TYPE_GROUP</a>,                      <span class="comment">//!&lt; Grouping section.</span></div><div class="line"><a name="l00059"></a><span class="lineno"><a class="line" href="unlang__priv_8h.html#a9125308c5289036c4809f39fc5fcf7eba9a6f1bd1168dda8a855bd08257d02cf8">   59</a></span>&#160;<span class="comment"></span>        <a class="code" href="unlang__priv_8h.html#a9125308c5289036c4809f39fc5fcf7eba9a6f1bd1168dda8a855bd08257d02cf8">UNLANG_TYPE_REDUNDANT</a>,                  <span class="comment">//!&lt; exactly like group, but with different default return codes</span></div><div class="line"><a name="l00060"></a><span class="lineno"><a class="line" href="unlang__priv_8h.html#a9125308c5289036c4809f39fc5fcf7eba38f90b741bffc7803dc9ba1da51b8d42">   60</a></span>&#160;<span class="comment"></span>        <a class="code" href="unlang__priv_8h.html#a9125308c5289036c4809f39fc5fcf7eba38f90b741bffc7803dc9ba1da51b8d42">UNLANG_TYPE_LOAD_BALANCE</a>,               <span class="comment">//!&lt; Load balance section.</span></div><div class="line"><a name="l00061"></a><span class="lineno"><a class="line" href="unlang__priv_8h.html#a9125308c5289036c4809f39fc5fcf7ebad4bf2f4cdce8db82f56e96fcaf008884">   61</a></span>&#160;<span class="comment"></span>        <a class="code" href="unlang__priv_8h.html#a9125308c5289036c4809f39fc5fcf7ebad4bf2f4cdce8db82f56e96fcaf008884">UNLANG_TYPE_REDUNDANT_LOAD_BALANCE</a>,     <span class="comment">//!&lt; Redundant load balance section.</span></div><div class="line"><a name="l00062"></a><span class="lineno"><a class="line" href="unlang__priv_8h.html#a9125308c5289036c4809f39fc5fcf7ebaf1804677b310e7b969296d1924cd4dea">   62</a></span>&#160;<span class="comment"></span>        <a class="code" href="unlang__priv_8h.html#a9125308c5289036c4809f39fc5fcf7ebaf1804677b310e7b969296d1924cd4dea">UNLANG_TYPE_PARALLEL</a>,                   <span class="comment">//!&lt; execute statements in parallel</span></div><div class="line"><a name="l00063"></a><span class="lineno"><a class="line" href="unlang__priv_8h.html#a9125308c5289036c4809f39fc5fcf7ebaa7e4b4cb27659dc6d0d57441f8206a0a">   63</a></span>&#160;<span class="comment"></span>        <a class="code" href="unlang__priv_8h.html#a9125308c5289036c4809f39fc5fcf7ebaa7e4b4cb27659dc6d0d57441f8206a0a">UNLANG_TYPE_IF</a>,                         <span class="comment">//!&lt; Condition.</span></div><div class="line"><a name="l00064"></a><span class="lineno"><a class="line" href="unlang__priv_8h.html#a9125308c5289036c4809f39fc5fcf7eba293ce82adb8f1a27255a33a77bd9c72e">   64</a></span>&#160;<span class="comment"></span>        <a class="code" href="unlang__priv_8h.html#a9125308c5289036c4809f39fc5fcf7eba293ce82adb8f1a27255a33a77bd9c72e">UNLANG_TYPE_ELSE</a>,                       <span class="comment">//!&lt; !Condition.</span></div><div class="line"><a name="l00065"></a><span class="lineno"><a class="line" href="unlang__priv_8h.html#a9125308c5289036c4809f39fc5fcf7eba24249d759c0590abd200009e68f2dd81">   65</a></span>&#160;<span class="comment"></span>        <a class="code" href="unlang__priv_8h.html#a9125308c5289036c4809f39fc5fcf7eba24249d759c0590abd200009e68f2dd81">UNLANG_TYPE_ELSIF</a>,                      <span class="comment">//!&lt; !Condition &amp;&amp; Condition.</span></div><div class="line"><a name="l00066"></a><span class="lineno"><a class="line" href="unlang__priv_8h.html#a9125308c5289036c4809f39fc5fcf7ebaa1d77eb047e6aa9efd357a27b80f5659">   66</a></span>&#160;<span class="comment"></span>        <a class="code" href="unlang__priv_8h.html#a9125308c5289036c4809f39fc5fcf7ebaa1d77eb047e6aa9efd357a27b80f5659">UNLANG_TYPE_FILTER</a>,                     <span class="comment">//!&lt; Filter block.</span></div><div class="line"><a name="l00067"></a><span class="lineno"><a class="line" href="unlang__priv_8h.html#a9125308c5289036c4809f39fc5fcf7eba2163ce29903a19602dd4cf7b60bcbf52">   67</a></span>&#160;<span class="comment"></span>        <a class="code" href="unlang__priv_8h.html#a9125308c5289036c4809f39fc5fcf7eba2163ce29903a19602dd4cf7b60bcbf52">UNLANG_TYPE_UPDATE</a>,                     <span class="comment">//!&lt; Update block.</span></div><div class="line"><a name="l00068"></a><span class="lineno"><a class="line" href="unlang__priv_8h.html#a9125308c5289036c4809f39fc5fcf7eba00e4be4c4de85069a9ec613aa187b889">   68</a></span>&#160;<span class="comment"></span>        <a class="code" href="unlang__priv_8h.html#a9125308c5289036c4809f39fc5fcf7eba00e4be4c4de85069a9ec613aa187b889">UNLANG_TYPE_SWITCH</a>,                     <span class="comment">//!&lt; Switch section.</span></div><div class="line"><a name="l00069"></a><span class="lineno"><a class="line" href="unlang__priv_8h.html#a9125308c5289036c4809f39fc5fcf7eba5d68a4e7663a1cd15b5a120175fd3f66">   69</a></span>&#160;<span class="comment"></span>        <a class="code" href="unlang__priv_8h.html#a9125308c5289036c4809f39fc5fcf7eba5d68a4e7663a1cd15b5a120175fd3f66">UNLANG_TYPE_CASE</a>,                       <span class="comment">//!&lt; Case section (within a #UNLANG_TYPE_SWITCH).</span></div><div class="line"><a name="l00070"></a><span class="lineno"><a class="line" href="unlang__priv_8h.html#a9125308c5289036c4809f39fc5fcf7ebaecbe79772a63639b6f590b3aff638474">   70</a></span>&#160;<span class="comment"></span>        <a class="code" href="unlang__priv_8h.html#a9125308c5289036c4809f39fc5fcf7ebaecbe79772a63639b6f590b3aff638474">UNLANG_TYPE_FOREACH</a>,                    <span class="comment">//!&lt; Foreach section.</span></div><div class="line"><a name="l00071"></a><span class="lineno"><a class="line" href="unlang__priv_8h.html#a9125308c5289036c4809f39fc5fcf7eba6e696ab1ac4249a8a3605a755715c6d3">   71</a></span>&#160;<span class="comment"></span>        <a class="code" href="unlang__priv_8h.html#a9125308c5289036c4809f39fc5fcf7eba6e696ab1ac4249a8a3605a755715c6d3">UNLANG_TYPE_BREAK</a>,                      <span class="comment">//!&lt; Break statement (within a #UNLANG_TYPE_FOREACH).</span></div><div class="line"><a name="l00072"></a><span class="lineno"><a class="line" href="unlang__priv_8h.html#a9125308c5289036c4809f39fc5fcf7eba8f2873e1490b2b5161a94e15c068d9aa">   72</a></span>&#160;<span class="comment"></span>        <a class="code" href="unlang__priv_8h.html#a9125308c5289036c4809f39fc5fcf7eba8f2873e1490b2b5161a94e15c068d9aa">UNLANG_TYPE_RETURN</a>,                     <span class="comment">//!&lt; Return statement.</span></div><div class="line"><a name="l00073"></a><span class="lineno"><a class="line" href="unlang__priv_8h.html#a9125308c5289036c4809f39fc5fcf7ebab6e02d1f709e111e11369c30f38903a5">   73</a></span>&#160;<span class="comment"></span>        <a class="code" href="unlang__priv_8h.html#a9125308c5289036c4809f39fc5fcf7ebab6e02d1f709e111e11369c30f38903a5">UNLANG_TYPE_MAP</a>,                        <span class="comment">//!&lt; Mapping section (like #UNLANG_TYPE_UPDATE, but uses</span></div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="comment"></span><span class="comment">                                                //!&lt; values from a #map_proc_t call).</span></div><div class="line"><a name="l00075"></a><span class="lineno"><a class="line" href="unlang__priv_8h.html#a9125308c5289036c4809f39fc5fcf7eba0e64dc49cc5a9898742662f0a68ca7d1">   75</a></span>&#160;<span class="comment"></span>        <a class="code" href="unlang__priv_8h.html#a9125308c5289036c4809f39fc5fcf7eba0e64dc49cc5a9898742662f0a68ca7d1">UNLANG_TYPE_SUBREQUEST</a>,                 <span class="comment">//!&lt; create a child subrequest</span></div><div class="line"><a name="l00076"></a><span class="lineno"><a class="line" href="unlang__priv_8h.html#a9125308c5289036c4809f39fc5fcf7eba448d06919403cb519a2854c48b90814a">   76</a></span>&#160;<span class="comment"></span>        <a class="code" href="unlang__priv_8h.html#a9125308c5289036c4809f39fc5fcf7eba448d06919403cb519a2854c48b90814a">UNLANG_TYPE_DETACH</a>,                     <span class="comment">//!&lt; detach a child</span></div><div class="line"><a name="l00077"></a><span class="lineno"><a class="line" href="unlang__priv_8h.html#a9125308c5289036c4809f39fc5fcf7eba84c060b5dd9a96b15d01ef7373294efe">   77</a></span>&#160;<span class="comment"></span>        <a class="code" href="unlang__priv_8h.html#a9125308c5289036c4809f39fc5fcf7eba84c060b5dd9a96b15d01ef7373294efe">UNLANG_TYPE_CALL</a>,                       <span class="comment">//!&lt; call another virtual server</span></div><div class="line"><a name="l00078"></a><span class="lineno"><a class="line" href="unlang__priv_8h.html#a9125308c5289036c4809f39fc5fcf7ebabd3b1857702554aef76f7efd79395607">   78</a></span>&#160;<span class="comment"></span>        <a class="code" href="unlang__priv_8h.html#a9125308c5289036c4809f39fc5fcf7ebabd3b1857702554aef76f7efd79395607">UNLANG_TYPE_CALLER</a>,                     <span class="comment">//!&lt; conditionally check parent dictionary type</span></div><div class="line"><a name="l00079"></a><span class="lineno"><a class="line" href="unlang__priv_8h.html#a9125308c5289036c4809f39fc5fcf7eba51e14aac7a1d40c716623adb4477bf5f">   79</a></span>&#160;<span class="comment"></span>        <a class="code" href="unlang__priv_8h.html#a9125308c5289036c4809f39fc5fcf7eba51e14aac7a1d40c716623adb4477bf5f">UNLANG_TYPE_POLICY</a>,                     <span class="comment">//!&lt; Policy section.</span></div><div class="line"><a name="l00080"></a><span class="lineno"><a class="line" href="unlang__priv_8h.html#a9125308c5289036c4809f39fc5fcf7ebab19a185461cc51eb0862eda90b546634">   80</a></span>&#160;<span class="comment"></span>        <a class="code" href="unlang__priv_8h.html#a9125308c5289036c4809f39fc5fcf7ebab19a185461cc51eb0862eda90b546634">UNLANG_TYPE_XLAT</a>,                       <span class="comment">//!&lt; Represents one level of an xlat expansion.</span></div><div class="line"><a name="l00081"></a><span class="lineno"><a class="line" href="unlang__priv_8h.html#a9125308c5289036c4809f39fc5fcf7eba5c97f52d8b32c6549627522c909541e3">   81</a></span>&#160;<span class="comment"></span>        <a class="code" href="unlang__priv_8h.html#a9125308c5289036c4809f39fc5fcf7eba5c97f52d8b32c6549627522c909541e3">UNLANG_TYPE_TMPL</a>,                       <span class="comment">//!&lt; asynchronously expand a tmpl_t</span></div><div class="line"><a name="l00082"></a><span class="lineno"><a class="line" href="unlang__priv_8h.html#a9125308c5289036c4809f39fc5fcf7eba9b8d98c02917be5b79a6ba6df54d7ff1">   82</a></span>&#160;<span class="comment"></span>        <a class="code" href="unlang__priv_8h.html#a9125308c5289036c4809f39fc5fcf7eba9b8d98c02917be5b79a6ba6df54d7ff1">UNLANG_TYPE_MAX</a></div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;} <a class="code" href="unlang__priv_8h.html#a9125308c5289036c4809f39fc5fcf7eb">unlang_type_t</a>;</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="comment">/** Allows the frame evaluator to signal the interpreter</span></div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00088"></a><span class="lineno"><a class="line" href="unlang__priv_8h.html#ab4e3b6d0842d8e4a6650713f6bbd5132">   88</a></span>&#160;<span class="keyword">typedef</span> <span class="keyword">enum</span> {</div><div class="line"><a name="l00089"></a><span class="lineno"><a class="line" href="unlang__priv_8h.html#ab4e3b6d0842d8e4a6650713f6bbd5132a13f44b579aa2cbc31ceccf557d596894">   89</a></span>&#160;        <a class="code" href="unlang__priv_8h.html#ab4e3b6d0842d8e4a6650713f6bbd5132a13f44b579aa2cbc31ceccf557d596894">UNLANG_FRAME_ACTION_POP</a> = 1,            <span class="comment">//!&lt; Pop the current frame, and check the next one further</span></div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="comment"></span><span class="comment">                                                ///&lt; up in the stack for what to do next.</span></div><div class="line"><a name="l00091"></a><span class="lineno"><a class="line" href="unlang__priv_8h.html#ab4e3b6d0842d8e4a6650713f6bbd5132adb4acb4257ce9e6e4320cdd860ba283e">   91</a></span>&#160;<span class="comment"></span>        <a class="code" href="unlang__priv_8h.html#ab4e3b6d0842d8e4a6650713f6bbd5132adb4acb4257ce9e6e4320cdd860ba283e">UNLANG_FRAME_ACTION_NEXT</a>,               <span class="comment">//!&lt; Process the next instruction at this level.</span></div><div class="line"><a name="l00092"></a><span class="lineno"><a class="line" href="unlang__priv_8h.html#ab4e3b6d0842d8e4a6650713f6bbd5132a357bdfc3bc6efb96334c2eb649bbd9aa">   92</a></span>&#160;<span class="comment"></span>        <a class="code" href="unlang__priv_8h.html#ab4e3b6d0842d8e4a6650713f6bbd5132a357bdfc3bc6efb96334c2eb649bbd9aa">UNLANG_FRAME_ACTION_YIELD</a>               <span class="comment">//!&lt; Temporarily return control back to the caller on the C</span></div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="comment"></span><span class="comment">                                                ///&lt; stack.</span></div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="comment"></span>} <a class="code" href="unlang__priv_8h.html#ab4e3b6d0842d8e4a6650713f6bbd5132">unlang_frame_action_t</a>;</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;</div><div class="line"><a name="l00096"></a><span class="lineno"><a class="line" href="unlang__priv_8h.html#a2eb2bcc75dbd1f7aa8482447d2e03e4a">   96</a></span>&#160;<span class="preprocessor">#define UNLANG_NEXT_STOP        (false)</span></div><div class="line"><a name="l00097"></a><span class="lineno"><a class="line" href="unlang__priv_8h.html#a1be8275b3413d5def76c9b5a9119c535">   97</a></span>&#160;<span class="preprocessor">#define UNLANG_NEXT_SIBLING     (true)</span></div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;</div><div class="line"><a name="l00099"></a><span class="lineno"><a class="line" href="unlang__priv_8h.html#a07206a6a7e45e933e806e3862ddd2f8a">   99</a></span>&#160;<span class="preprocessor">#define UNLANG_DETACHABLE       (true)</span></div><div class="line"><a name="l00100"></a><span class="lineno"><a class="line" href="unlang__priv_8h.html#a031197bc8900d47570b8b0032bae1bfb">  100</a></span>&#160;<span class="preprocessor">#define UNLANG_NORMAL_CHILD     (false)</span></div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;</div><div class="line"><a name="l00102"></a><span class="lineno"><a class="line" href="unlang__priv_8h.html#ae94a5a610b9e98e5fd73a969d5420319">  102</a></span>&#160;<span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="unlang__priv_8h.html#structunlang__s">unlang_s</a> <a class="code" href="unlang__priv_8h.html#structunlang__s">unlang_t</a>;</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="comment">/** A node in a graph of #unlang_op_t (s) that we execute</span></div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="comment"> * The interpreter acts like a turing machine, with #unlang_t nodes forming the tape</span></div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="comment"> * and the #unlang_action_t the instructions.</span></div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="comment"> * This is the parent &#39;class&#39; for multiple #unlang_t node specialisations.</span></div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="comment"> * The #unlang_t struct is listed first in the specialisation so that we can cast between</span></div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="comment"> * parent/child classes without knowledge of the layout of the structures.</span></div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="comment"> * The specialisations of the nodes describe additional details of the operation to be performed.</span></div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00115"></a><span class="lineno"><a class="line" href="unlang__priv_8h.html">  115</a></span>&#160;<span class="keyword">struct </span><a class="code" href="unlang__priv_8h.html#structunlang__s">unlang_s</a> {</div><div class="line"><a name="l00116"></a><span class="lineno"><a class="line" href="unlang__priv_8h.html#a2f3ac7c25f52bb729b5ff276ea58b26e">  116</a></span>&#160;        <a class="code" href="unlang__priv_8h.html#structunlang__s">unlang_t</a>                *<a class="code" href="unlang__priv_8h.html#a2f3ac7c25f52bb729b5ff276ea58b26e">parent</a>;        <span class="comment">//!&lt; Previous node.</span></div><div class="line"><a name="l00117"></a><span class="lineno"><a class="line" href="unlang__priv_8h.html#a0fe61fff5588709c463112bf511248ef">  117</a></span>&#160;<span class="comment"></span>        <a class="code" href="unlang__priv_8h.html#structunlang__s">unlang_t</a>                *<a class="code" href="unlang__priv_8h.html#a0fe61fff5588709c463112bf511248ef">next</a>;          <span class="comment">//!&lt; Next node (executed on #UNLANG_ACTION_EXECUTE_NEXT et al).</span></div><div class="line"><a name="l00118"></a><span class="lineno"><a class="line" href="unlang__priv_8h.html#a820176f9f00cb85b64ad732837d0728b">  118</a></span>&#160;<span class="comment"></span>        <span class="keywordtype">char</span> <span class="keyword">const</span>              *<a class="code" href="unlang__priv_8h.html#a820176f9f00cb85b64ad732837d0728b">name</a>;          <span class="comment">//!&lt; Unknown...</span></div><div class="line"><a name="l00119"></a><span class="lineno"><a class="line" href="unlang__priv_8h.html#a21d45bdc338f021f302f3e0b8c297f9f">  119</a></span>&#160;<span class="comment"></span>        <span class="keywordtype">char</span> <span class="keyword">const</span>              *<a class="code" href="unlang__priv_8h.html#a21d45bdc338f021f302f3e0b8c297f9f">debug_name</a>;    <span class="comment">//!&lt; Printed in log messages when the node is executed.</span></div><div class="line"><a name="l00120"></a><span class="lineno"><a class="line" href="unlang__priv_8h.html#af15fe27f155a789028d4a47b92c88f23">  120</a></span>&#160;<span class="comment"></span>        unlang_type_t           <a class="code" href="unlang__priv_8h.html#af15fe27f155a789028d4a47b92c88f23">type</a>;           <span class="comment">//!&lt; The specialisation of this node.</span></div><div class="line"><a name="l00121"></a><span class="lineno"><a class="line" href="unlang__priv_8h.html#a4b896a0509247fcb3329a0bcb6293e31">  121</a></span>&#160;<span class="comment"></span>        <span class="keywordtype">bool</span>                    <a class="code" href="unlang__priv_8h.html#a4b896a0509247fcb3329a0bcb6293e31">closed</a>;         <span class="comment">//!&lt; whether or not this section is closed to new statements</span></div><div class="line"><a name="l00122"></a><span class="lineno"><a class="line" href="unlang__priv_8h.html#a89329984c734b7f08ae418aa1051a9c4">  122</a></span>&#160;<span class="comment"></span>        <span class="keywordtype">int</span>                     <a class="code" href="unlang__priv_8h.html#a89329984c734b7f08ae418aa1051a9c4">actions</a>[<a class="code" href="rcode_8h.html#adcc711080df76349e177fc29a641d1fbaa7707aa26ac24b3a2c83477834a75c4b">RLM_MODULE_NUMCODES</a>];   <span class="comment">//!&lt; Priorities for the various return codes.</span></div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;<span class="comment"></span>};</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="comment">/** Describes how to allocate an #unlang_group_t with additional memory keyword specific data</span></div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00128"></a><span class="lineno"><a class="line" href="unlang__priv_8h.html">  128</a></span>&#160;<span class="keyword">typedef</span> <span class="keyword">struct </span>{</div><div class="line"><a name="l00129"></a><span class="lineno"><a class="line" href="unlang__priv_8h.html#aa470cb4fc06eed46aa1bf2d691bb488c">  129</a></span>&#160;        unlang_type_t           <a class="code" href="unlang__priv_8h.html#aa470cb4fc06eed46aa1bf2d691bb488c">type</a>;           <span class="comment">//!&lt; Keyword.</span></div><div class="line"><a name="l00130"></a><span class="lineno"><a class="line" href="unlang__priv_8h.html#a9a5e612bd5f8f446a2ef79eec155d3d8">  130</a></span>&#160;<span class="comment"></span>        <span class="keywordtype">size_t</span>                  <a class="code" href="unlang__priv_8h.html#a9a5e612bd5f8f446a2ef79eec155d3d8">len</a>;            <span class="comment">//!&lt; Total length of the unlang_group_t + specialisation struct.</span></div><div class="line"><a name="l00131"></a><span class="lineno"><a class="line" href="unlang__priv_8h.html#acb1b5289bc616015a5f3a5795a808c6d">  131</a></span>&#160;<span class="comment"></span>        <span class="keywordtype">unsigned</span>                <a class="code" href="unlang__priv_8h.html#acb1b5289bc616015a5f3a5795a808c6d">pool_headers</a>;   <span class="comment">//!&lt; How much additional space to allocate for chunk headers.</span></div><div class="line"><a name="l00132"></a><span class="lineno"><a class="line" href="unlang__priv_8h.html#ac92488f1e6ba105f5460ae93a4632c02">  132</a></span>&#160;<span class="comment"></span>        <span class="keywordtype">size_t</span>                  <a class="code" href="unlang__priv_8h.html#ac92488f1e6ba105f5460ae93a4632c02">pool_len</a>;       <span class="comment">//!&lt; How much additional space to allocate for extensions.</span></div><div class="line"><a name="l00133"></a><span class="lineno"><a class="line" href="unlang__priv_8h.html#a258f79c8d3ee6008a31cced51f82c129">  133</a></span>&#160;<span class="comment"></span>        <span class="keywordtype">char</span> <span class="keyword">const</span>              *<a class="code" href="unlang__priv_8h.html#a258f79c8d3ee6008a31cced51f82c129">type_name</a>;     <span class="comment">//!&lt; Talloc type name.</span></div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<span class="comment"></span>} <a class="code" href="unlang__priv_8h.html#structunlang__ext__t">unlang_ext_t</a>;</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="comment">/** Generic representation of a grouping</span></div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;<span class="comment"> * Can represent IF statements, maps, update sections etc...</span></div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00140"></a><span class="lineno"><a class="line" href="unlang__priv_8h.html">  140</a></span>&#160;<span class="keyword">typedef</span> <span class="keyword">struct </span>{</div><div class="line"><a name="l00141"></a><span class="lineno"><a class="line" href="unlang__priv_8h.html#a949e234bab03ad846c21bd615afad33d">  141</a></span>&#160;        <a class="code" href="unlang__priv_8h.html#structunlang__s">unlang_t</a>                <span class="keyword">self</span>;</div><div class="line"><a name="l00142"></a><span class="lineno"><a class="line" href="unlang__priv_8h.html#af27b189699bf167e3d0b32cc745ac552">  142</a></span>&#160;        <a class="code" href="unlang__priv_8h.html#structunlang__s">unlang_t</a>                *<a class="code" href="unlang__priv_8h.html#af27b189699bf167e3d0b32cc745ac552">children</a>;      <span class="comment">//!&lt; Children beneath this group.  The body of an if</span></div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;<span class="comment"></span><span class="comment">                                                //!&lt; section for example.</span></div><div class="line"><a name="l00144"></a><span class="lineno"><a class="line" href="unlang__priv_8h.html#a519ef57b142bb1392a4e36b26f186eaf">  144</a></span>&#160;<span class="comment"></span>        <a class="code" href="unlang__priv_8h.html#structunlang__s">unlang_t</a>                **<a class="code" href="unlang__priv_8h.html#a519ef57b142bb1392a4e36b26f186eaf">tail</a>;         <span class="comment">//!&lt; pointer to the tail which gets updated</span></div><div class="line"><a name="l00145"></a><span class="lineno"><a class="line" href="unlang__priv_8h.html#a1a481704ce6ad0a8cb0cc6b2280e60fa">  145</a></span>&#160;<span class="comment"></span>        <a class="code" href="cf__priv_8h.html#structcf__section">CONF_SECTION</a>            *<a class="code" href="unlang__priv_8h.html#a1a481704ce6ad0a8cb0cc6b2280e60fa">cs</a>;</div><div class="line"><a name="l00146"></a><span class="lineno"><a class="line" href="unlang__priv_8h.html#a70f932ac3269b9e0106b27046e3e7a6f">  146</a></span>&#160;        <span class="keywordtype">int</span>                     <a class="code" href="unlang__priv_8h.html#a70f932ac3269b9e0106b27046e3e7a6f">num_children</a>;</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;} <a class="code" href="unlang__priv_8h.html#structunlang__group__t">unlang_group_t</a>;</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="comment">/** A naked xlat</span></div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="comment"> * @note These are vestigial and may be removed in future.</span></div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00153"></a><span class="lineno"><a class="line" href="unlang__priv_8h.html">  153</a></span>&#160;<span class="keyword">typedef</span> <span class="keyword">struct </span>{</div><div class="line"><a name="l00154"></a><span class="lineno"><a class="line" href="unlang__priv_8h.html#a6523d82af1ec5b9089001a96ff5af19c">  154</a></span>&#160;        <a class="code" href="unlang__priv_8h.html#structunlang__s">unlang_t</a>                <span class="keyword">self</span>;</div><div class="line"><a name="l00155"></a><span class="lineno"><a class="line" href="unlang__priv_8h.html#ae63839f237898ae2a34b6b0c18b1a21a">  155</a></span>&#160;        <a class="code" href="server_2tmpl_8h.html#structtmpl__s">tmpl_t</a> <span class="keyword">const</span>            *<a class="code" href="unlang__priv_8h.html#ae63839f237898ae2a34b6b0c18b1a21a">tmpl</a>;</div><div class="line"><a name="l00156"></a><span class="lineno"><a class="line" href="unlang__priv_8h.html#a8a7da6c28af6138ae823a6b64f73aebd">  156</a></span>&#160;        <span class="keywordtype">bool</span>                    <a class="code" href="unlang__priv_8h.html#a8a7da6c28af6138ae823a6b64f73aebd">inline_exec</a>;</div><div class="line"><a name="l00157"></a><span class="lineno"><a class="line" href="unlang__priv_8h.html#ace197390fee48512b9c583ef8652c6fe">  157</a></span>&#160;        <a class="code" href="xlat_8h.html#structxlat__flags__t">xlat_flags_t</a>            <a class="code" href="unlang__priv_8h.html#ace197390fee48512b9c583ef8652c6fe">flags</a>;</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;} <a class="code" href="unlang__priv_8h.html#structunlang__tmpl__t">unlang_tmpl_t</a>;</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;<span class="comment">/** Our interpreter stack, as distinct from the C stack</span></div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;<span class="comment"> * We don&#39;t call the modules recursively.  Instead we iterate over a list of #unlang_t and</span></div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;<span class="comment"> * and manage the call stack ourselves.</span></div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;<span class="comment"> * After looking at various green thread implementations, it was decided that using the existing</span></div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;<span class="comment"> * unlang interpreter stack was the best way to perform async I/O.</span></div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;<span class="comment"> * Each request as an unlang interpreter stack associated with it, which represents its progress</span></div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;<span class="comment"> * through the server.  Because the interpreter stack is distinct from the C stack, we can have</span></div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;<span class="comment"> * a single system thread with many thousands of pending requests.</span></div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00172"></a><span class="lineno"><a class="line" href="unlang__priv_8h.html">  172</a></span>&#160;<span class="keyword">typedef</span> <span class="keyword">struct </span>{</div><div class="line"><a name="l00173"></a><span class="lineno"><a class="line" href="unlang__priv_8h.html#aca1fa2fa71442204099637da828cdd94">  173</a></span>&#160;        <a class="code" href="unlang__priv_8h.html#structunlang__s">unlang_t</a>                *<a class="code" href="unlang__priv_8h.html#aca1fa2fa71442204099637da828cdd94">instruction</a>;                   <span class="comment">//!&lt; The unlang node we&#39;re evaluating.</span></div><div class="line"><a name="l00174"></a><span class="lineno"><a class="line" href="unlang__priv_8h.html#ad168f9dc1f146410efa95eeec3d15698">  174</a></span>&#160;<span class="comment"></span>        <a class="code" href="unlang__priv_8h.html#structunlang__s">unlang_t</a>                *<a class="code" href="unlang__priv_8h.html#ad168f9dc1f146410efa95eeec3d15698">next</a>;                          <span class="comment">//!&lt; The next unlang node we will evaluate</span></div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00176"></a><span class="lineno"><a class="line" href="unlang__priv_8h.html#a6117bf094206f53f687f83ce1c3b63e2">  176</a></span>&#160;        <a class="code" href="interpret_8h.html#adc123c56098e8bcb89dd07194e5a6fca">unlang_process_t</a>        <a class="code" href="unlang__priv_8h.html#a6117bf094206f53f687f83ce1c3b63e2">process</a>;                        <span class="comment">//!&lt; function to call for interpreting this stack frame</span></div><div class="line"><a name="l00177"></a><span class="lineno"><a class="line" href="unlang__priv_8h.html#a8237374f43af0c6c8ff4d5fee3212055">  177</a></span>&#160;<span class="comment"></span>        <a class="code" href="interpret_8h.html#ae0e65f2334112aae071c64adde8a3e31">unlang_signal_t</a>         <a class="code" href="unlang__priv_8h.html#a8237374f43af0c6c8ff4d5fee3212055">signal</a>;                         <span class="comment">//!&lt; function to call when signalling this stack frame</span></div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;<span class="comment"></span><span class="comment"></span></div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;<span class="comment">        /** Stack frame specialisations</span></div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;<span class="comment">         *</span></div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;<span class="comment">         * These store extra (mutable) state data, for the immutable (#unlang_t)</span></div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;<span class="comment">         * instruction.  Instructions can&#39;t be used to store data because they</span></div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;<span class="comment">         * might be shared between multiple threads.</span></div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;<span class="comment">         *</span></div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;<span class="comment">         * Which stack_entry specialisation to use is determined by the</span></div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;<span class="comment">         * instruction-&gt;type.</span></div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;<span class="comment">         */</span></div><div class="line"><a name="l00188"></a><span class="lineno"><a class="line" href="unlang__priv_8h.html#a540206813f824a4115478d433cb72dcd">  188</a></span>&#160;        <span class="keywordtype">void</span>                    *<a class="code" href="unlang__priv_8h.html#a540206813f824a4115478d433cb72dcd">state</a>;</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;</div><div class="line"><a name="l00190"></a><span class="lineno"><a class="line" href="unlang__priv_8h.html#ab59bbe9174e9ec170b2b6fad735456c7">  190</a></span>&#160;        <a class="code" href="rcode_8h.html#adcc711080df76349e177fc29a641d1fb">rlm_rcode_t</a>             <a class="code" href="unlang__priv_8h.html#ab59bbe9174e9ec170b2b6fad735456c7">result</a>;                         <span class="comment">//!&lt; The result from executing the instruction.</span></div><div class="line"><a name="l00191"></a><span class="lineno"><a class="line" href="unlang__priv_8h.html#a75779acf13ee16b6dc800dc12c717815">  191</a></span>&#160;<span class="comment"></span>        <span class="keywordtype">int</span>                     <a class="code" href="unlang__priv_8h.html#a75779acf13ee16b6dc800dc12c717815">priority</a>;                       <span class="comment">//!&lt; Result priority.  When we pop this stack frame</span></div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;<span class="comment"></span><span class="comment">                                                                ///&lt; this priority will be compared with the one of the</span></div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;<span class="comment"></span><span class="comment">                                                                ///&lt; frame lower in the stack to determine if the</span></div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;<span class="comment"></span><span class="comment">                                                                ///&lt; result stored in the lower stack frame should</span></div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;<span class="comment"></span><span class="comment">                                                                ///&lt; be replaced.</span></div><div class="line"><a name="l00196"></a><span class="lineno"><a class="line" href="unlang__priv_8h.html#abcfda3f7c72df09ecedb4630531b7f80">  196</a></span>&#160;<span class="comment"></span>        uint8_t                 <a class="code" href="unlang__priv_8h.html#abcfda3f7c72df09ecedb4630531b7f80">uflags</a>;                         <span class="comment">//!&lt; Unwind markers</span></div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;<span class="comment"></span>} <a class="code" href="unlang__priv_8h.html#structunlang__stack__frame__t">unlang_stack_frame_t</a>;</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;<span class="comment">/** An unlang stack associated with a request</span></div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00202"></a><span class="lineno"><a class="line" href="unlang__priv_8h.html">  202</a></span>&#160;<span class="keyword">typedef</span> <span class="keyword">struct </span>{</div><div class="line"><a name="l00203"></a><span class="lineno"><a class="line" href="unlang__priv_8h.html#a3b0c6b17ad90d042b59b5d470a90417f">  203</a></span>&#160;        <a class="code" href="rcode_8h.html#adcc711080df76349e177fc29a641d1fb">rlm_rcode_t</a>             <a class="code" href="unlang__priv_8h.html#a3b0c6b17ad90d042b59b5d470a90417f">result</a>;                         <span class="comment">//!&lt; The current stack rcode.</span></div><div class="line"><a name="l00204"></a><span class="lineno"><a class="line" href="unlang__priv_8h.html#a80e6b040af5d0bd35a5c7a0449c7b452">  204</a></span>&#160;<span class="comment"></span>        <span class="keywordtype">int</span>                     <a class="code" href="unlang__priv_8h.html#a80e6b040af5d0bd35a5c7a0449c7b452">depth</a>;                          <span class="comment">//!&lt; Current depth we&#39;re executing at.</span></div><div class="line"><a name="l00205"></a><span class="lineno"><a class="line" href="unlang__priv_8h.html#a4f413b861c3bb10c452da5d2f1b73eae">  205</a></span>&#160;<span class="comment"></span>        uint8_t                 <a class="code" href="unlang__priv_8h.html#a4f413b861c3bb10c452da5d2f1b73eae">unwind</a>;                         <span class="comment">//!&lt; Unwind to this frame if it exists.</span></div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;<span class="comment"></span><span class="comment">                                                                ///&lt; This is used for break and return.</span></div><div class="line"><a name="l00207"></a><span class="lineno"><a class="line" href="unlang__priv_8h.html#a4605abd932d2e10385f6e5c234cd62e0">  207</a></span>&#160;<span class="comment"></span>        <a class="code" href="unlang__priv_8h.html#structunlang__stack__frame__t">unlang_stack_frame_t</a>    frame[<a class="code" href="unlang_2base_8h.html#a12b237c3d1b45b4e3a04b90e011e7cb1">UNLANG_STACK_MAX</a>];        <span class="comment">//!&lt; The stack...</span></div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;<span class="comment"></span>} <a class="code" href="unlang__priv_8h.html#structunlang__stack__t">unlang_stack_t</a>;</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;</div><div class="line"><a name="l00210"></a><span class="lineno"><a class="line" href="unlang__priv_8h.html#a5c4946294b7fe9c5b05da3b2537c4aee">  210</a></span>&#160;<span class="preprocessor">#define UNWIND_FLAG_NONE                0x00                    </span><span class="comment">//!&lt; No flags.</span></div><div class="line"><a name="l00211"></a><span class="lineno"><a class="line" href="unlang__priv_8h.html#a70fbdcfa83b9cf4865b58a828ef0818e">  211</a></span>&#160;<span class="comment"></span>#define UNWIND_FLAG_REPEAT              0x01                    <span class="comment">//!&lt; Repeat the frame on the way up the stack.</span></div><div class="line"><a name="l00212"></a><span class="lineno"><a class="line" href="unlang__priv_8h.html#a17eb0c352a522528d0f3bdbba3c803e0">  212</a></span>&#160;<span class="comment"></span>#define UNWIND_FLAG_TOP_FRAME           0x02                    <span class="comment">//!&lt; are we the top frame of the stack?</span></div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;<span class="comment"></span><span class="comment">                                                                ///&lt; If true, causes the interpreter to stop</span></div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;<span class="comment"></span><span class="comment">                                                                ///&lt; interpreting and return, control then passes</span></div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;<span class="comment"></span><span class="comment">                                                                ///&lt; to whatever called the interpreter.</span></div><div class="line"><a name="l00216"></a><span class="lineno"><a class="line" href="unlang__priv_8h.html#a5186c55f95b4566bbbb35919858664da">  216</a></span>&#160;<span class="comment"></span>#define UNWIND_FLAG_BREAK_POINT         0x04                    <span class="comment">//!&lt; &#39;break&#39; stops here.</span></div><div class="line"><a name="l00217"></a><span class="lineno"><a class="line" href="unlang__priv_8h.html#a002dd80dbc30d03f9134e0ab72fd51d2">  217</a></span>&#160;<span class="comment"></span>#define UNWIND_FLAG_RETURN_POINT        0x08                    <span class="comment">//!&lt; &#39;return&#39; stops here.</span></div><div class="line"><a name="l00218"></a><span class="lineno"><a class="line" href="unlang__priv_8h.html#a4f3937610c1db9a68ff9f71a00ef452a">  218</a></span>&#160;<span class="comment"></span>#define UNWIND_FLAG_NO_CLEAR            0x10                    <span class="comment">//!&lt; Keep unwinding, don&#39;t clear the unwind flag.</span></div><div class="line"><a name="l00219"></a><span class="lineno"><a class="line" href="unlang__priv_8h.html#a4b3ef924f7b47fb36e74283e303f2ed1">  219</a></span>&#160;<span class="comment"></span>#define UNWIND_FLAG_YIELDED             0x20                    <span class="comment">//!&lt; frame has yielded</span></div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00221"></a><span class="lineno"><a class="line" href="unlang__priv_8h.html#aea944f0a695d8ca1840e87b53bca4bad">  221</a></span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="unlang__priv_8h.html#aea944f0a695d8ca1840e87b53bca4bad">repeatable_set</a>(<a class="code" href="unlang__priv_8h.html#structunlang__stack__frame__t">unlang_stack_frame_t</a> *frame)          { frame-&gt;<a class="code" href="unlang__priv_8h.html#abcfda3f7c72df09ecedb4630531b7f80">uflags</a> |= <a class="code" href="unlang__priv_8h.html#a70fbdcfa83b9cf4865b58a828ef0818e">UNWIND_FLAG_REPEAT</a>; }</div><div class="line"><a name="l00222"></a><span class="lineno"><a class="line" href="unlang__priv_8h.html#aa4c8f320f83d5d13551043fd92198e87">  222</a></span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="unlang__priv_8h.html#aa4c8f320f83d5d13551043fd92198e87">top_frame_set</a>(<a class="code" href="unlang__priv_8h.html#structunlang__stack__frame__t">unlang_stack_frame_t</a> *frame)           { frame-&gt;<a class="code" href="unlang__priv_8h.html#abcfda3f7c72df09ecedb4630531b7f80">uflags</a> |= <a class="code" href="unlang__priv_8h.html#a17eb0c352a522528d0f3bdbba3c803e0">UNWIND_FLAG_TOP_FRAME</a>; }</div><div class="line"><a name="l00223"></a><span class="lineno"><a class="line" href="unlang__priv_8h.html#a9eebe967b60b272cd59b6e19febc93fa">  223</a></span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="unlang__priv_8h.html#a9eebe967b60b272cd59b6e19febc93fa">break_point_set</a>(<a class="code" href="unlang__priv_8h.html#structunlang__stack__frame__t">unlang_stack_frame_t</a> *frame)         { frame-&gt;<a class="code" href="unlang__priv_8h.html#abcfda3f7c72df09ecedb4630531b7f80">uflags</a> |= <a class="code" href="unlang__priv_8h.html#a5186c55f95b4566bbbb35919858664da">UNWIND_FLAG_BREAK_POINT</a>; }</div><div class="line"><a name="l00224"></a><span class="lineno"><a class="line" href="unlang__priv_8h.html#a7fd45fccdd0242adb43ee6e146fb0785">  224</a></span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="unlang__priv_8h.html#a7fd45fccdd0242adb43ee6e146fb0785">return_point_set</a>(<a class="code" href="unlang__priv_8h.html#structunlang__stack__frame__t">unlang_stack_frame_t</a> *frame)        { frame-&gt;<a class="code" href="unlang__priv_8h.html#abcfda3f7c72df09ecedb4630531b7f80">uflags</a> |= <a class="code" href="unlang__priv_8h.html#a002dd80dbc30d03f9134e0ab72fd51d2">UNWIND_FLAG_RETURN_POINT</a>; }</div><div class="line"><a name="l00225"></a><span class="lineno"><a class="line" href="unlang__priv_8h.html#ab6067e644105f8f49a92164a387446ba">  225</a></span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="unlang__priv_8h.html#ab6067e644105f8f49a92164a387446ba">yielded_set</a>(<a class="code" href="unlang__priv_8h.html#structunlang__stack__frame__t">unlang_stack_frame_t</a> *frame)             { frame-&gt;<a class="code" href="unlang__priv_8h.html#abcfda3f7c72df09ecedb4630531b7f80">uflags</a> |= <a class="code" href="unlang__priv_8h.html#a4b3ef924f7b47fb36e74283e303f2ed1">UNWIND_FLAG_YIELDED</a>; }</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;</div><div class="line"><a name="l00227"></a><span class="lineno"><a class="line" href="unlang__priv_8h.html#a1e040e50f202b3f46d3317ba6099825c">  227</a></span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="unlang__priv_8h.html#a1e040e50f202b3f46d3317ba6099825c">repeatable_clear</a>(<a class="code" href="unlang__priv_8h.html#structunlang__stack__frame__t">unlang_stack_frame_t</a> *frame)        { frame-&gt;<a class="code" href="unlang__priv_8h.html#abcfda3f7c72df09ecedb4630531b7f80">uflags</a> &amp;= ~<a class="code" href="unlang__priv_8h.html#a70fbdcfa83b9cf4865b58a828ef0818e">UNWIND_FLAG_REPEAT</a>; }</div><div class="line"><a name="l00228"></a><span class="lineno"><a class="line" href="unlang__priv_8h.html#a53b17645a80c99ae22a25b49cbaf958e">  228</a></span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="unlang__priv_8h.html#a53b17645a80c99ae22a25b49cbaf958e">top_frame_clear</a>(<a class="code" href="unlang__priv_8h.html#structunlang__stack__frame__t">unlang_stack_frame_t</a> *frame)         { frame-&gt;<a class="code" href="unlang__priv_8h.html#abcfda3f7c72df09ecedb4630531b7f80">uflags</a> &amp;= ~<a class="code" href="unlang__priv_8h.html#a17eb0c352a522528d0f3bdbba3c803e0">UNWIND_FLAG_TOP_FRAME</a>; }</div><div class="line"><a name="l00229"></a><span class="lineno"><a class="line" href="unlang__priv_8h.html#a6be8ff601a6d1f40487494889b99af37">  229</a></span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="unlang__priv_8h.html#a6be8ff601a6d1f40487494889b99af37">break_point_clear</a>(<a class="code" href="unlang__priv_8h.html#structunlang__stack__frame__t">unlang_stack_frame_t</a> *frame)       { frame-&gt;<a class="code" href="unlang__priv_8h.html#abcfda3f7c72df09ecedb4630531b7f80">uflags</a> &amp;= ~<a class="code" href="unlang__priv_8h.html#a5186c55f95b4566bbbb35919858664da">UNWIND_FLAG_BREAK_POINT</a>; }</div><div class="line"><a name="l00230"></a><span class="lineno"><a class="line" href="unlang__priv_8h.html#ae3815f82cc19b3704623521f132226f1">  230</a></span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="unlang__priv_8h.html#ae3815f82cc19b3704623521f132226f1">return_point_clear</a>(<a class="code" href="unlang__priv_8h.html#structunlang__stack__frame__t">unlang_stack_frame_t</a> *frame)      { frame-&gt;<a class="code" href="unlang__priv_8h.html#abcfda3f7c72df09ecedb4630531b7f80">uflags</a> &amp;= ~<a class="code" href="unlang__priv_8h.html#a002dd80dbc30d03f9134e0ab72fd51d2">UNWIND_FLAG_RETURN_POINT</a>; }</div><div class="line"><a name="l00231"></a><span class="lineno"><a class="line" href="unlang__priv_8h.html#ac43349a9af29b5ef97ecc977855720d5">  231</a></span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="unlang__priv_8h.html#ac43349a9af29b5ef97ecc977855720d5">yielded_clear</a>(<a class="code" href="unlang__priv_8h.html#structunlang__stack__frame__t">unlang_stack_frame_t</a> *frame)   { frame-&gt;<a class="code" href="unlang__priv_8h.html#abcfda3f7c72df09ecedb4630531b7f80">uflags</a> &amp;= ~<a class="code" href="unlang__priv_8h.html#a4b3ef924f7b47fb36e74283e303f2ed1">UNWIND_FLAG_YIELDED</a>; }</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;</div><div class="line"><a name="l00233"></a><span class="lineno"><a class="line" href="unlang__priv_8h.html#ac36aa78f498e4f5bd70ddf6fdeb980c4">  233</a></span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="unlang__priv_8h.html#ac36aa78f498e4f5bd70ddf6fdeb980c4">is_repeatable</a>(<a class="code" href="unlang__priv_8h.html#structunlang__stack__frame__t">unlang_stack_frame_t</a> *frame)           { <span class="keywordflow">return</span> frame-&gt;<a class="code" href="unlang__priv_8h.html#abcfda3f7c72df09ecedb4630531b7f80">uflags</a> &amp; <a class="code" href="unlang__priv_8h.html#a70fbdcfa83b9cf4865b58a828ef0818e">UNWIND_FLAG_REPEAT</a>; }</div><div class="line"><a name="l00234"></a><span class="lineno"><a class="line" href="unlang__priv_8h.html#a62076e3c96bae8d87aad5f42e6006ae1">  234</a></span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="unlang__priv_8h.html#a62076e3c96bae8d87aad5f42e6006ae1">is_top_frame</a>(<a class="code" href="unlang__priv_8h.html#structunlang__stack__frame__t">unlang_stack_frame_t</a> *frame)            { <span class="keywordflow">return</span> frame-&gt;<a class="code" href="unlang__priv_8h.html#abcfda3f7c72df09ecedb4630531b7f80">uflags</a> &amp; <a class="code" href="unlang__priv_8h.html#a17eb0c352a522528d0f3bdbba3c803e0">UNWIND_FLAG_TOP_FRAME</a>; }</div><div class="line"><a name="l00235"></a><span class="lineno"><a class="line" href="unlang__priv_8h.html#add19a724e69185e468b0ca30c69fea2a">  235</a></span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="unlang__priv_8h.html#add19a724e69185e468b0ca30c69fea2a">is_break_point</a>(<a class="code" href="unlang__priv_8h.html#structunlang__stack__frame__t">unlang_stack_frame_t</a> *frame)          { <span class="keywordflow">return</span> frame-&gt;<a class="code" href="unlang__priv_8h.html#abcfda3f7c72df09ecedb4630531b7f80">uflags</a> &amp; <a class="code" href="unlang__priv_8h.html#a5186c55f95b4566bbbb35919858664da">UNWIND_FLAG_BREAK_POINT</a>; }</div><div class="line"><a name="l00236"></a><span class="lineno"><a class="line" href="unlang__priv_8h.html#af9e48baa75f1463a6f1b67f89029c962">  236</a></span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="unlang__priv_8h.html#af9e48baa75f1463a6f1b67f89029c962">is_return_point</a>(<a class="code" href="unlang__priv_8h.html#structunlang__stack__frame__t">unlang_stack_frame_t</a> *frame)         { <span class="keywordflow">return</span> frame-&gt;<a class="code" href="unlang__priv_8h.html#abcfda3f7c72df09ecedb4630531b7f80">uflags</a> &amp; <a class="code" href="unlang__priv_8h.html#a002dd80dbc30d03f9134e0ab72fd51d2">UNWIND_FLAG_RETURN_POINT</a>; }</div><div class="line"><a name="l00237"></a><span class="lineno"><a class="line" href="unlang__priv_8h.html#a87149a8fb13897c01320157ffaa4ac80">  237</a></span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="unlang__priv_8h.html#a87149a8fb13897c01320157ffaa4ac80">is_yielded</a>(<a class="code" href="unlang__priv_8h.html#structunlang__stack__frame__t">unlang_stack_frame_t</a> *frame)              { <span class="keywordflow">return</span> frame-&gt;<a class="code" href="unlang__priv_8h.html#abcfda3f7c72df09ecedb4630531b7f80">uflags</a> &amp; <a class="code" href="unlang__priv_8h.html#a4b3ef924f7b47fb36e74283e303f2ed1">UNWIND_FLAG_YIELDED</a>; }</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;</div><div class="line"><a name="l00239"></a><span class="lineno"><a class="line" href="unlang__priv_8h.html#af062007fdc0d94e56d9e5217f1a70908">  239</a></span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <a class="code" href="action_8h.html#ad02ab717522305fe70aab72d152fc812">unlang_action_t</a> <a class="code" href="unlang__priv_8h.html#af062007fdc0d94e56d9e5217f1a70908">unwind_to_break</a>(<a class="code" href="unlang__priv_8h.html#structunlang__stack__t">unlang_stack_t</a> *<a class="code" href="modules_2proto__control_2radmin_8c.html#acbb0ad34f5d8b226a09b81ea4973082d">stack</a>)</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;{</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;        stack-&gt;<a class="code" href="unlang__priv_8h.html#a4f413b861c3bb10c452da5d2f1b73eae">unwind</a> = <a class="code" href="unlang__priv_8h.html#a5186c55f95b4566bbbb35919858664da">UNWIND_FLAG_BREAK_POINT</a> | <a class="code" href="unlang__priv_8h.html#a17eb0c352a522528d0f3bdbba3c803e0">UNWIND_FLAG_TOP_FRAME</a>;</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="action_8h.html#ad02ab717522305fe70aab72d152fc812a05046186cc9bd20de1e524bca3c138b5">UNLANG_ACTION_UNWIND</a>;</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;}</div><div class="line"><a name="l00244"></a><span class="lineno"><a class="line" href="unlang__priv_8h.html#a10dd1d9ee46fa53f171c91b8d649a777">  244</a></span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <a class="code" href="action_8h.html#ad02ab717522305fe70aab72d152fc812">unlang_action_t</a> <a class="code" href="unlang__priv_8h.html#a10dd1d9ee46fa53f171c91b8d649a777">unwind_to_return</a>(<a class="code" href="unlang__priv_8h.html#structunlang__stack__t">unlang_stack_t</a> *<a class="code" href="modules_2proto__control_2radmin_8c.html#acbb0ad34f5d8b226a09b81ea4973082d">stack</a>)</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;{</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;        stack-&gt;<a class="code" href="unlang__priv_8h.html#a4f413b861c3bb10c452da5d2f1b73eae">unwind</a> = <a class="code" href="unlang__priv_8h.html#a002dd80dbc30d03f9134e0ab72fd51d2">UNWIND_FLAG_RETURN_POINT</a> | <a class="code" href="unlang__priv_8h.html#a17eb0c352a522528d0f3bdbba3c803e0">UNWIND_FLAG_TOP_FRAME</a>;</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="action_8h.html#ad02ab717522305fe70aab72d152fc812a05046186cc9bd20de1e524bca3c138b5">UNLANG_ACTION_UNWIND</a>;</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;}</div><div class="line"><a name="l00249"></a><span class="lineno"><a class="line" href="unlang__priv_8h.html#a4d67463da07c5a6a66467ac17608628e">  249</a></span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <a class="code" href="action_8h.html#ad02ab717522305fe70aab72d152fc812">unlang_action_t</a> <a class="code" href="unlang__priv_8h.html#a4d67463da07c5a6a66467ac17608628e">unwind_all</a>(<a class="code" href="unlang__priv_8h.html#structunlang__stack__t">unlang_stack_t</a> *<a class="code" href="modules_2proto__control_2radmin_8c.html#acbb0ad34f5d8b226a09b81ea4973082d">stack</a>)</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;{</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;        stack-&gt;<a class="code" href="unlang__priv_8h.html#a4f413b861c3bb10c452da5d2f1b73eae">unwind</a> = <a class="code" href="unlang__priv_8h.html#a17eb0c352a522528d0f3bdbba3c803e0">UNWIND_FLAG_TOP_FRAME</a> | <a class="code" href="unlang__priv_8h.html#a4f3937610c1db9a68ff9f71a00ef452a">UNWIND_FLAG_NO_CLEAR</a>;</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="action_8h.html#ad02ab717522305fe70aab72d152fc812a05046186cc9bd20de1e524bca3c138b5">UNLANG_ACTION_UNWIND</a>;</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;}</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;<span class="comment">/** Different operations the interpreter can execute</span></div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;<span class="keyword">extern</span> <a class="code" href="interpret_8h.html#structunlang__op__t">unlang_op_t</a> <a class="code" href="unlang__priv_8h.html#acf0c8002e436c1d516aaef95b217b063">unlang_ops</a>[];</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;</div><div class="line"><a name="l00259"></a><span class="lineno"><a class="line" href="unlang__priv_8h.html#a049c553e67540f66a6d07871695eff5a">  259</a></span>&#160;<span class="preprocessor">#define MOD_NUM_TYPES (UNLANG_TYPE_XLAT + 1)</span></div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;<span class="keyword">extern</span> <a class="code" href="table_8h.html#structfr__table__num__sorted__t">fr_table_num_sorted_t</a> <span class="keyword">const</span> <a class="code" href="unlang__priv_8h.html#ad28b87be40e8cea3465bdc9764f4a3c3">mod_rcode_table</a>[];</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;<span class="keyword">extern</span> <span class="keywordtype">size_t</span> <a class="code" href="unlang__priv_8h.html#a7544dfc0ce8a8f8cd824812b0c78d73f">mod_rcode_table_len</a>;</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;<span class="comment">/** @name Conversion functions for converting #unlang_t to its specialisations</span></div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;<span class="comment"> * Simple conversions: #unlang_module_t and #unlang_group_t are subclasses of #unlang_t,</span></div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;<span class="comment"> * so we often want to go back and forth between them.</span></div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;<span class="comment"> * @{</span></div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00271"></a><span class="lineno"><a class="line" href="unlang__priv_8h.html#aac8f5c5ad9dc7c337553f920e1a181d4">  271</a></span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <a class="code" href="unlang__priv_8h.html#structunlang__group__t">unlang_group_t</a> *<a class="code" href="unlang__priv_8h.html#aac8f5c5ad9dc7c337553f920e1a181d4">unlang_generic_to_group</a>(<a class="code" href="unlang__priv_8h.html#structunlang__s">unlang_t</a> *p)</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;{</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;        <a class="code" href="rad__assert_8h.html#ae8fbce32ab994abf84b95a7c57de209a">fr_assert</a>((p-&gt;<a class="code" href="unlang__priv_8h.html#af15fe27f155a789028d4a47b92c88f23">type</a> &gt; <a class="code" href="unlang__priv_8h.html#a9125308c5289036c4809f39fc5fcf7ebad3feb6676ba8189507cbe9be815a0854">UNLANG_TYPE_MODULE</a>) &amp;&amp; (p-&gt;<a class="code" href="unlang__priv_8h.html#af15fe27f155a789028d4a47b92c88f23">type</a> &lt;= <a class="code" href="unlang__priv_8h.html#a9125308c5289036c4809f39fc5fcf7eba51e14aac7a1d40c716623adb4477bf5f">UNLANG_TYPE_POLICY</a>));</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;        <span class="keywordflow">return</span> (<a class="code" href="unlang__priv_8h.html#structunlang__group__t">unlang_group_t</a> *)p;</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;}</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;</div><div class="line"><a name="l00278"></a><span class="lineno"><a class="line" href="unlang__priv_8h.html#a52890e71e5baf575ea56415383a5def9">  278</a></span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <a class="code" href="unlang__priv_8h.html#structunlang__s">unlang_t</a> *<a class="code" href="unlang__priv_8h.html#a52890e71e5baf575ea56415383a5def9">unlang_group_to_generic</a>(<a class="code" href="unlang__priv_8h.html#structunlang__group__t">unlang_group_t</a> *p)</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;{</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;        <span class="keywordflow">return</span> (<a class="code" href="unlang__priv_8h.html#structunlang__s">unlang_t</a> *)p;</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;}</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;</div><div class="line"><a name="l00283"></a><span class="lineno"><a class="line" href="unlang__priv_8h.html#a794ceebefd714376e0394e326c52ce7e">  283</a></span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <a class="code" href="unlang__priv_8h.html#structunlang__tmpl__t">unlang_tmpl_t</a> *<a class="code" href="unlang__priv_8h.html#a794ceebefd714376e0394e326c52ce7e">unlang_generic_to_tmpl</a>(<a class="code" href="unlang__priv_8h.html#structunlang__s">unlang_t</a> *p)</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;{</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;        <a class="code" href="rad__assert_8h.html#ae8fbce32ab994abf84b95a7c57de209a">fr_assert</a>(p-&gt;<a class="code" href="unlang__priv_8h.html#af15fe27f155a789028d4a47b92c88f23">type</a> == <a class="code" href="unlang__priv_8h.html#a9125308c5289036c4809f39fc5fcf7eba5c97f52d8b32c6549627522c909541e3">UNLANG_TYPE_TMPL</a>);</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;        <span class="keywordflow">return</span> talloc_get_type_abort(p, <a class="code" href="unlang__priv_8h.html#structunlang__tmpl__t">unlang_tmpl_t</a>);</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;}</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;</div><div class="line"><a name="l00289"></a><span class="lineno"><a class="line" href="unlang__priv_8h.html#a5fd8144991b05a0cde9a3f8b9447c82c">  289</a></span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <a class="code" href="unlang__priv_8h.html#structunlang__s">unlang_t</a> *<a class="code" href="unlang__priv_8h.html#a5fd8144991b05a0cde9a3f8b9447c82c">unlang_tmpl_to_generic</a>(<a class="code" href="unlang__priv_8h.html#structunlang__tmpl__t">unlang_tmpl_t</a> *p)</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;{</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;        <span class="keywordflow">return</span> (<a class="code" href="unlang__priv_8h.html#structunlang__s">unlang_t</a> *)p;</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;}<span class="comment"></span></div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;<span class="comment">/** @} */</span></div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;<span class="comment">/** @name Internal interpreter functions needed by ops</span></div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;<span class="comment"> * @{</span></div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;<span class="keywordtype">int</span>             <a class="code" href="unlang__priv_8h.html#a06f6fba9b6f8a9831a34c445ff1ecb9f">unlang_interpret_push</a>(<a class="code" href="request_8h.html#structrequest__s">request_t</a> *request, <a class="code" href="unlang__priv_8h.html#structunlang__s">unlang_t</a> *instruction,</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;                                      <a class="code" href="rcode_8h.html#adcc711080df76349e177fc29a641d1fb">rlm_rcode_t</a> default_rcode, <span class="keywordtype">bool</span> do_next_sibling, <span class="keywordtype">bool</span> top_frame)</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;                                      <a class="code" href="heap_8c.html#a52a0eeda89378004e77a978c138adaf4">CC_HINT</a>(warn_unused_result);</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;<span class="keywordtype">int</span>             <a class="code" href="unlang__priv_8h.html#afca374bf312b3030a8d1435be0513d26">unlang_op_init</a>(<span class="keywordtype">void</span>);</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;<span class="keywordtype">void</span>            <a class="code" href="unlang__priv_8h.html#a6a4ba1df6e016828f58b23d971d33b43">unlang_op_free</a>(<span class="keywordtype">void</span>);<span class="comment"></span></div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;<span class="comment">/** @} */</span></div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;<span class="comment">/** @name io shims</span></div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;<span class="comment"> * Functions to simulate a &#39;proto&#39; module when we&#39;re running &#39;fake&#39;</span></div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;<span class="comment"> * requests. i.e. those created by parallel and subrequest.</span></div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;<span class="comment"> * @{</span></div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;<a class="code" href="action_8h.html#ad02ab717522305fe70aab72d152fc812">unlang_action_t</a> <a class="code" href="unlang__priv_8h.html#a6ab135991d0c8e21b9b4fb94c619311f">unlang_io_process_interpret</a>(<a class="code" href="rcode_8h.html#adcc711080df76349e177fc29a641d1fb">rlm_rcode_t</a> *p_result, <a class="code" href="server_2module_8h.html#structmodule__ctx__s">module_ctx_t</a> <span class="keyword">const</span> *mctx, <a class="code" href="request_8h.html#structrequest__s">request_t</a> *request);</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;<a class="code" href="request_8h.html#structrequest__s">request_t</a>               *<a class="code" href="unlang__priv_8h.html#a74fd54c7579e06817b3c8ca6a3344105">unlang_io_subrequest_alloc</a>(<a class="code" href="request_8h.html#structrequest__s">request_t</a> *<a class="code" href="unlang__priv_8h.html#a2f3ac7c25f52bb729b5ff276ea58b26e">parent</a>, <a class="code" href="dict__priv_8h.html#structfr__dict">fr_dict_t</a> <span class="keyword">const</span> *<span class="keyword">namespace</span>, <span class="keywordtype">bool</span> detachable);</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;<span class="comment">/** @} */</span></div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;<span class="comment">/** @name op init functions</span></div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;<span class="comment"> * Functions to trigger registration of the various unlang ops.</span></div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;<span class="comment"> * @{</span></div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;<span class="keywordtype">void</span>            <a class="code" href="unlang__priv_8h.html#a49588eeff94b32b52512db36db55b59b">unlang_call_init</a>(<span class="keywordtype">void</span>);</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;<span class="keywordtype">void</span>            <a class="code" href="unlang__priv_8h.html#aefcb135b6bd137ddb87d6bf2cd31b94c">unlang_caller_init</a>(<span class="keywordtype">void</span>);</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;<span class="keywordtype">void</span>            <a class="code" href="unlang__priv_8h.html#a4f01593ae92ed91382415d09ea90c904">unlang_condition_init</a>(<span class="keywordtype">void</span>);</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;<span class="keywordtype">void</span>            <a class="code" href="unlang__priv_8h.html#aee5ff52c892e2e6b6f21730cd93f99f6">unlang_foreach_init</a>(<span class="keywordtype">void</span>);</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;<span class="keywordtype">void</span>            <a class="code" href="unlang__priv_8h.html#a77e7ad7fd3638ddd6461ff63be3a19c4">unlang_foreach_free</a>(<span class="keywordtype">void</span>);</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;<span class="keywordtype">void</span>            <a class="code" href="unlang__priv_8h.html#ac370b76fc93b1f10b0ba0ead67a5588f">unlang_function_init</a>(<span class="keywordtype">void</span>);</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;<span class="keywordtype">void</span>            <a class="code" href="unlang__priv_8h.html#a7123f761a5402d204901fc6f1c0a92f2">unlang_group_init</a>(<span class="keywordtype">void</span>);</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;<span class="keywordtype">void</span>            <a class="code" href="unlang__priv_8h.html#a6b84f208ed5faa4823cb093c2b3cc6a2">unlang_load_balance_init</a>(<span class="keywordtype">void</span>);</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;<span class="keywordtype">void</span>            <a class="code" href="unlang__priv_8h.html#a4acb4f0c9e4b6bbaf8be96f442bf5d2a">unlang_map_init</a>(<span class="keywordtype">void</span>);</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;<span class="keywordtype">void</span>            <a class="code" href="unlang__priv_8h.html#aacac2f2ef83343ae1a0651c3e709fa7f">unlang_module_init</a>(<span class="keywordtype">void</span>);</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;<span class="keywordtype">void</span>            <a class="code" href="unlang__priv_8h.html#a8e6b3d4cbbd2ad8bbbe7e8e3c08eb8ed">unlang_return_init</a>(<span class="keywordtype">void</span>);</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;<span class="keywordtype">void</span>            <a class="code" href="unlang__priv_8h.html#a778d7f18c3477464408e669b55b131f9">unlang_parallel_init</a>(<span class="keywordtype">void</span>);</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;<span class="keywordtype">int</span>             <a class="code" href="unlang__priv_8h.html#a3404ea4ea923c7da0dbc6f57a5d0e5c4">unlang_subrequest_op_init</a>(<span class="keywordtype">void</span>);</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;<span class="keywordtype">void</span>            <a class="code" href="unlang__priv_8h.html#aeae12a7f6042439203caf744c2698050">unlang_subrequest_op_free</a>(<span class="keywordtype">void</span>);</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;<span class="keywordtype">void</span>            <a class="code" href="unlang__priv_8h.html#a12512095434e22f5438a21735f75dea6">unlang_switch_init</a>(<span class="keywordtype">void</span>);</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;<span class="keywordtype">void</span>            <a class="code" href="unlang__priv_8h.html#a2d20f42893c832b4b262f9d55fbf5123">unlang_tmpl_init_shallow</a>(<span class="keywordtype">void</span>);<span class="comment"></span></div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;<span class="comment"> /** @} */</span></div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;<span class="preprocessor">#ifdef __cplusplus</span></div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;}</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;<span class="preprocessor">#endif</span></div><div class="ttc" id="unlang__priv_8h_html_a9125308c5289036c4809f39fc5fcf7eba448d06919403cb519a2854c48b90814a"><div class="ttname"><a href="unlang__priv_8h.html#a9125308c5289036c4809f39fc5fcf7eba448d06919403cb519a2854c48b90814a">UNLANG_TYPE_DETACH</a></div><div class="ttdoc">detach a child </div><div class="ttdef"><b>Definition:</b> <a href="unlang__priv_8h_source.html#l00076">unlang_priv.h:76</a></div></div>
<div class="ttc" id="unlang_2base_8h_html_a12b237c3d1b45b4e3a04b90e011e7cb1"><div class="ttname"><a href="unlang_2base_8h.html#a12b237c3d1b45b4e3a04b90e011e7cb1">UNLANG_STACK_MAX</a></div><div class="ttdeci">#define UNLANG_STACK_MAX</div><div class="ttdoc">The maximum depth of the stack. </div><div class="ttdef"><b>Definition:</b> <a href="unlang_2base_8h_source.html#l00035">base.h:35</a></div></div>
<div class="ttc" id="unlang__priv_8h_html_a3b0c6b17ad90d042b59b5d470a90417f"><div class="ttname"><a href="unlang__priv_8h.html#a3b0c6b17ad90d042b59b5d470a90417f">unlang_stack_t::result</a></div><div class="ttdeci">rlm_rcode_t result</div><div class="ttdoc">The current stack rcode. </div><div class="ttdef"><b>Definition:</b> <a href="unlang__priv_8h_source.html#l00203">unlang_priv.h:203</a></div></div>
<div class="ttc" id="unlang__priv_8h_html_a53b17645a80c99ae22a25b49cbaf958e"><div class="ttname"><a href="unlang__priv_8h.html#a53b17645a80c99ae22a25b49cbaf958e">top_frame_clear</a></div><div class="ttdeci">static void top_frame_clear(unlang_stack_frame_t *frame)</div><div class="ttdef"><b>Definition:</b> <a href="unlang__priv_8h_source.html#l00228">unlang_priv.h:228</a></div></div>
<div class="ttc" id="unlang__priv_8h_html_a9125308c5289036c4809f39fc5fcf7eba4fe21c7d7bdb7561266e4c8bfd91aee9"><div class="ttname"><a href="unlang__priv_8h.html#a9125308c5289036c4809f39fc5fcf7eba4fe21c7d7bdb7561266e4c8bfd91aee9">UNLANG_TYPE_GROUP</a></div><div class="ttdoc">Grouping section. </div><div class="ttdef"><b>Definition:</b> <a href="unlang__priv_8h_source.html#l00058">unlang_priv.h:58</a></div></div>
<div class="ttc" id="unlang__priv_8h_html_afca374bf312b3030a8d1435be0513d26"><div class="ttname"><a href="unlang__priv_8h.html#afca374bf312b3030a8d1435be0513d26">unlang_op_init</a></div><div class="ttdeci">int unlang_op_init(void)</div></div>
<div class="ttc" id="unlang__priv_8h_html_a4f413b861c3bb10c452da5d2f1b73eae"><div class="ttname"><a href="unlang__priv_8h.html#a4f413b861c3bb10c452da5d2f1b73eae">unlang_stack_t::unwind</a></div><div class="ttdeci">uint8_t unwind</div><div class="ttdoc">Unwind to this frame if it exists. </div><div class="ttdef"><b>Definition:</b> <a href="unlang__priv_8h_source.html#l00205">unlang_priv.h:205</a></div></div>
<div class="ttc" id="unlang__priv_8h_html_a12512095434e22f5438a21735f75dea6"><div class="ttname"><a href="unlang__priv_8h.html#a12512095434e22f5438a21735f75dea6">unlang_switch_init</a></div><div class="ttdeci">void unlang_switch_init(void)</div><div class="ttdef"><b>Definition:</b> <a href="switch_8c_source.html#l00207">switch.c:207</a></div></div>
<div class="ttc" id="unlang__priv_8h_html_a6be8ff601a6d1f40487494889b99af37"><div class="ttname"><a href="unlang__priv_8h.html#a6be8ff601a6d1f40487494889b99af37">break_point_clear</a></div><div class="ttdeci">static void break_point_clear(unlang_stack_frame_t *frame)</div><div class="ttdef"><b>Definition:</b> <a href="unlang__priv_8h_source.html#l00229">unlang_priv.h:229</a></div></div>
<div class="ttc" id="unlang__priv_8h_html_aa4c8f320f83d5d13551043fd92198e87"><div class="ttname"><a href="unlang__priv_8h.html#aa4c8f320f83d5d13551043fd92198e87">top_frame_set</a></div><div class="ttdeci">static void top_frame_set(unlang_stack_frame_t *frame)</div><div class="ttdef"><b>Definition:</b> <a href="unlang__priv_8h_source.html#l00222">unlang_priv.h:222</a></div></div>
<div class="ttc" id="unlang__priv_8h_html_a9125308c5289036c4809f39fc5fcf7ebad4bf2f4cdce8db82f56e96fcaf008884"><div class="ttname"><a href="unlang__priv_8h.html#a9125308c5289036c4809f39fc5fcf7ebad4bf2f4cdce8db82f56e96fcaf008884">UNLANG_TYPE_REDUNDANT_LOAD_BALANCE</a></div><div class="ttdoc">Redundant load balance section. </div><div class="ttdef"><b>Definition:</b> <a href="unlang__priv_8h_source.html#l00061">unlang_priv.h:61</a></div></div>
<div class="ttc" id="unlang__priv_8h_html_a7123f761a5402d204901fc6f1c0a92f2"><div class="ttname"><a href="unlang__priv_8h.html#a7123f761a5402d204901fc6f1c0a92f2">unlang_group_init</a></div><div class="ttdeci">void unlang_group_init(void)</div><div class="ttdef"><b>Definition:</b> <a href="group_8c_source.html#l00071">group.c:71</a></div></div>
<div class="ttc" id="unlang__priv_8h_html_ac92488f1e6ba105f5460ae93a4632c02"><div class="ttname"><a href="unlang__priv_8h.html#ac92488f1e6ba105f5460ae93a4632c02">unlang_ext_t::pool_len</a></div><div class="ttdeci">size_t pool_len</div><div class="ttdoc">How much additional space to allocate for extensions. </div><div class="ttdef"><b>Definition:</b> <a href="unlang__priv_8h_source.html#l00132">unlang_priv.h:132</a></div></div>
<div class="ttc" id="unlang__priv_8h_html_a9125308c5289036c4809f39fc5fcf7ebae09a7b73744305b3b6eedfda7b432225"><div class="ttname"><a href="unlang__priv_8h.html#a9125308c5289036c4809f39fc5fcf7ebae09a7b73744305b3b6eedfda7b432225">UNLANG_TYPE_FUNCTION</a></div><div class="ttdoc">Internal call to a function or submodule. </div><div class="ttdef"><b>Definition:</b> <a href="unlang__priv_8h_source.html#l00057">unlang_priv.h:57</a></div></div>
<div class="ttc" id="unlang__priv_8h_html_af15fe27f155a789028d4a47b92c88f23"><div class="ttname"><a href="unlang__priv_8h.html#af15fe27f155a789028d4a47b92c88f23">unlang_s::type</a></div><div class="ttdeci">unlang_type_t type</div><div class="ttdoc">The specialisation of this node. </div><div class="ttdef"><b>Definition:</b> <a href="unlang__priv_8h_source.html#l00120">unlang_priv.h:120</a></div></div>
<div class="ttc" id="unlang__priv_8h_html_structunlang__stack__t"><div class="ttname"><a href="unlang__priv_8h.html#structunlang__stack__t">unlang_stack_t</a></div><div class="ttdoc">An unlang stack associated with a request. </div><div class="ttdef"><b>Definition:</b> <a href="unlang__priv_8h_source.html#l00202">unlang_priv.h:202</a></div></div>
<div class="ttc" id="unlang__priv_8h_html_a002dd80dbc30d03f9134e0ab72fd51d2"><div class="ttname"><a href="unlang__priv_8h.html#a002dd80dbc30d03f9134e0ab72fd51d2">UNWIND_FLAG_RETURN_POINT</a></div><div class="ttdeci">#define UNWIND_FLAG_RETURN_POINT</div><div class="ttdoc">&amp;#39;return&amp;#39; stops here. </div><div class="ttdef"><b>Definition:</b> <a href="unlang__priv_8h_source.html#l00217">unlang_priv.h:217</a></div></div>
<div class="ttc" id="rad__assert_8h_html_ae8fbce32ab994abf84b95a7c57de209a"><div class="ttname"><a href="rad__assert_8h.html#ae8fbce32ab994abf84b95a7c57de209a">fr_assert</a></div><div class="ttdeci">#define fr_assert(_expr)</div><div class="ttdef"><b>Definition:</b> <a href="rad__assert_8h_source.html#l00038">rad_assert.h:38</a></div></div>
<div class="ttc" id="unlang__priv_8h_html_acb1b5289bc616015a5f3a5795a808c6d"><div class="ttname"><a href="unlang__priv_8h.html#acb1b5289bc616015a5f3a5795a808c6d">unlang_ext_t::pool_headers</a></div><div class="ttdeci">unsigned pool_headers</div><div class="ttdoc">How much additional space to allocate for chunk headers. </div><div class="ttdef"><b>Definition:</b> <a href="unlang__priv_8h_source.html#l00131">unlang_priv.h:131</a></div></div>
<div class="ttc" id="xlat_8h_html_structxlat__flags__t"><div class="ttname"><a href="xlat_8h.html#structxlat__flags__t">xlat_flags_t</a></div><div class="ttdoc">Flags that control resolution and evaluation. </div><div class="ttdef"><b>Definition:</b> <a href="xlat_8h_source.html#l00080">xlat.h:80</a></div></div>
<div class="ttc" id="unlang__priv_8h_html_a89329984c734b7f08ae418aa1051a9c4"><div class="ttname"><a href="unlang__priv_8h.html#a89329984c734b7f08ae418aa1051a9c4">unlang_s::actions</a></div><div class="ttdeci">int actions[RLM_MODULE_NUMCODES]</div><div class="ttdoc">Priorities for the various return codes. </div><div class="ttdef"><b>Definition:</b> <a href="unlang__priv_8h_source.html#l00122">unlang_priv.h:122</a></div></div>
<div class="ttc" id="unlang__priv_8h_html_af27b189699bf167e3d0b32cc745ac552"><div class="ttname"><a href="unlang__priv_8h.html#af27b189699bf167e3d0b32cc745ac552">unlang_group_t::children</a></div><div class="ttdeci">unlang_t * children</div><div class="ttdoc">Children beneath this group. </div><div class="ttdef"><b>Definition:</b> <a href="unlang__priv_8h_source.html#l00142">unlang_priv.h:142</a></div></div>
<div class="ttc" id="unlang__priv_8h_html_a06f6fba9b6f8a9831a34c445ff1ecb9f"><div class="ttname"><a href="unlang__priv_8h.html#a06f6fba9b6f8a9831a34c445ff1ecb9f">unlang_interpret_push</a></div><div class="ttdeci">int unlang_interpret_push(request_t *request, unlang_t *instruction, rlm_rcode_t default_rcode, bool do_next_sibling, bool top_frame)</div><div class="ttdoc">Push a new frame onto the stack. </div><div class="ttdef"><b>Definition:</b> <a href="interpret_8c_source.html#l00170">interpret.c:170</a></div></div>
<div class="ttc" id="unlang__priv_8h_html_a9125308c5289036c4809f39fc5fcf7eba0e64dc49cc5a9898742662f0a68ca7d1"><div class="ttname"><a href="unlang__priv_8h.html#a9125308c5289036c4809f39fc5fcf7eba0e64dc49cc5a9898742662f0a68ca7d1">UNLANG_TYPE_SUBREQUEST</a></div><div class="ttdoc">create a child subrequest </div><div class="ttdef"><b>Definition:</b> <a href="unlang__priv_8h_source.html#l00075">unlang_priv.h:75</a></div></div>
<div class="ttc" id="unlang__priv_8h_html_a9125308c5289036c4809f39fc5fcf7eba51e14aac7a1d40c716623adb4477bf5f"><div class="ttname"><a href="unlang__priv_8h.html#a9125308c5289036c4809f39fc5fcf7eba51e14aac7a1d40c716623adb4477bf5f">UNLANG_TYPE_POLICY</a></div><div class="ttdoc">Policy section. </div><div class="ttdef"><b>Definition:</b> <a href="unlang__priv_8h_source.html#l00079">unlang_priv.h:79</a></div></div>
<div class="ttc" id="unlang__priv_8h_html_a1a481704ce6ad0a8cb0cc6b2280e60fa"><div class="ttname"><a href="unlang__priv_8h.html#a1a481704ce6ad0a8cb0cc6b2280e60fa">unlang_group_t::cs</a></div><div class="ttdeci">CONF_SECTION * cs</div><div class="ttdef"><b>Definition:</b> <a href="unlang__priv_8h_source.html#l00145">unlang_priv.h:145</a></div></div>
<div class="ttc" id="unlang__priv_8h_html_a9125308c5289036c4809f39fc5fcf7eba84c060b5dd9a96b15d01ef7373294efe"><div class="ttname"><a href="unlang__priv_8h.html#a9125308c5289036c4809f39fc5fcf7eba84c060b5dd9a96b15d01ef7373294efe">UNLANG_TYPE_CALL</a></div><div class="ttdoc">call another virtual server </div><div class="ttdef"><b>Definition:</b> <a href="unlang__priv_8h_source.html#l00077">unlang_priv.h:77</a></div></div>
<div class="ttc" id="unlang__priv_8h_html_ace197390fee48512b9c583ef8652c6fe"><div class="ttname"><a href="unlang__priv_8h.html#ace197390fee48512b9c583ef8652c6fe">unlang_tmpl_t::flags</a></div><div class="ttdeci">xlat_flags_t flags</div><div class="ttdef"><b>Definition:</b> <a href="unlang__priv_8h_source.html#l00157">unlang_priv.h:157</a></div></div>
<div class="ttc" id="unlang__priv_8h_html_a519ef57b142bb1392a4e36b26f186eaf"><div class="ttname"><a href="unlang__priv_8h.html#a519ef57b142bb1392a4e36b26f186eaf">unlang_group_t::tail</a></div><div class="ttdeci">unlang_t ** tail</div><div class="ttdoc">pointer to the tail which gets updated </div><div class="ttdef"><b>Definition:</b> <a href="unlang__priv_8h_source.html#l00144">unlang_priv.h:144</a></div></div>
<div class="ttc" id="unlang__priv_8h_html_a9125308c5289036c4809f39fc5fcf7ebad3feb6676ba8189507cbe9be815a0854"><div class="ttname"><a href="unlang__priv_8h.html#a9125308c5289036c4809f39fc5fcf7ebad3feb6676ba8189507cbe9be815a0854">UNLANG_TYPE_MODULE</a></div><div class="ttdoc">Module method. </div><div class="ttdef"><b>Definition:</b> <a href="unlang__priv_8h_source.html#l00056">unlang_priv.h:56</a></div></div>
<div class="ttc" id="unlang__priv_8h_html_a7fd45fccdd0242adb43ee6e146fb0785"><div class="ttname"><a href="unlang__priv_8h.html#a7fd45fccdd0242adb43ee6e146fb0785">return_point_set</a></div><div class="ttdeci">static void return_point_set(unlang_stack_frame_t *frame)</div><div class="ttdef"><b>Definition:</b> <a href="unlang__priv_8h_source.html#l00224">unlang_priv.h:224</a></div></div>
<div class="ttc" id="unlang__priv_8h_html_ae63839f237898ae2a34b6b0c18b1a21a"><div class="ttname"><a href="unlang__priv_8h.html#ae63839f237898ae2a34b6b0c18b1a21a">unlang_tmpl_t::tmpl</a></div><div class="ttdeci">tmpl_t const  * tmpl</div><div class="ttdef"><b>Definition:</b> <a href="unlang__priv_8h_source.html#l00155">unlang_priv.h:155</a></div></div>
<div class="ttc" id="unlang__priv_8h_html_ab6067e644105f8f49a92164a387446ba"><div class="ttname"><a href="unlang__priv_8h.html#ab6067e644105f8f49a92164a387446ba">yielded_set</a></div><div class="ttdeci">static void yielded_set(unlang_stack_frame_t *frame)</div><div class="ttdef"><b>Definition:</b> <a href="unlang__priv_8h_source.html#l00225">unlang_priv.h:225</a></div></div>
<div class="ttc" id="unlang__priv_8h_html_a9125308c5289036c4809f39fc5fcf7ebab34824e2fe477ee8b4c671d8d1d8de31"><div class="ttname"><a href="unlang__priv_8h.html#a9125308c5289036c4809f39fc5fcf7ebab34824e2fe477ee8b4c671d8d1d8de31">UNLANG_TYPE_NULL</a></div><div class="ttdoc">unlang type not set. </div><div class="ttdef"><b>Definition:</b> <a href="unlang__priv_8h_source.html#l00055">unlang_priv.h:55</a></div></div>
<div class="ttc" id="unlang__priv_8h_html_a794ceebefd714376e0394e326c52ce7e"><div class="ttname"><a href="unlang__priv_8h.html#a794ceebefd714376e0394e326c52ce7e">unlang_generic_to_tmpl</a></div><div class="ttdeci">static unlang_tmpl_t * unlang_generic_to_tmpl(unlang_t *p)</div><div class="ttdef"><b>Definition:</b> <a href="unlang__priv_8h_source.html#l00283">unlang_priv.h:283</a></div></div>
<div class="ttc" id="rcode_8h_html_adcc711080df76349e177fc29a641d1fb"><div class="ttname"><a href="rcode_8h.html#adcc711080df76349e177fc29a641d1fb">rlm_rcode_t</a></div><div class="ttdeci">rlm_rcode_t</div><div class="ttdoc">Return codes indicating the result of the module call. </div><div class="ttdef"><b>Definition:</b> <a href="rcode_8h_source.html#l00040">rcode.h:40</a></div></div>
<div class="ttc" id="unlang__priv_8h_html_structunlang__stack__frame__t"><div class="ttname"><a href="unlang__priv_8h.html#structunlang__stack__frame__t">unlang_stack_frame_t</a></div><div class="ttdoc">Our interpreter stack, as distinct from the C stack. </div><div class="ttdef"><b>Definition:</b> <a href="unlang__priv_8h_source.html#l00172">unlang_priv.h:172</a></div></div>
<div class="ttc" id="unlang__priv_8h_html_ac43349a9af29b5ef97ecc977855720d5"><div class="ttname"><a href="unlang__priv_8h.html#ac43349a9af29b5ef97ecc977855720d5">yielded_clear</a></div><div class="ttdeci">static void yielded_clear(unlang_stack_frame_t *frame)</div><div class="ttdef"><b>Definition:</b> <a href="unlang__priv_8h_source.html#l00231">unlang_priv.h:231</a></div></div>
<div class="ttc" id="unlang__priv_8h_html_a9125308c5289036c4809f39fc5fcf7eba8f2873e1490b2b5161a94e15c068d9aa"><div class="ttname"><a href="unlang__priv_8h.html#a9125308c5289036c4809f39fc5fcf7eba8f2873e1490b2b5161a94e15c068d9aa">UNLANG_TYPE_RETURN</a></div><div class="ttdoc">Return statement. </div><div class="ttdef"><b>Definition:</b> <a href="unlang__priv_8h_source.html#l00072">unlang_priv.h:72</a></div></div>
<div class="ttc" id="unlang__priv_8h_html_a4f01593ae92ed91382415d09ea90c904"><div class="ttname"><a href="unlang__priv_8h.html#a4f01593ae92ed91382415d09ea90c904">unlang_condition_init</a></div><div class="ttdeci">void unlang_condition_init(void)</div><div class="ttdef"><b>Definition:</b> <a href="condition_8c_source.html#l00085">condition.c:85</a></div></div>
<div class="ttc" id="interpret_8h_html_adc123c56098e8bcb89dd07194e5a6fca"><div class="ttname"><a href="interpret_8h.html#adc123c56098e8bcb89dd07194e5a6fca">unlang_process_t</a></div><div class="ttdeci">unlang_action_t(* unlang_process_t)(rlm_rcode_t *p_result, request_t *request)</div><div class="ttdoc">Function to call when interpreting a frame. </div><div class="ttdef"><b>Definition:</b> <a href="interpret_8h_source.html#l00042">interpret.h:42</a></div></div>
<div class="ttc" id="unlang__priv_8h_html_a9125308c5289036c4809f39fc5fcf7eba9b8d98c02917be5b79a6ba6df54d7ff1"><div class="ttname"><a href="unlang__priv_8h.html#a9125308c5289036c4809f39fc5fcf7eba9b8d98c02917be5b79a6ba6df54d7ff1">UNLANG_TYPE_MAX</a></div><div class="ttdef"><b>Definition:</b> <a href="unlang__priv_8h_source.html#l00082">unlang_priv.h:82</a></div></div>
<div class="ttc" id="unlang__priv_8h_html_a820176f9f00cb85b64ad732837d0728b"><div class="ttname"><a href="unlang__priv_8h.html#a820176f9f00cb85b64ad732837d0728b">unlang_s::name</a></div><div class="ttdeci">char const  * name</div><div class="ttdoc">Unknown... </div><div class="ttdef"><b>Definition:</b> <a href="unlang__priv_8h_source.html#l00118">unlang_priv.h:118</a></div></div>
<div class="ttc" id="unlang__priv_8h_html_a4b896a0509247fcb3329a0bcb6293e31"><div class="ttname"><a href="unlang__priv_8h.html#a4b896a0509247fcb3329a0bcb6293e31">unlang_s::closed</a></div><div class="ttdeci">bool closed</div><div class="ttdoc">whether or not this section is closed to new statements </div><div class="ttdef"><b>Definition:</b> <a href="unlang__priv_8h_source.html#l00121">unlang_priv.h:121</a></div></div>
<div class="ttc" id="unlang__priv_8h_html_a2f3ac7c25f52bb729b5ff276ea58b26e"><div class="ttname"><a href="unlang__priv_8h.html#a2f3ac7c25f52bb729b5ff276ea58b26e">unlang_s::parent</a></div><div class="ttdeci">unlang_t * parent</div><div class="ttdoc">Previous node. </div><div class="ttdef"><b>Definition:</b> <a href="unlang__priv_8h_source.html#l00116">unlang_priv.h:116</a></div></div>
<div class="ttc" id="unlang__priv_8h_html_a2d20f42893c832b4b262f9d55fbf5123"><div class="ttname"><a href="unlang__priv_8h.html#a2d20f42893c832b4b262f9d55fbf5123">unlang_tmpl_init_shallow</a></div><div class="ttdeci">void unlang_tmpl_init_shallow(void)</div><div class="ttdef"><b>Definition:</b> <a href="tmpl_8c_source.html#l00569">tmpl.c:569</a></div></div>
<div class="ttc" id="unlang__priv_8h_html_aea944f0a695d8ca1840e87b53bca4bad"><div class="ttname"><a href="unlang__priv_8h.html#aea944f0a695d8ca1840e87b53bca4bad">repeatable_set</a></div><div class="ttdeci">static void repeatable_set(unlang_stack_frame_t *frame)</div><div class="ttdef"><b>Definition:</b> <a href="unlang__priv_8h_source.html#l00221">unlang_priv.h:221</a></div></div>
<div class="ttc" id="unlang__priv_8h_html_a6b84f208ed5faa4823cb093c2b3cc6a2"><div class="ttname"><a href="unlang__priv_8h.html#a6b84f208ed5faa4823cb093c2b3cc6a2">unlang_load_balance_init</a></div><div class="ttdeci">void unlang_load_balance_init(void)</div><div class="ttdef"><b>Definition:</b> <a href="load__balance_8c_source.html#l00260">load_balance.c:260</a></div></div>
<div class="ttc" id="unlang__priv_8h_html_a21d45bdc338f021f302f3e0b8c297f9f"><div class="ttname"><a href="unlang__priv_8h.html#a21d45bdc338f021f302f3e0b8c297f9f">unlang_s::debug_name</a></div><div class="ttdeci">char const  * debug_name</div><div class="ttdoc">Printed in log messages when the node is executed. </div><div class="ttdef"><b>Definition:</b> <a href="unlang__priv_8h_source.html#l00119">unlang_priv.h:119</a></div></div>
<div class="ttc" id="unlang__priv_8h_html_a9125308c5289036c4809f39fc5fcf7ebab19a185461cc51eb0862eda90b546634"><div class="ttname"><a href="unlang__priv_8h.html#a9125308c5289036c4809f39fc5fcf7ebab19a185461cc51eb0862eda90b546634">UNLANG_TYPE_XLAT</a></div><div class="ttdoc">Represents one level of an xlat expansion. </div><div class="ttdef"><b>Definition:</b> <a href="unlang__priv_8h_source.html#l00080">unlang_priv.h:80</a></div></div>
<div class="ttc" id="unlang__priv_8h_html_a9125308c5289036c4809f39fc5fcf7ebaecbe79772a63639b6f590b3aff638474"><div class="ttname"><a href="unlang__priv_8h.html#a9125308c5289036c4809f39fc5fcf7ebaecbe79772a63639b6f590b3aff638474">UNLANG_TYPE_FOREACH</a></div><div class="ttdoc">Foreach section. </div><div class="ttdef"><b>Definition:</b> <a href="unlang__priv_8h_source.html#l00070">unlang_priv.h:70</a></div></div>
<div class="ttc" id="server_2module_8h_html_structmodule__ctx__s"><div class="ttname"><a href="server_2module_8h.html#structmodule__ctx__s">module_ctx_s</a></div><div class="ttdoc">Temporary structure to hold arguments for module calls. </div><div class="ttdef"><b>Definition:</b> <a href="server_2module_8h_source.html#l00257">module.h:257</a></div></div>
<div class="ttc" id="unlang__priv_8h_html_aa470cb4fc06eed46aa1bf2d691bb488c"><div class="ttname"><a href="unlang__priv_8h.html#aa470cb4fc06eed46aa1bf2d691bb488c">unlang_ext_t::type</a></div><div class="ttdeci">unlang_type_t type</div><div class="ttdoc">Keyword. </div><div class="ttdef"><b>Definition:</b> <a href="unlang__priv_8h_source.html#l00129">unlang_priv.h:129</a></div></div>
<div class="ttc" id="unlang__priv_8h_html_add19a724e69185e468b0ca30c69fea2a"><div class="ttname"><a href="unlang__priv_8h.html#add19a724e69185e468b0ca30c69fea2a">is_break_point</a></div><div class="ttdeci">static bool is_break_point(unlang_stack_frame_t *frame)</div><div class="ttdef"><b>Definition:</b> <a href="unlang__priv_8h_source.html#l00235">unlang_priv.h:235</a></div></div>
<div class="ttc" id="unlang__priv_8h_html_a540206813f824a4115478d433cb72dcd"><div class="ttname"><a href="unlang__priv_8h.html#a540206813f824a4115478d433cb72dcd">unlang_stack_frame_t::state</a></div><div class="ttdeci">void * state</div><div class="ttdoc">Stack frame specialisations. </div><div class="ttdef"><b>Definition:</b> <a href="unlang__priv_8h_source.html#l00188">unlang_priv.h:188</a></div></div>
<div class="ttc" id="unlang__priv_8h_html_a9125308c5289036c4809f39fc5fcf7eba2163ce29903a19602dd4cf7b60bcbf52"><div class="ttname"><a href="unlang__priv_8h.html#a9125308c5289036c4809f39fc5fcf7eba2163ce29903a19602dd4cf7b60bcbf52">UNLANG_TYPE_UPDATE</a></div><div class="ttdoc">Update block. </div><div class="ttdef"><b>Definition:</b> <a href="unlang__priv_8h_source.html#l00067">unlang_priv.h:67</a></div></div>
<div class="ttc" id="cf__priv_8h_html_structcf__section"><div class="ttname"><a href="cf__priv_8h.html#structcf__section">cf_section</a></div><div class="ttdoc">A section grouping multiple CONF_PAIR. </div><div class="ttdef"><b>Definition:</b> <a href="cf__priv_8h_source.html#l00084">cf_priv.h:84</a></div></div>
<div class="ttc" id="unlang__priv_8h_html_a87149a8fb13897c01320157ffaa4ac80"><div class="ttname"><a href="unlang__priv_8h.html#a87149a8fb13897c01320157ffaa4ac80">is_yielded</a></div><div class="ttdeci">static bool is_yielded(unlang_stack_frame_t *frame)</div><div class="ttdef"><b>Definition:</b> <a href="unlang__priv_8h_source.html#l00237">unlang_priv.h:237</a></div></div>
<div class="ttc" id="unlang__priv_8h_html_a9125308c5289036c4809f39fc5fcf7eba9a6f1bd1168dda8a855bd08257d02cf8"><div class="ttname"><a href="unlang__priv_8h.html#a9125308c5289036c4809f39fc5fcf7eba9a6f1bd1168dda8a855bd08257d02cf8">UNLANG_TYPE_REDUNDANT</a></div><div class="ttdoc">exactly like group, but with different default return codes </div><div class="ttdef"><b>Definition:</b> <a href="unlang__priv_8h_source.html#l00059">unlang_priv.h:59</a></div></div>
<div class="ttc" id="unlang__priv_8h_html_a9125308c5289036c4809f39fc5fcf7eba5c97f52d8b32c6549627522c909541e3"><div class="ttname"><a href="unlang__priv_8h.html#a9125308c5289036c4809f39fc5fcf7eba5c97f52d8b32c6549627522c909541e3">UNLANG_TYPE_TMPL</a></div><div class="ttdoc">asynchronously expand a tmpl_t </div><div class="ttdef"><b>Definition:</b> <a href="unlang__priv_8h_source.html#l00081">unlang_priv.h:81</a></div></div>
<div class="ttc" id="interpret_8h_html_structunlang__op__t"><div class="ttname"><a href="interpret_8h.html#structunlang__op__t">unlang_op_t</a></div><div class="ttdoc">An unlang operation. </div><div class="ttdef"><b>Definition:</b> <a href="interpret_8h_source.html#l00070">interpret.h:70</a></div></div>
<div class="ttc" id="unlang__priv_8h_html_a74fd54c7579e06817b3c8ca6a3344105"><div class="ttname"><a href="unlang__priv_8h.html#a74fd54c7579e06817b3c8ca6a3344105">unlang_io_subrequest_alloc</a></div><div class="ttdeci">request_t * unlang_io_subrequest_alloc(request_t *parent, fr_dict_t const *namespace, bool detachable)</div><div class="ttdoc">Allocate a child request based on the parent. </div><div class="ttdef"><b>Definition:</b> <a href="lib_2unlang_2io_8c_source.html#l00076">io.c:76</a></div></div>
<div class="ttc" id="unlang__priv_8h_html_a9125308c5289036c4809f39fc5fcf7ebaf1804677b310e7b969296d1924cd4dea"><div class="ttname"><a href="unlang__priv_8h.html#a9125308c5289036c4809f39fc5fcf7ebaf1804677b310e7b969296d1924cd4dea">UNLANG_TYPE_PARALLEL</a></div><div class="ttdoc">execute statements in parallel </div><div class="ttdef"><b>Definition:</b> <a href="unlang__priv_8h_source.html#l00062">unlang_priv.h:62</a></div></div>
<div class="ttc" id="unlang__priv_8h_html_a778d7f18c3477464408e669b55b131f9"><div class="ttname"><a href="unlang__priv_8h.html#a778d7f18c3477464408e669b55b131f9">unlang_parallel_init</a></div><div class="ttdeci">void unlang_parallel_init(void)</div><div class="ttdef"><b>Definition:</b> <a href="parallel_8c_source.html#l00436">parallel.c:436</a></div></div>
<div class="ttc" id="unlang__priv_8h_html_structunlang__tmpl__t"><div class="ttname"><a href="unlang__priv_8h.html#structunlang__tmpl__t">unlang_tmpl_t</a></div><div class="ttdoc">A naked xlat. </div><div class="ttdef"><b>Definition:</b> <a href="unlang__priv_8h_source.html#l00153">unlang_priv.h:153</a></div></div>
<div class="ttc" id="unlang__priv_8h_html_a70fbdcfa83b9cf4865b58a828ef0818e"><div class="ttname"><a href="unlang__priv_8h.html#a70fbdcfa83b9cf4865b58a828ef0818e">UNWIND_FLAG_REPEAT</a></div><div class="ttdeci">#define UNWIND_FLAG_REPEAT</div><div class="ttdoc">Repeat the frame on the way up the stack. </div><div class="ttdef"><b>Definition:</b> <a href="unlang__priv_8h_source.html#l00211">unlang_priv.h:211</a></div></div>
<div class="ttc" id="unlang__priv_8h_html_a49588eeff94b32b52512db36db55b59b"><div class="ttname"><a href="unlang__priv_8h.html#a49588eeff94b32b52512db36db55b59b">unlang_call_init</a></div><div class="ttdeci">void unlang_call_init(void)</div><div class="ttdef"><b>Definition:</b> <a href="call_8c_source.html#l00223">call.c:223</a></div></div>
<div class="ttc" id="unlang__priv_8h_html_ac36aa78f498e4f5bd70ddf6fdeb980c4"><div class="ttname"><a href="unlang__priv_8h.html#ac36aa78f498e4f5bd70ddf6fdeb980c4">is_repeatable</a></div><div class="ttdeci">static bool is_repeatable(unlang_stack_frame_t *frame)</div><div class="ttdef"><b>Definition:</b> <a href="unlang__priv_8h_source.html#l00233">unlang_priv.h:233</a></div></div>
<div class="ttc" id="unlang__priv_8h_html_a9125308c5289036c4809f39fc5fcf7eba24249d759c0590abd200009e68f2dd81"><div class="ttname"><a href="unlang__priv_8h.html#a9125308c5289036c4809f39fc5fcf7eba24249d759c0590abd200009e68f2dd81">UNLANG_TYPE_ELSIF</a></div><div class="ttdoc">!Condition &amp;&amp; Condition. </div><div class="ttdef"><b>Definition:</b> <a href="unlang__priv_8h_source.html#l00065">unlang_priv.h:65</a></div></div>
<div class="ttc" id="table_8h_html_structfr__table__num__sorted__t"><div class="ttname"><a href="table_8h.html#structfr__table__num__sorted__t">fr_table_num_sorted_t</a></div><div class="ttdoc">An element in a lexicographically sorted array of name to num mappings. </div><div class="ttdef"><b>Definition:</b> <a href="table_8h_source.html#l00045">table.h:45</a></div></div>
<div class="ttc" id="unlang__priv_8h_html_a62076e3c96bae8d87aad5f42e6006ae1"><div class="ttname"><a href="unlang__priv_8h.html#a62076e3c96bae8d87aad5f42e6006ae1">is_top_frame</a></div><div class="ttdeci">static bool is_top_frame(unlang_stack_frame_t *frame)</div><div class="ttdef"><b>Definition:</b> <a href="unlang__priv_8h_source.html#l00234">unlang_priv.h:234</a></div></div>
<div class="ttc" id="server_2tmpl_8h_html_structtmpl__s"><div class="ttname"><a href="server_2tmpl_8h.html#structtmpl__s">tmpl_s</a></div><div class="ttdoc">A source or sink of value data. </div><div class="ttdef"><b>Definition:</b> <a href="server_2tmpl_8h_source.html#l00426">tmpl.h:426</a></div></div>
<div class="ttc" id="unlang__priv_8h_html_a6117bf094206f53f687f83ce1c3b63e2"><div class="ttname"><a href="unlang__priv_8h.html#a6117bf094206f53f687f83ce1c3b63e2">unlang_stack_frame_t::process</a></div><div class="ttdeci">unlang_process_t process</div><div class="ttdoc">function to call for interpreting this stack frame </div><div class="ttdef"><b>Definition:</b> <a href="unlang__priv_8h_source.html#l00176">unlang_priv.h:176</a></div></div>
<div class="ttc" id="unlang__priv_8h_html_a75779acf13ee16b6dc800dc12c717815"><div class="ttname"><a href="unlang__priv_8h.html#a75779acf13ee16b6dc800dc12c717815">unlang_stack_frame_t::priority</a></div><div class="ttdeci">int priority</div><div class="ttdoc">Result priority. </div><div class="ttdef"><b>Definition:</b> <a href="unlang__priv_8h_source.html#l00191">unlang_priv.h:191</a></div></div>
<div class="ttc" id="unlang__priv_8h_html_aee5ff52c892e2e6b6f21730cd93f99f6"><div class="ttname"><a href="unlang__priv_8h.html#aee5ff52c892e2e6b6f21730cd93f99f6">unlang_foreach_init</a></div><div class="ttdeci">void unlang_foreach_init(void)</div><div class="ttdef"><b>Definition:</b> <a href="foreach_8c_source.html#l00228">foreach.c:228</a></div></div>
<div class="ttc" id="unlang__priv_8h_html_structunlang__s"><div class="ttname"><a href="unlang__priv_8h.html#structunlang__s">unlang_s</a></div><div class="ttdoc">A node in a graph of unlang_op_t (s) that we execute. </div><div class="ttdef"><b>Definition:</b> <a href="unlang__priv_8h_source.html#l00115">unlang_priv.h:115</a></div></div>
<div class="ttc" id="heap_8c_html_a52a0eeda89378004e77a978c138adaf4"><div class="ttname"><a href="heap_8c.html#a52a0eeda89378004e77a978c138adaf4">CC_HINT</a></div><div class="ttdeci">static CC_HINT(nonnull)</div><div class="ttdef"><b>Definition:</b> <a href="heap_8c_source.html#l00086">heap.c:86</a></div></div>
<div class="ttc" id="unlang__priv_8h_html_aca1fa2fa71442204099637da828cdd94"><div class="ttname"><a href="unlang__priv_8h.html#aca1fa2fa71442204099637da828cdd94">unlang_stack_frame_t::instruction</a></div><div class="ttdeci">unlang_t * instruction</div><div class="ttdoc">The unlang node we&amp;#39;re evaluating. </div><div class="ttdef"><b>Definition:</b> <a href="unlang__priv_8h_source.html#l00173">unlang_priv.h:173</a></div></div>
<div class="ttc" id="unlang__priv_8h_html_a9125308c5289036c4809f39fc5fcf7eba00e4be4c4de85069a9ec613aa187b889"><div class="ttname"><a href="unlang__priv_8h.html#a9125308c5289036c4809f39fc5fcf7eba00e4be4c4de85069a9ec613aa187b889">UNLANG_TYPE_SWITCH</a></div><div class="ttdoc">Switch section. </div><div class="ttdef"><b>Definition:</b> <a href="unlang__priv_8h_source.html#l00068">unlang_priv.h:68</a></div></div>
<div class="ttc" id="unlang__priv_8h_html_a4f3937610c1db9a68ff9f71a00ef452a"><div class="ttname"><a href="unlang__priv_8h.html#a4f3937610c1db9a68ff9f71a00ef452a">UNWIND_FLAG_NO_CLEAR</a></div><div class="ttdeci">#define UNWIND_FLAG_NO_CLEAR</div><div class="ttdoc">Keep unwinding, don&amp;#39;t clear the unwind flag. </div><div class="ttdef"><b>Definition:</b> <a href="unlang__priv_8h_source.html#l00218">unlang_priv.h:218</a></div></div>
<div class="ttc" id="unlang__priv_8h_html_a10dd1d9ee46fa53f171c91b8d649a777"><div class="ttname"><a href="unlang__priv_8h.html#a10dd1d9ee46fa53f171c91b8d649a777">unwind_to_return</a></div><div class="ttdeci">static unlang_action_t unwind_to_return(unlang_stack_t *stack)</div><div class="ttdef"><b>Definition:</b> <a href="unlang__priv_8h_source.html#l00244">unlang_priv.h:244</a></div></div>
<div class="ttc" id="unlang__priv_8h_html_a8237374f43af0c6c8ff4d5fee3212055"><div class="ttname"><a href="unlang__priv_8h.html#a8237374f43af0c6c8ff4d5fee3212055">unlang_stack_frame_t::signal</a></div><div class="ttdeci">unlang_signal_t signal</div><div class="ttdoc">function to call when signalling this stack frame </div><div class="ttdef"><b>Definition:</b> <a href="unlang__priv_8h_source.html#l00177">unlang_priv.h:177</a></div></div>
<div class="ttc" id="unlang__priv_8h_html_abcfda3f7c72df09ecedb4630531b7f80"><div class="ttname"><a href="unlang__priv_8h.html#abcfda3f7c72df09ecedb4630531b7f80">unlang_stack_frame_t::uflags</a></div><div class="ttdeci">uint8_t uflags</div><div class="ttdoc">Unwind markers. </div><div class="ttdef"><b>Definition:</b> <a href="unlang__priv_8h_source.html#l00196">unlang_priv.h:196</a></div></div>
<div class="ttc" id="unlang__priv_8h_html_a9125308c5289036c4809f39fc5fcf7eba293ce82adb8f1a27255a33a77bd9c72e"><div class="ttname"><a href="unlang__priv_8h.html#a9125308c5289036c4809f39fc5fcf7eba293ce82adb8f1a27255a33a77bd9c72e">UNLANG_TYPE_ELSE</a></div><div class="ttdoc">!Condition. </div><div class="ttdef"><b>Definition:</b> <a href="unlang__priv_8h_source.html#l00064">unlang_priv.h:64</a></div></div>
<div class="ttc" id="interpret_8h_html_ae0e65f2334112aae071c64adde8a3e31"><div class="ttname"><a href="interpret_8h.html#ae0e65f2334112aae071c64adde8a3e31">unlang_signal_t</a></div><div class="ttdeci">void(* unlang_signal_t)(request_t *request, fr_state_signal_t action)</div><div class="ttdoc">Function to call if the initial function yielded and the request was signalled. </div><div class="ttdef"><b>Definition:</b> <a href="interpret_8h_source.html#l00053">interpret.h:53</a></div></div>
<div class="ttc" id="action_8h_html_ad02ab717522305fe70aab72d152fc812a05046186cc9bd20de1e524bca3c138b5"><div class="ttname"><a href="action_8h.html#ad02ab717522305fe70aab72d152fc812a05046186cc9bd20de1e524bca3c138b5">UNLANG_ACTION_UNWIND</a></div><div class="ttdoc">Break out of the current group. </div><div class="ttdef"><b>Definition:</b> <a href="action_8h_source.html#l00040">action.h:40</a></div></div>
<div class="ttc" id="unlang__priv_8h_html_a52890e71e5baf575ea56415383a5def9"><div class="ttname"><a href="unlang__priv_8h.html#a52890e71e5baf575ea56415383a5def9">unlang_group_to_generic</a></div><div class="ttdeci">static unlang_t * unlang_group_to_generic(unlang_group_t *p)</div><div class="ttdef"><b>Definition:</b> <a href="unlang__priv_8h_source.html#l00278">unlang_priv.h:278</a></div></div>
<div class="ttc" id="unlang__priv_8h_html_ac370b76fc93b1f10b0ba0ead67a5588f"><div class="ttname"><a href="unlang__priv_8h.html#ac370b76fc93b1f10b0ba0ead67a5588f">unlang_function_init</a></div><div class="ttdeci">void unlang_function_init(void)</div><div class="ttdef"><b>Definition:</b> <a href="function_8c_source.html#l00133">function.c:133</a></div></div>
<div class="ttc" id="unlang__priv_8h_html_a9125308c5289036c4809f39fc5fcf7eba38f90b741bffc7803dc9ba1da51b8d42"><div class="ttname"><a href="unlang__priv_8h.html#a9125308c5289036c4809f39fc5fcf7eba38f90b741bffc7803dc9ba1da51b8d42">UNLANG_TYPE_LOAD_BALANCE</a></div><div class="ttdoc">Load balance section. </div><div class="ttdef"><b>Definition:</b> <a href="unlang__priv_8h_source.html#l00060">unlang_priv.h:60</a></div></div>
<div class="ttc" id="unlang__priv_8h_html_a3404ea4ea923c7da0dbc6f57a5d0e5c4"><div class="ttname"><a href="unlang__priv_8h.html#a3404ea4ea923c7da0dbc6f57a5d0e5c4">unlang_subrequest_op_init</a></div><div class="ttdeci">int unlang_subrequest_op_init(void)</div><div class="ttdef"><b>Definition:</b> <a href="subrequest_8c_source.html#l00543">subrequest.c:543</a></div></div>
<div class="ttc" id="unlang__priv_8h_html_a6a4ba1df6e016828f58b23d971d33b43"><div class="ttname"><a href="unlang__priv_8h.html#a6a4ba1df6e016828f58b23d971d33b43">unlang_op_free</a></div><div class="ttdeci">void unlang_op_free(void)</div></div>
<div class="ttc" id="unlang__priv_8h_html_a9125308c5289036c4809f39fc5fcf7eba6e696ab1ac4249a8a3605a755715c6d3"><div class="ttname"><a href="unlang__priv_8h.html#a9125308c5289036c4809f39fc5fcf7eba6e696ab1ac4249a8a3605a755715c6d3">UNLANG_TYPE_BREAK</a></div><div class="ttdoc">Break statement (within a UNLANG_TYPE_FOREACH). </div><div class="ttdef"><b>Definition:</b> <a href="unlang__priv_8h_source.html#l00071">unlang_priv.h:71</a></div></div>
<div class="ttc" id="unlang__priv_8h_html_a1e040e50f202b3f46d3317ba6099825c"><div class="ttname"><a href="unlang__priv_8h.html#a1e040e50f202b3f46d3317ba6099825c">repeatable_clear</a></div><div class="ttdeci">static void repeatable_clear(unlang_stack_frame_t *frame)</div><div class="ttdef"><b>Definition:</b> <a href="unlang__priv_8h_source.html#l00227">unlang_priv.h:227</a></div></div>
<div class="ttc" id="unlang__priv_8h_html_a9125308c5289036c4809f39fc5fcf7ebaa1d77eb047e6aa9efd357a27b80f5659"><div class="ttname"><a href="unlang__priv_8h.html#a9125308c5289036c4809f39fc5fcf7ebaa1d77eb047e6aa9efd357a27b80f5659">UNLANG_TYPE_FILTER</a></div><div class="ttdoc">Filter block. </div><div class="ttdef"><b>Definition:</b> <a href="unlang__priv_8h_source.html#l00066">unlang_priv.h:66</a></div></div>
<div class="ttc" id="unlang__priv_8h_html_a5186c55f95b4566bbbb35919858664da"><div class="ttname"><a href="unlang__priv_8h.html#a5186c55f95b4566bbbb35919858664da">UNWIND_FLAG_BREAK_POINT</a></div><div class="ttdeci">#define UNWIND_FLAG_BREAK_POINT</div><div class="ttdoc">&amp;#39;break&amp;#39; stops here. </div><div class="ttdef"><b>Definition:</b> <a href="unlang__priv_8h_source.html#l00216">unlang_priv.h:216</a></div></div>
<div class="ttc" id="unlang__priv_8h_html_a258f79c8d3ee6008a31cced51f82c129"><div class="ttname"><a href="unlang__priv_8h.html#a258f79c8d3ee6008a31cced51f82c129">unlang_ext_t::type_name</a></div><div class="ttdeci">char const  * type_name</div><div class="ttdoc">Talloc type name. </div><div class="ttdef"><b>Definition:</b> <a href="unlang__priv_8h_source.html#l00133">unlang_priv.h:133</a></div></div>
<div class="ttc" id="modules_2proto__control_2radmin_8c_html_acbb0ad34f5d8b226a09b81ea4973082d"><div class="ttname"><a href="modules_2proto__control_2radmin_8c.html#acbb0ad34f5d8b226a09b81ea4973082d">stack</a></div><div class="ttdeci">static char * stack[MAX_STACK]</div><div class="ttdef"><b>Definition:</b> <a href="modules_2proto__control_2radmin_8c_source.html#l00159">radmin.c:159</a></div></div>
<div class="ttc" id="unlang__priv_8h_html_ab4e3b6d0842d8e4a6650713f6bbd5132"><div class="ttname"><a href="unlang__priv_8h.html#ab4e3b6d0842d8e4a6650713f6bbd5132">unlang_frame_action_t</a></div><div class="ttdeci">unlang_frame_action_t</div><div class="ttdoc">Allows the frame evaluator to signal the interpreter. </div><div class="ttdef"><b>Definition:</b> <a href="unlang__priv_8h_source.html#l00088">unlang_priv.h:88</a></div></div>
<div class="ttc" id="unlang__priv_8h_html_a9a5e612bd5f8f446a2ef79eec155d3d8"><div class="ttname"><a href="unlang__priv_8h.html#a9a5e612bd5f8f446a2ef79eec155d3d8">unlang_ext_t::len</a></div><div class="ttdeci">size_t len</div><div class="ttdoc">Total length of the unlang_group_t + specialisation struct. </div><div class="ttdef"><b>Definition:</b> <a href="unlang__priv_8h_source.html#l00130">unlang_priv.h:130</a></div></div>
<div class="ttc" id="unlang__priv_8h_html_af062007fdc0d94e56d9e5217f1a70908"><div class="ttname"><a href="unlang__priv_8h.html#af062007fdc0d94e56d9e5217f1a70908">unwind_to_break</a></div><div class="ttdeci">static unlang_action_t unwind_to_break(unlang_stack_t *stack)</div><div class="ttdef"><b>Definition:</b> <a href="unlang__priv_8h_source.html#l00239">unlang_priv.h:239</a></div></div>
<div class="ttc" id="unlang__priv_8h_html_ae3815f82cc19b3704623521f132226f1"><div class="ttname"><a href="unlang__priv_8h.html#ae3815f82cc19b3704623521f132226f1">return_point_clear</a></div><div class="ttdeci">static void return_point_clear(unlang_stack_frame_t *frame)</div><div class="ttdef"><b>Definition:</b> <a href="unlang__priv_8h_source.html#l00230">unlang_priv.h:230</a></div></div>
<div class="ttc" id="unlang__priv_8h_html_a9eebe967b60b272cd59b6e19febc93fa"><div class="ttname"><a href="unlang__priv_8h.html#a9eebe967b60b272cd59b6e19febc93fa">break_point_set</a></div><div class="ttdeci">static void break_point_set(unlang_stack_frame_t *frame)</div><div class="ttdef"><b>Definition:</b> <a href="unlang__priv_8h_source.html#l00223">unlang_priv.h:223</a></div></div>
<div class="ttc" id="unlang__priv_8h_html_acf0c8002e436c1d516aaef95b217b063"><div class="ttname"><a href="unlang__priv_8h.html#acf0c8002e436c1d516aaef95b217b063">unlang_ops</a></div><div class="ttdeci">unlang_op_t unlang_ops[]</div><div class="ttdoc">Different operations the interpreter can execute. </div><div class="ttdef"><b>Definition:</b> <a href="interpret_8c_source.html#l00115">interpret.c:115</a></div></div>
<div class="ttc" id="unlang__priv_8h_html_a70f932ac3269b9e0106b27046e3e7a6f"><div class="ttname"><a href="unlang__priv_8h.html#a70f932ac3269b9e0106b27046e3e7a6f">unlang_group_t::num_children</a></div><div class="ttdeci">int num_children</div><div class="ttdef"><b>Definition:</b> <a href="unlang__priv_8h_source.html#l00146">unlang_priv.h:146</a></div></div>
<div class="ttc" id="unlang__priv_8h_html_a4b3ef924f7b47fb36e74283e303f2ed1"><div class="ttname"><a href="unlang__priv_8h.html#a4b3ef924f7b47fb36e74283e303f2ed1">UNWIND_FLAG_YIELDED</a></div><div class="ttdeci">#define UNWIND_FLAG_YIELDED</div><div class="ttdoc">frame has yielded </div><div class="ttdef"><b>Definition:</b> <a href="unlang__priv_8h_source.html#l00219">unlang_priv.h:219</a></div></div>
<div class="ttc" id="unlang__priv_8h_html_a9125308c5289036c4809f39fc5fcf7ebaa7e4b4cb27659dc6d0d57441f8206a0a"><div class="ttname"><a href="unlang__priv_8h.html#a9125308c5289036c4809f39fc5fcf7ebaa7e4b4cb27659dc6d0d57441f8206a0a">UNLANG_TYPE_IF</a></div><div class="ttdoc">Condition. </div><div class="ttdef"><b>Definition:</b> <a href="unlang__priv_8h_source.html#l00063">unlang_priv.h:63</a></div></div>
<div class="ttc" id="action_8h_html_ad02ab717522305fe70aab72d152fc812"><div class="ttname"><a href="action_8h.html#ad02ab717522305fe70aab72d152fc812">unlang_action_t</a></div><div class="ttdeci">unlang_action_t</div><div class="ttdoc">Returned by unlang_op_t calls, determine the next action of the interpreter. </div><div class="ttdef"><b>Definition:</b> <a href="action_8h_source.html#l00035">action.h:35</a></div></div>
<div class="ttc" id="unlang__priv_8h_html_a9125308c5289036c4809f39fc5fcf7ebab6e02d1f709e111e11369c30f38903a5"><div class="ttname"><a href="unlang__priv_8h.html#a9125308c5289036c4809f39fc5fcf7ebab6e02d1f709e111e11369c30f38903a5">UNLANG_TYPE_MAP</a></div><div class="ttdoc">Mapping section (like UNLANG_TYPE_UPDATE, but uses values from a map_proc_t call). </div><div class="ttdef"><b>Definition:</b> <a href="unlang__priv_8h_source.html#l00073">unlang_priv.h:73</a></div></div>
<div class="ttc" id="unlang__priv_8h_html_ad28b87be40e8cea3465bdc9764f4a3c3"><div class="ttname"><a href="unlang__priv_8h.html#ad28b87be40e8cea3465bdc9764f4a3c3">mod_rcode_table</a></div><div class="ttdeci">fr_table_num_sorted_t const mod_rcode_table[]</div><div class="ttdef"><b>Definition:</b> <a href="compile_8c_source.html#l00060">compile.c:60</a></div></div>
<div class="ttc" id="unlang__priv_8h_html_ab4e3b6d0842d8e4a6650713f6bbd5132a13f44b579aa2cbc31ceccf557d596894"><div class="ttname"><a href="unlang__priv_8h.html#ab4e3b6d0842d8e4a6650713f6bbd5132a13f44b579aa2cbc31ceccf557d596894">UNLANG_FRAME_ACTION_POP</a></div><div class="ttdoc">Pop the current frame, and check the next one further up in the stack for what to do next...</div><div class="ttdef"><b>Definition:</b> <a href="unlang__priv_8h_source.html#l00089">unlang_priv.h:89</a></div></div>
<div class="ttc" id="unlang__priv_8h_html_aefcb135b6bd137ddb87d6bf2cd31b94c"><div class="ttname"><a href="unlang__priv_8h.html#aefcb135b6bd137ddb87d6bf2cd31b94c">unlang_caller_init</a></div><div class="ttdeci">void unlang_caller_init(void)</div><div class="ttdef"><b>Definition:</b> <a href="caller_8c_source.html#l00062">caller.c:62</a></div></div>
<div class="ttc" id="unlang__priv_8h_html_aac8f5c5ad9dc7c337553f920e1a181d4"><div class="ttname"><a href="unlang__priv_8h.html#aac8f5c5ad9dc7c337553f920e1a181d4">unlang_generic_to_group</a></div><div class="ttdeci">static unlang_group_t * unlang_generic_to_group(unlang_t *p)</div><div class="ttdef"><b>Definition:</b> <a href="unlang__priv_8h_source.html#l00271">unlang_priv.h:271</a></div></div>
<div class="ttc" id="unlang__priv_8h_html_a0fe61fff5588709c463112bf511248ef"><div class="ttname"><a href="unlang__priv_8h.html#a0fe61fff5588709c463112bf511248ef">unlang_s::next</a></div><div class="ttdeci">unlang_t * next</div><div class="ttdoc">Next node (executed on UNLANG_ACTION_EXECUTE_NEXT et al). </div><div class="ttdef"><b>Definition:</b> <a href="unlang__priv_8h_source.html#l00117">unlang_priv.h:117</a></div></div>
<div class="ttc" id="unlang__priv_8h_html_a5fd8144991b05a0cde9a3f8b9447c82c"><div class="ttname"><a href="unlang__priv_8h.html#a5fd8144991b05a0cde9a3f8b9447c82c">unlang_tmpl_to_generic</a></div><div class="ttdeci">static unlang_t * unlang_tmpl_to_generic(unlang_tmpl_t *p)</div><div class="ttdef"><b>Definition:</b> <a href="unlang__priv_8h_source.html#l00289">unlang_priv.h:289</a></div></div>
<div class="ttc" id="unlang__priv_8h_html_a9125308c5289036c4809f39fc5fcf7ebabd3b1857702554aef76f7efd79395607"><div class="ttname"><a href="unlang__priv_8h.html#a9125308c5289036c4809f39fc5fcf7ebabd3b1857702554aef76f7efd79395607">UNLANG_TYPE_CALLER</a></div><div class="ttdoc">conditionally check parent dictionary type </div><div class="ttdef"><b>Definition:</b> <a href="unlang__priv_8h_source.html#l00078">unlang_priv.h:78</a></div></div>
<div class="ttc" id="unlang__priv_8h_html_ab4e3b6d0842d8e4a6650713f6bbd5132adb4acb4257ce9e6e4320cdd860ba283e"><div class="ttname"><a href="unlang__priv_8h.html#ab4e3b6d0842d8e4a6650713f6bbd5132adb4acb4257ce9e6e4320cdd860ba283e">UNLANG_FRAME_ACTION_NEXT</a></div><div class="ttdoc">Process the next instruction at this level. </div><div class="ttdef"><b>Definition:</b> <a href="unlang__priv_8h_source.html#l00091">unlang_priv.h:91</a></div></div>
<div class="ttc" id="dict__priv_8h_html_structfr__dict"><div class="ttname"><a href="dict__priv_8h.html#structfr__dict">fr_dict</a></div><div class="ttdoc">Vendors and attribute names. </div><div class="ttdef"><b>Definition:</b> <a href="dict__priv_8h_source.html#l00063">dict_priv.h:63</a></div></div>
<div class="ttc" id="unlang__priv_8h_html_a4acb4f0c9e4b6bbaf8be96f442bf5d2a"><div class="ttname"><a href="unlang__priv_8h.html#a4acb4f0c9e4b6bbaf8be96f442bf5d2a">unlang_map_init</a></div><div class="ttdeci">void unlang_map_init(void)</div><div class="ttdef"><b>Definition:</b> <a href="lib_2unlang_2map_8c_source.html#l00385">map.c:385</a></div></div>
<div class="ttc" id="unlang__priv_8h_html_ad168f9dc1f146410efa95eeec3d15698"><div class="ttname"><a href="unlang__priv_8h.html#ad168f9dc1f146410efa95eeec3d15698">unlang_stack_frame_t::next</a></div><div class="ttdeci">unlang_t * next</div><div class="ttdoc">The next unlang node we will evaluate. </div><div class="ttdef"><b>Definition:</b> <a href="unlang__priv_8h_source.html#l00174">unlang_priv.h:174</a></div></div>
<div class="ttc" id="unlang__priv_8h_html_a9125308c5289036c4809f39fc5fcf7eba5d68a4e7663a1cd15b5a120175fd3f66"><div class="ttname"><a href="unlang__priv_8h.html#a9125308c5289036c4809f39fc5fcf7eba5d68a4e7663a1cd15b5a120175fd3f66">UNLANG_TYPE_CASE</a></div><div class="ttdoc">Case section (within a UNLANG_TYPE_SWITCH). </div><div class="ttdef"><b>Definition:</b> <a href="unlang__priv_8h_source.html#l00069">unlang_priv.h:69</a></div></div>
<div class="ttc" id="unlang__priv_8h_html_structunlang__group__t"><div class="ttname"><a href="unlang__priv_8h.html#structunlang__group__t">unlang_group_t</a></div><div class="ttdoc">Generic representation of a grouping. </div><div class="ttdef"><b>Definition:</b> <a href="unlang__priv_8h_source.html#l00140">unlang_priv.h:140</a></div></div>
<div class="ttc" id="rcode_8h_html_adcc711080df76349e177fc29a641d1fbaa7707aa26ac24b3a2c83477834a75c4b"><div class="ttname"><a href="rcode_8h.html#adcc711080df76349e177fc29a641d1fbaa7707aa26ac24b3a2c83477834a75c4b">RLM_MODULE_NUMCODES</a></div><div class="ttdoc">How many valid return codes there are. </div><div class="ttdef"><b>Definition:</b> <a href="rcode_8h_source.html#l00050">rcode.h:50</a></div></div>
<div class="ttc" id="unlang__priv_8h_html_ab59bbe9174e9ec170b2b6fad735456c7"><div class="ttname"><a href="unlang__priv_8h.html#ab59bbe9174e9ec170b2b6fad735456c7">unlang_stack_frame_t::result</a></div><div class="ttdeci">rlm_rcode_t result</div><div class="ttdoc">The result from executing the instruction. </div><div class="ttdef"><b>Definition:</b> <a href="unlang__priv_8h_source.html#l00190">unlang_priv.h:190</a></div></div>
<div class="ttc" id="unlang__priv_8h_html_a7544dfc0ce8a8f8cd824812b0c78d73f"><div class="ttname"><a href="unlang__priv_8h.html#a7544dfc0ce8a8f8cd824812b0c78d73f">mod_rcode_table_len</a></div><div class="ttdeci">size_t mod_rcode_table_len</div><div class="ttdef"><b>Definition:</b> <a href="compile_8c_source.html#l00073">compile.c:73</a></div></div>
<div class="ttc" id="unlang__priv_8h_html_a9125308c5289036c4809f39fc5fcf7eb"><div class="ttname"><a href="unlang__priv_8h.html#a9125308c5289036c4809f39fc5fcf7eb">unlang_type_t</a></div><div class="ttdeci">unlang_type_t</div><div class="ttdoc">Types of unlang_t nodes. </div><div class="ttdef"><b>Definition:</b> <a href="unlang__priv_8h_source.html#l00054">unlang_priv.h:54</a></div></div>
<div class="ttc" id="unlang__priv_8h_html_ab4e3b6d0842d8e4a6650713f6bbd5132a357bdfc3bc6efb96334c2eb649bbd9aa"><div class="ttname"><a href="unlang__priv_8h.html#ab4e3b6d0842d8e4a6650713f6bbd5132a357bdfc3bc6efb96334c2eb649bbd9aa">UNLANG_FRAME_ACTION_YIELD</a></div><div class="ttdoc">Temporarily return control back to the caller on the C stack. </div><div class="ttdef"><b>Definition:</b> <a href="unlang__priv_8h_source.html#l00092">unlang_priv.h:92</a></div></div>
<div class="ttc" id="unlang__priv_8h_html_a80e6b040af5d0bd35a5c7a0449c7b452"><div class="ttname"><a href="unlang__priv_8h.html#a80e6b040af5d0bd35a5c7a0449c7b452">unlang_stack_t::depth</a></div><div class="ttdeci">int depth</div><div class="ttdoc">Current depth we&amp;#39;re executing at. </div><div class="ttdef"><b>Definition:</b> <a href="unlang__priv_8h_source.html#l00204">unlang_priv.h:204</a></div></div>
<div class="ttc" id="unlang__priv_8h_html_aacac2f2ef83343ae1a0651c3e709fa7f"><div class="ttname"><a href="unlang__priv_8h.html#aacac2f2ef83343ae1a0651c3e709fa7f">unlang_module_init</a></div><div class="ttdeci">void unlang_module_init(void)</div><div class="ttdef"><b>Definition:</b> <a href="src_2lib_2unlang_2module_8c_source.html#l00886">module.c:886</a></div></div>
<div class="ttc" id="unlang__priv_8h_html_a8a7da6c28af6138ae823a6b64f73aebd"><div class="ttname"><a href="unlang__priv_8h.html#a8a7da6c28af6138ae823a6b64f73aebd">unlang_tmpl_t::inline_exec</a></div><div class="ttdeci">bool inline_exec</div><div class="ttdef"><b>Definition:</b> <a href="unlang__priv_8h_source.html#l00156">unlang_priv.h:156</a></div></div>
<div class="ttc" id="unlang__priv_8h_html_a77e7ad7fd3638ddd6461ff63be3a19c4"><div class="ttname"><a href="unlang__priv_8h.html#a77e7ad7fd3638ddd6461ff63be3a19c4">unlang_foreach_free</a></div><div class="ttdeci">void unlang_foreach_free(void)</div><div class="ttdef"><b>Definition:</b> <a href="foreach_8c_source.html#l00252">foreach.c:252</a></div></div>
<div class="ttc" id="unlang__priv_8h_html_structunlang__ext__t"><div class="ttname"><a href="unlang__priv_8h.html#structunlang__ext__t">unlang_ext_t</a></div><div class="ttdoc">Describes how to allocate an unlang_group_t with additional memory keyword specific data...</div><div class="ttdef"><b>Definition:</b> <a href="unlang__priv_8h_source.html#l00128">unlang_priv.h:128</a></div></div>
<div class="ttc" id="unlang__priv_8h_html_a17eb0c352a522528d0f3bdbba3c803e0"><div class="ttname"><a href="unlang__priv_8h.html#a17eb0c352a522528d0f3bdbba3c803e0">UNWIND_FLAG_TOP_FRAME</a></div><div class="ttdeci">#define UNWIND_FLAG_TOP_FRAME</div><div class="ttdoc">are we the top frame of the stack? </div><div class="ttdef"><b>Definition:</b> <a href="unlang__priv_8h_source.html#l00212">unlang_priv.h:212</a></div></div>
<div class="ttc" id="unlang__priv_8h_html_a4d67463da07c5a6a66467ac17608628e"><div class="ttname"><a href="unlang__priv_8h.html#a4d67463da07c5a6a66467ac17608628e">unwind_all</a></div><div class="ttdeci">static unlang_action_t unwind_all(unlang_stack_t *stack)</div><div class="ttdef"><b>Definition:</b> <a href="unlang__priv_8h_source.html#l00249">unlang_priv.h:249</a></div></div>
<div class="ttc" id="request_8h_html_structrequest__s"><div class="ttname"><a href="request_8h.html#structrequest__s">request_s</a></div><div class="ttdef"><b>Definition:</b> <a href="request_8h_source.html#l00083">request.h:83</a></div></div>
<div class="ttc" id="unlang__priv_8h_html_af9e48baa75f1463a6f1b67f89029c962"><div class="ttname"><a href="unlang__priv_8h.html#af9e48baa75f1463a6f1b67f89029c962">is_return_point</a></div><div class="ttdeci">static bool is_return_point(unlang_stack_frame_t *frame)</div><div class="ttdef"><b>Definition:</b> <a href="unlang__priv_8h_source.html#l00236">unlang_priv.h:236</a></div></div>
<div class="ttc" id="unlang__priv_8h_html_a6ab135991d0c8e21b9b4fb94c619311f"><div class="ttname"><a href="unlang__priv_8h.html#a6ab135991d0c8e21b9b4fb94c619311f">unlang_io_process_interpret</a></div><div class="ttdeci">unlang_action_t unlang_io_process_interpret(rlm_rcode_t *p_result, module_ctx_t const *mctx, request_t *request)</div></div>
<div class="ttc" id="unlang__priv_8h_html_a8e6b3d4cbbd2ad8bbbe7e8e3c08eb8ed"><div class="ttname"><a href="unlang__priv_8h.html#a8e6b3d4cbbd2ad8bbbe7e8e3c08eb8ed">unlang_return_init</a></div><div class="ttdeci">void unlang_return_init(void)</div><div class="ttdef"><b>Definition:</b> <a href="return_8c_source.html#l00047">return.c:47</a></div></div>
<div class="ttc" id="unlang__priv_8h_html_aeae12a7f6042439203caf744c2698050"><div class="ttname"><a href="unlang__priv_8h.html#aeae12a7f6042439203caf744c2698050">unlang_subrequest_op_free</a></div><div class="ttdeci">void unlang_subrequest_op_free(void)</div><div class="ttdef"><b>Definition:</b> <a href="subrequest_8c_source.html#l00610">subrequest.c:610</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sat Nov 14 2020 00:47:00 by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
