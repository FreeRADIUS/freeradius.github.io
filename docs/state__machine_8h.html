<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>/home/runner/work/freeradius-server/freeradius-server/src/lib/eap_aka_sim/state_machine.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="freeradius.png"/></td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_c85d3e3c5052e9ad9ce18c6863244a25.html">lib</a></li><li class="navelem"><a class="el" href="dir_f9d4e3ff69623c77d4a7d0d622860436.html">eap_aka_sim</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">state_machine.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Declarations for EAP-AKA.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;freeradius-devel/eap_aka_sim/base.h&gt;</code><br />
</div><div class="textblock"><div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="closed.png" alt="+"/> Include dependency graph for state_machine.h:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="state__machine_8h__incl.svg" width="202" height="171"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</div><div class="textblock"><div id="dynsection-1" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-1-trigger" src="closed.png" alt="+"/> This graph shows which files directly or indirectly include this file:</div>
<div id="dynsection-1-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-1-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="state__machine_8h__dep__incl.svg" width="202" height="200"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</div>
<p><a href="state__machine_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:structeap__aka__sim__actions__t"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="state__machine_8h.html#structeap__aka__sim__actions__t">eap_aka_sim_actions_t</a></td></tr>
<tr class="memdesc:structeap__aka__sim__actions__t"><td class="mdescLeft">&#160;</td><td class="mdescRight">Cache sections to call on various protocol events.  <a href="state__machine_8h.html#structeap__aka__sim__actions__t">More...</a><br /></td></tr>
<tr class="separator:structeap__aka__sim__actions__t"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:unioneap__aka__sim__actions__t_8____unnamed____"><td class="memItemLeft" align="right" valign="top">union &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="state__machine_8h.html#unioneap__aka__sim__actions__t_8____unnamed____">eap_aka_sim_actions_t.__unnamed__</a></td></tr>
<tr class="separator:unioneap__aka__sim__actions__t_8____unnamed____"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:structeap__aka__sim__actions__t_8____unnamed_____8aka"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="state__machine_8h.html#structeap__aka__sim__actions__t_8____unnamed_____8aka">eap_aka_sim_actions_t.__unnamed__.aka</a></td></tr>
<tr class="separator:structeap__aka__sim__actions__t_8____unnamed_____8aka"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:structeap__aka__sim__actions__t_8____unnamed_____8sim"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="state__machine_8h.html#structeap__aka__sim__actions__t_8____unnamed_____8sim">eap_aka_sim_actions_t.__unnamed__.sim</a></td></tr>
<tr class="separator:structeap__aka__sim__actions__t_8____unnamed_____8sim"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:structeap__aka__sim__common__conf__t"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="state__machine_8h.html#structeap__aka__sim__common__conf__t">eap_aka_sim_common_conf_t</a></td></tr>
<tr class="separator:structeap__aka__sim__common__conf__t"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:structeap__aka__sim__session__t"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="state__machine_8h.html#structeap__aka__sim__session__t">eap_aka_sim_session_t</a></td></tr>
<tr class="separator:structeap__aka__sim__session__t"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a3f51a97eaa340698f12e228e73149542"><td class="memItemLeft" align="right" valign="top"><a class="el" href="action_8h.html#ad02ab717522305fe70aab72d152fc812">unlang_action_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="state__machine_8h.html#a3f51a97eaa340698f12e228e73149542">aka_sim_state_machine_start</a> (<a class="el" href="rcode_8h.html#adcc711080df76349e177fc29a641d1fb">rlm_rcode_t</a> *p_result, <a class="el" href="server_2module_8h.html#a9bcf8e012c49bd2f269dd276981a72a0">module_ctx_t</a> const *mctx, <a class="el" href="radclient_8c.html#a2fc1b64f51f8225195d32592e6fe8fc5">request_t</a> *request)</td></tr>
<tr class="memdesc:a3f51a97eaa340698f12e228e73149542"><td class="mdescLeft">&#160;</td><td class="mdescRight">Enter the EAP-IDENTITY state - State machine entry point.  <a href="#a3f51a97eaa340698f12e228e73149542">More...</a><br /></td></tr>
<tr class="separator:a3f51a97eaa340698f12e228e73149542"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Declarations for EAP-AKA. </p>
<dl class="section rcs"><dt>Id</dt><dd>6f474af9c463f93c935eaa8a2cbdb292e075c1cf </dd></dl>
<dl class="section author"><dt>Author</dt><dd>Arran Cudbard-Bell (<a href="#" onclick="location.href='mai'+'lto:'+'a.c'+'ud'+'bar'+'db'+'@fr'+'ee'+'rad'+'iu'+'s.o'+'rg'; return false;">a.cud<span style="display: none;">.nosp@m.</span>bard<span style="display: none;">.nosp@m.</span>b@fre<span style="display: none;">.nosp@m.</span>erad<span style="display: none;">.nosp@m.</span>ius.o<span style="display: none;">.nosp@m.</span>rg</a>)</dd></dl>
<dl class="section copyright"><dt>Copyright</dt><dd>2016-2019 The FreeRADIUS server project </dd>
<dd>
2016-2019 Network RADIUS SARL <a href="#" onclick="location.href='mai'+'lto:'+'sal'+'es'+'@ne'+'tw'+'ork'+'ra'+'diu'+'s.'+'com'; return false;">sales<span style="display: none;">.nosp@m.</span>@net<span style="display: none;">.nosp@m.</span>workr<span style="display: none;">.nosp@m.</span>adiu<span style="display: none;">.nosp@m.</span>s.com</a> </dd></dl>

<p class="definition">Definition in file <a class="el" href="state__machine_8h_source.html">state_machine.h</a>.</p>
</div><hr/><h2 class="groupheader">Data Structure Documentation</h2>
<a name="structeap__aka__sim__actions__t" id="structeap__aka__sim__actions__t"></a>
<h2 class="memtitle"><span class="permalink"><a href="#structeap__aka__sim__actions__t">&#9670;&nbsp;</a></span>eap_aka_sim_actions_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct eap_aka_sim_actions_t</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="textblock"><p>Cache sections to call on various protocol events. </p>

<p class="definition">Definition at line <a class="el" href="state__machine_8h_source.html#l00034">34</a> of file <a class="el" href="state__machine_8h_source.html">state_machine.h</a>.</p>
</div><div id="dynsection-2" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-2-trigger" src="closed.png" alt="+"/> Collaboration diagram for eap_aka_sim_actions_t:</div>
<div id="dynsection-2-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-2-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="structeap__aka__sim__actions__t__coll__graph.svg" width="255" height="591"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<table class="fieldtable">
<tr><th colspan="3">Data Fields</th></tr>
<tr><td class="fieldtype">
<a id="a77f6c5532fda7c6877730acf25753819"></a>union <a class="el" href="state__machine_8h.html#unioneap__aka__sim__actions__t_8____unnamed____">eap_aka_sim_actions_t</a></td>
<td class="fieldname">
__unnamed__</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a5069392bb78b1edf8e2b44d96d9d3927"></a><a class="el" href="cf__util_8h.html#a0f39d8043920472ea4c687c97f7173b3">CONF_SECTION</a> *</td>
<td class="fieldname">
clear_pseudonym</td>
<td class="fielddoc">
Clear pseudonym to permanent ID mapping. </td></tr>
<tr><td class="fieldtype">
<a id="a3e27d084a9d57882a5561cf6d82aa13f"></a><a class="el" href="cf__util_8h.html#a0f39d8043920472ea4c687c97f7173b3">CONF_SECTION</a> *</td>
<td class="fieldname">
clear_session</td>
<td class="fielddoc">
Clear authentication vectors. </td></tr>
<tr><td class="fieldtype">
<a id="af21d2240605970db1eb75ca4dca4f0eb"></a><a class="el" href="cf__util_8h.html#a0f39d8043920472ea4c687c97f7173b3">CONF_SECTION</a> *</td>
<td class="fieldname">
load_pseudonym</td>
<td class="fielddoc">
Resolve a pseudonym to a permanent ID. </td></tr>
<tr><td class="fieldtype">
<a id="a3b806c6684bcfe1fcc53f452fecc2602"></a><a class="el" href="cf__util_8h.html#a0f39d8043920472ea4c687c97f7173b3">CONF_SECTION</a> *</td>
<td class="fieldname">
load_session</td>
<td class="fielddoc">
Load cached authentication vectors. </td></tr>
<tr><td class="fieldtype">
<a id="a36d816a2bee90441ea5bc01e8a7598bf"></a><a class="el" href="cf__util_8h.html#a0f39d8043920472ea4c687c97f7173b3">CONF_SECTION</a> *</td>
<td class="fieldname">
recv_challenge_response</td>
<td class="fielddoc">
Called when we receive a response to a previous challenge. </td></tr>
<tr><td class="fieldtype">
<a id="aac8ece96e6cc9389de65d2bb32075926"></a><a class="el" href="cf__util_8h.html#a0f39d8043920472ea4c687c97f7173b3">CONF_SECTION</a> *</td>
<td class="fieldname">
recv_client_error</td>
<td class="fielddoc">
Called if the supplicant experiences an error of some kind. </td></tr>
<tr><td class="fieldtype">
<a id="acca08e7724157524bc2e9fb84f778907"></a><a class="el" href="cf__util_8h.html#a0f39d8043920472ea4c687c97f7173b3">CONF_SECTION</a> *</td>
<td class="fieldname">
recv_failure_notification_ack</td>
<td class="fielddoc">
Called when the supplicant ACKs our failure notification. </td></tr>
<tr><td class="fieldtype">
<a id="a05c71eb026d88b2fc24423d7b2cca23a"></a><a class="el" href="cf__util_8h.html#a0f39d8043920472ea4c687c97f7173b3">CONF_SECTION</a> *</td>
<td class="fieldname">
recv_fast_reauth_response</td>
<td class="fielddoc">
Called when we receive a response to a previous Fast-Reauth-Request. </td></tr>
<tr><td class="fieldtype">
<a id="afcee9ec5c92d69fdac2330f0b5721b0d"></a><a class="el" href="cf__util_8h.html#a0f39d8043920472ea4c687c97f7173b3">CONF_SECTION</a> *</td>
<td class="fieldname">
recv_identity_response</td>
<td class="fielddoc">
Called when we receive a new identity. </td></tr>
<tr><td class="fieldtype">
<a id="a35895dfcd36291f0eb2ee8517c26a655"></a><a class="el" href="cf__util_8h.html#a0f39d8043920472ea4c687c97f7173b3">CONF_SECTION</a> *</td>
<td class="fieldname">
recv_reauthentication_response</td>
<td class="fielddoc">
Process the reauthentication response. <p>from the supplicant. </p>
</td></tr>
<tr><td class="fieldtype">
<a id="ad81188f6731eefa0140346aa7dc7f497"></a><a class="el" href="cf__util_8h.html#a0f39d8043920472ea4c687c97f7173b3">CONF_SECTION</a> *</td>
<td class="fieldname">
recv_success_notification_ack</td>
<td class="fielddoc">
Called when the supplicant ACKs our success notification. </td></tr>
<tr><td class="fieldtype">
<a id="a481b41b42b2a5a9a9ce13202e3721695"></a><a class="el" href="cf__util_8h.html#a0f39d8043920472ea4c687c97f7173b3">CONF_SECTION</a> *</td>
<td class="fieldname">
send_challenge_request</td>
<td class="fielddoc">
Called when we're about to send a a challenge. </td></tr>
<tr><td class="fieldtype">
<a id="a9d9ec28dbd8b77583e234f95265a1f73"></a><a class="el" href="cf__util_8h.html#a0f39d8043920472ea4c687c97f7173b3">CONF_SECTION</a> *</td>
<td class="fieldname">
send_eap_failure</td>
<td class="fielddoc">
Called when we send an EAP-Failure message. </td></tr>
<tr><td class="fieldtype">
<a id="aeacb4f616186477eb788eb643c3ff0fd"></a><a class="el" href="cf__util_8h.html#a0f39d8043920472ea4c687c97f7173b3">CONF_SECTION</a> *</td>
<td class="fieldname">
send_eap_success</td>
<td class="fielddoc">
Called when we send an EAP-Success message. </td></tr>
<tr><td class="fieldtype">
<a id="a1d82442341b2e9b5176d9981ae82406c"></a><a class="el" href="cf__util_8h.html#a0f39d8043920472ea4c687c97f7173b3">CONF_SECTION</a> *</td>
<td class="fieldname">
send_failure_notification</td>
<td class="fielddoc">
Called when we're about to send a failure notification. </td></tr>
<tr><td class="fieldtype">
<a id="a76fa138b466d821acaaafc965b4deecf"></a><a class="el" href="cf__util_8h.html#a0f39d8043920472ea4c687c97f7173b3">CONF_SECTION</a> *</td>
<td class="fieldname">
send_fast_reauth_request</td>
<td class="fielddoc">
Called when we're about to send a Fast-Reauth-Request. </td></tr>
<tr><td class="fieldtype">
<a id="af9997c1dfabd1133a71c98787c23ca7c"></a><a class="el" href="cf__util_8h.html#a0f39d8043920472ea4c687c97f7173b3">CONF_SECTION</a> *</td>
<td class="fieldname">
send_identity_request</td>
<td class="fielddoc">
Called when we're about to request a different identity. </td></tr>
<tr><td class="fieldtype">
<a id="abeefed850fbeaf76424401316683949a"></a><a class="el" href="cf__util_8h.html#a0f39d8043920472ea4c687c97f7173b3">CONF_SECTION</a> *</td>
<td class="fieldname">
send_reauthentication_request</td>
<td class="fielddoc">
Challenge the supplicant with an MK from an existing session. </td></tr>
<tr><td class="fieldtype">
<a id="a6dac26eef6d53836189b2049ac132c3d"></a><a class="el" href="cf__util_8h.html#a0f39d8043920472ea4c687c97f7173b3">CONF_SECTION</a> *</td>
<td class="fieldname">
send_success_notification</td>
<td class="fielddoc">
Called when we're about to send a success notification. </td></tr>
<tr><td class="fieldtype">
<a id="aaa1ee5aef4d4bc5ec9c6cca7c8dd36ab"></a><a class="el" href="cf__util_8h.html#a0f39d8043920472ea4c687c97f7173b3">CONF_SECTION</a> *</td>
<td class="fieldname">
store_pseudonym</td>
<td class="fielddoc">
Store a permanent ID to pseudonym mapping. </td></tr>
<tr><td class="fieldtype">
<a id="adb1ec0a64e6cde17ec989a222c14ba82"></a><a class="el" href="cf__util_8h.html#a0f39d8043920472ea4c687c97f7173b3">CONF_SECTION</a> *</td>
<td class="fieldname">
store_session</td>
<td class="fielddoc">
Store authentication vectors. </td></tr>
</table>

</div>
</div>
<a name="unioneap__aka__sim__actions__t_8____unnamed____" id="unioneap__aka__sim__actions__t_8____unnamed____"></a>
<h2 class="memtitle"><span class="permalink"><a href="#unioneap__aka__sim__actions__t_8____unnamed____">&#9670;&nbsp;</a></span>eap_aka_sim_actions_t.__unnamed__</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">union eap_aka_sim_actions_t.__unnamed__</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="textblock">
<p class="definition">Definition at line <a class="el" href="state__machine_8h_source.html#l00035">35</a> of file <a class="el" href="state__machine_8h_source.html">state_machine.h</a>.</p>
</div><table class="fieldtable">
<tr><th colspan="3">Data Fields</th></tr>
<tr><td class="fieldtype">
<a id="a6ac933301a3933c8a22ceebea7000326"></a><a class="el" href="state__machine_8h.html#structeap__aka__sim__actions__t_8____unnamed_____8aka">__unnamed__</a></td>
<td class="fieldname">
aka</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="ae9064b74d28acc053231170bb8c858b3"></a><a class="el" href="state__machine_8h.html#structeap__aka__sim__actions__t_8____unnamed_____8sim">__unnamed__</a></td>
<td class="fieldname">
sim</td>
<td class="fielddoc">
</td></tr>
</table>

</div>
</div>
<a name="structeap__aka__sim__actions__t_8____unnamed_____8aka" id="structeap__aka__sim__actions__t_8____unnamed_____8aka"></a>
<h2 class="memtitle"><span class="permalink"><a href="#structeap__aka__sim__actions__t_8____unnamed_____8aka">&#9670;&nbsp;</a></span>eap_aka_sim_actions_t.__unnamed__.aka</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct eap_aka_sim_actions_t.__unnamed__.aka</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="textblock">
<p class="definition">Definition at line <a class="el" href="state__machine_8h_source.html#l00036">36</a> of file <a class="el" href="state__machine_8h_source.html">state_machine.h</a>.</p>
</div><table class="fieldtable">
<tr><th colspan="3">Data Fields</th></tr>
<tr><td class="fieldtype">
<a id="af578a40da5ba425ac8103a7cd7c725ed"></a><a class="el" href="cf__util_8h.html#a0f39d8043920472ea4c687c97f7173b3">CONF_SECTION</a> *</td>
<td class="fieldname">
recv_aka_identity_response</td>
<td class="fielddoc">
Called when we receive a new identity. </td></tr>
<tr><td class="fieldtype">
<a id="a1f9822c6a950aa49d8b9a3f2b0a3626e"></a><a class="el" href="cf__util_8h.html#a0f39d8043920472ea4c687c97f7173b3">CONF_SECTION</a> *</td>
<td class="fieldname">
recv_authentication_reject</td>
<td class="fielddoc">
Called if the supplicant rejects the authentication attempt. </td></tr>
<tr><td class="fieldtype">
<a id="a217c17f57b3256db35ccdaf4c5761578"></a><a class="el" href="cf__util_8h.html#a0f39d8043920472ea4c687c97f7173b3">CONF_SECTION</a> *</td>
<td class="fieldname">
recv_syncronization_failure</td>
<td class="fielddoc">
Called if the supplicant determines the AUTN value is invalid. <p>Usually used for resyncing with the HLR. </p>
</td></tr>
<tr><td class="fieldtype">
<a id="a3c5d3cf0e6b4e37ea41fd95032f89f96"></a><a class="el" href="cf__util_8h.html#a0f39d8043920472ea4c687c97f7173b3">CONF_SECTION</a> *</td>
<td class="fieldname">
send_aka_identity_request</td>
<td class="fielddoc">
Called when we're about to request a different identity. </td></tr>
</table>

</div>
</div>
<a name="structeap__aka__sim__actions__t_8____unnamed_____8sim" id="structeap__aka__sim__actions__t_8____unnamed_____8sim"></a>
<h2 class="memtitle"><span class="permalink"><a href="#structeap__aka__sim__actions__t_8____unnamed_____8sim">&#9670;&nbsp;</a></span>eap_aka_sim_actions_t.__unnamed__.sim</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct eap_aka_sim_actions_t.__unnamed__.sim</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="textblock">
<p class="definition">Definition at line <a class="el" href="state__machine_8h_source.html#l00048">48</a> of file <a class="el" href="state__machine_8h_source.html">state_machine.h</a>.</p>
</div><table class="fieldtable">
<tr><th colspan="3">Data Fields</th></tr>
<tr><td class="fieldtype">
<a id="a7e206e7e8f90dc28da18fc8df5feb05e"></a><a class="el" href="cf__util_8h.html#a0f39d8043920472ea4c687c97f7173b3">CONF_SECTION</a> *</td>
<td class="fieldname">
recv_sim_start_response</td>
<td class="fielddoc">
Called when we receive a new identity. </td></tr>
<tr><td class="fieldtype">
<a id="aa601e131ffc0921bed266f9d24873636"></a><a class="el" href="cf__util_8h.html#a0f39d8043920472ea4c687c97f7173b3">CONF_SECTION</a> *</td>
<td class="fieldname">
send_sim_start_request</td>
<td class="fielddoc">
Called when we're about to request a different identity. </td></tr>
</table>

</div>
</div>
<a name="structeap__aka__sim__common__conf__t" id="structeap__aka__sim__common__conf__t"></a>
<h2 class="memtitle"><span class="permalink"><a href="#structeap__aka__sim__common__conf__t">&#9670;&nbsp;</a></span>eap_aka_sim_common_conf_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct eap_aka_sim_common_conf_t</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="textblock">
<p class="definition">Definition at line <a class="el" href="state__machine_8h_source.html#l00160">160</a> of file <a class="el" href="state__machine_8h_source.html">state_machine.h</a>.</p>
</div><div id="dynsection-3" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-3-trigger" src="closed.png" alt="+"/> Collaboration diagram for eap_aka_sim_common_conf_t:</div>
<div id="dynsection-3-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-3-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="structeap__aka__sim__common__conf__t__coll__graph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<table class="fieldtable">
<tr><th colspan="3">Data Fields</th></tr>
<tr><td class="fieldtype">
<a id="a5586e92911545a1309b8ab8377368caa"></a><a class="el" href="state__machine_8h.html#structeap__aka__sim__actions__t">eap_aka_sim_actions_t</a></td>
<td class="fieldname">
actions</td>
<td class="fielddoc">
Pre-compiled virtual server sections. </td></tr>
<tr><td class="fieldtype">
<a id="aae633c695e74dbc2db67660da5e6add6"></a>size_t</td>
<td class="fieldname">
ephemeral_id_length</td>
<td class="fielddoc">
The length of any identities we're generating. </td></tr>
<tr><td class="fieldtype">
<a id="a447dd8ab385b352d12e21f8f284970be"></a>char const  *</td>
<td class="fieldname">
network_name</td>
<td class="fielddoc">
Network ID as described by RFC 5448. </td></tr>
<tr><td class="fieldtype">
<a id="ab1b2442cc40d0bf6f905994c0201d7dd"></a>bool</td>
<td class="fieldname">
protected_success</td>
<td class="fielddoc">
Send a success notification as well as and EAP-Success packet. </td></tr>
<tr><td class="fieldtype">
<a id="aab508732fede1b529568358c05a1dc6f"></a><a class="el" href="eap__aka__sim_2id_8h.html#a3fba7fcd8553ac1e4fa04fa239c5e38c">fr_aka_sim_id_req_type_t</a></td>
<td class="fieldname">
request_identity</td>
<td class="fielddoc">
Whether we always request the identity of the subscriber. </td></tr>
<tr><td class="fieldtype">
<a id="a054edd979b61a0f12b88a7803359d91d"></a>bool</td>
<td class="fieldname">
send_at_bidding_prefer_prime</td>
<td class="fielddoc">
Include the AT bidding attribute in challenge requests. </td></tr>
<tr><td class="fieldtype">
<a id="a9801f48c7855c6022c3d8571d1be9b2d"></a>bool</td>
<td class="fieldname">
send_at_bidding_prefer_prime_is_set</td>
<td class="fielddoc">
Whether the user specified a value. </td></tr>
<tr><td class="fieldtype">
<a id="a2c347249657e0d1f95d9e86d0cb6f08a"></a>bool</td>
<td class="fieldname">
strip_permanent_identity_hint</td>
<td class="fielddoc">
Control whether the hint byte is stripped when populating Permanent-Identity. </td></tr>
<tr><td class="fieldtype">
<a id="abe8bd62c8be7e64cfb6735b0febe5d2e"></a><a class="el" href="cf__util_8h.html#a0f39d8043920472ea4c687c97f7173b3">CONF_SECTION</a> *</td>
<td class="fieldname">
virtual_server</td>
<td class="fielddoc">
Virtual server. </td></tr>
</table>

</div>
</div>
<a name="structeap__aka__sim__session__t" id="structeap__aka__sim__session__t"></a>
<h2 class="memtitle"><span class="permalink"><a href="#structeap__aka__sim__session__t">&#9670;&nbsp;</a></span>eap_aka_sim_session_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct eap_aka_sim_session_t</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="textblock">
<p class="definition">Definition at line <a class="el" href="state__machine_8h_source.html#l00100">100</a> of file <a class="el" href="state__machine_8h_source.html">state_machine.h</a>.</p>
</div><div id="dynsection-4" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-4-trigger" src="closed.png" alt="+"/> Collaboration diagram for eap_aka_sim_session_t:</div>
<div id="dynsection-4-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-4-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="structeap__aka__sim__session__t__coll__graph.svg" width="334" height="127"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<table class="fieldtable">
<tr><th colspan="3">Data Fields</th></tr>
<tr><td class="fieldtype">
<a id="a0dac15fbbe86a2b5f4eaea03846fe717"></a>bool</td>
<td class="fieldname">
allow_encrypted</td>
<td class="fielddoc">
Whether we can send encrypted attributes at this phase of the attempt. </td></tr>
<tr><td class="fieldtype">
<a id="a8ce53a38fb37c86c90d63201f189be34"></a>bool</td>
<td class="fieldname">
challenge_success</td>
<td class="fielddoc">
Whether we received the correct challenge response. </td></tr>
<tr><td class="fieldtype">
<a id="a0939396e938f06b29b639fd9101d4015"></a>uint8_t</td>
<td class="fieldname">
checkcode[32]</td>
<td class="fielddoc">
Checkcode we calculated. </td></tr>
<tr><td class="fieldtype">
<a id="a240c16c3f67dc3f66b08a9e221a1325d"></a>size_t</td>
<td class="fieldname">
checkcode_len</td>
<td class="fielddoc">
0, 20 or 32 bytes. </td></tr>
<tr><td class="fieldtype">
<a id="aaf0c801a98594b8d4c2ee57fa37f6419"></a>EVP_MD const  *</td>
<td class="fieldname">
checkcode_md</td>
<td class="fielddoc">
Message digest we use to generate the checkcode. <p>EVP_sha1() for EAP-AKA/SIM, EVP_sha256() for EAP-AKA'. </p>
</td></tr>
<tr><td class="fieldtype">
<a id="aa52436acff413d9c680623b993f65d14"></a><a class="el" href="eap__aka__sim_2base_8h.html#structfr__aka__sim__checkcode__t">fr_aka_sim_checkcode_t</a> *</td>
<td class="fieldname">
checkcode_state</td>
<td class="fielddoc">
Digest of all identity packets we've seen. </td></tr>
<tr><td class="fieldtype">
<a id="a1c00241dfe7f0daffd8edbed4eee6d2d"></a>uint16_t</td>
<td class="fieldname">
failure_type</td>
<td class="fielddoc">
One of the following values: <ul>
<li>FR_NOTIFICATION_VALUE_GENERAL_FAILURE_AFTER_AUTHENTICATION</li>
<li>FR_NOTIFICATION_VALUE_TEMPORARILY_DENIED</li>
<li>FR_NOTIFICATION_VALUE_NOT_SUBSCRIBED</li>
<li>FR_NOTIFICATION_VALUE_GENERAL_FAILURE </li>
</ul>
</td></tr>
<tr><td class="fieldtype">
<a id="a298ba683204a8fbdd7008ebe6b71fa7b"></a>char *</td>
<td class="fieldname">
fastauth_sent</td>
<td class="fielddoc">
Fastauth value we sent. </td></tr>
<tr><td class="fieldtype">
<a id="a56b258a67e9a1ebbacf0095bbc31d1b6"></a>int</td>
<td class="fieldname">
id</td>
<td class="fielddoc">
Packet ID. (replay protection). </td></tr>
<tr><td class="fieldtype">
<a id="a9b850e227bb3c3340d05482369401d73"></a><a class="el" href="eap__aka__sim_2id_8h.html#a3fba7fcd8553ac1e4fa04fa239c5e38c">fr_aka_sim_id_req_type_t</a></td>
<td class="fieldname">
id_req</td>
<td class="fielddoc">
The type of identity we're requesting. </td></tr>
<tr><td class="fieldtype">
<a id="af41e4ed22770263b623ac646fe7c2c37"></a>uint16_t</td>
<td class="fieldname">
kdf</td>
<td class="fielddoc">
The key derivation function used to derive session keys. </td></tr>
<tr><td class="fieldtype">
<a id="a9c0c51cdcf8e10130865ae6dcef905a9"></a><a class="el" href="eap__aka__sim_2base_8h.html#structfr__aka__sim__keys__t">fr_aka_sim_keys_t</a></td>
<td class="fieldname">
keys</td>
<td class="fielddoc">
Various EAP-AKA/AKA'/SIMkeys. </td></tr>
<tr><td class="fieldtype">
<a id="aebb1cfab130c10dafa2f448b2522637e"></a><a class="el" href="eap__aka__sim_2id_8h.html#a3fba7fcd8553ac1e4fa04fa239c5e38c">fr_aka_sim_id_req_type_t</a></td>
<td class="fieldname">
last_id_req</td>
<td class="fielddoc">
The last identity request we sent. </td></tr>
<tr><td class="fieldtype">
<a id="a35836cd446f7ec01891a4a28ba72a0dc"></a>EVP_MD const  *</td>
<td class="fieldname">
mac_md</td>
<td class="fielddoc">
HMAC-MD we use to generate the MAC. <p>EVP_sha1() for EAP-AKA, EVP_sha256() for EAP-AKA'. </p>
</td></tr>
<tr><td class="fieldtype">
<a id="af70a9ce48e702d8b199f20a46c2a0435"></a>bool</td>
<td class="fieldname">
prev_recv_sync_failure</td>
<td class="fielddoc">
We only allow one sync failure per session for sanity. </td></tr>
<tr><td class="fieldtype">
<a id="a3ef5870c3f9725ee2ac826fc6f1f1fee"></a>char *</td>
<td class="fieldname">
pseudonym_sent</td>
<td class="fielddoc">
Pseudonym value we sent. </td></tr>
<tr><td class="fieldtype">
<a id="a37551e23c54d136e51e49039e0b5b40f"></a>bool</td>
<td class="fieldname">
reauthentication_success</td>
<td class="fielddoc">
Whether we got a valid reauthentication response. </td></tr>
<tr><td class="fieldtype">
<a id="af1c8bffd6e966e2f369a3c993ed019c6"></a>bool</td>
<td class="fieldname">
send_at_bidding_prefer_prime</td>
<td class="fielddoc">
Indicate that we prefer EAP-AKA' and include an AT_BIDDING attribute. </td></tr>
<tr><td class="fieldtype">
<a id="a2718713459f6c5847fe6ad13bce9b3d4"></a>bool</td>
<td class="fieldname">
send_result_ind</td>
<td class="fielddoc">
Say that we would like to use protected result indications (AKA-Notification-Success). </td></tr>
<tr><td class="fieldtype">
<a id="aaf922f666e735793f746663e114f99e5"></a><a class="el" href="eap_2types_8h.html#a7a1e765e943f74ce5fc2a784e753bfa6">eap_type_t</a></td>
<td class="fieldname">
type</td>
<td class="fielddoc">
Either FR_TYPE_AKA, or FR_TYPE_AKA_PRIME. </td></tr>
</table>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a3f51a97eaa340698f12e228e73149542"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3f51a97eaa340698f12e228e73149542">&#9670;&nbsp;</a></span>aka_sim_state_machine_start()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="action_8h.html#ad02ab717522305fe70aab72d152fc812">unlang_action_t</a> aka_sim_state_machine_start </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="rcode_8h.html#adcc711080df76349e177fc29a641d1fb">rlm_rcode_t</a> *&#160;</td>
          <td class="paramname"><em>p_result</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="server_2module_8h.html#a9bcf8e012c49bd2f269dd276981a72a0">module_ctx_t</a> const *&#160;</td>
          <td class="paramname"><em>mctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="radclient_8c.html#a2fc1b64f51f8225195d32592e6fe8fc5">request_t</a> *&#160;</td>
          <td class="paramname"><em>request</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Enter the EAP-IDENTITY state - State machine entry point. </p>
<ul>
<li>Process the incoming EAP-Identity-Response</li>
<li>Start EAP-SIM/EAP-AKA/EAP-AKA' state machine optionally calling 'recv Identity-Response { ... }' </li>
</ul>

<p class="definition">Definition at line <a class="el" href="state__machine_8c_source.html#l04155">4155</a> of file <a class="el" href="state__machine_8c_source.html">state_machine.c</a>.</p>
<div id="dynsection-5" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-5-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-5-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-5-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="state__machine_8h_a3f51a97eaa340698f12e228e73149542_cgraph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Fri Nov 13 2020 23:01:04 by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
