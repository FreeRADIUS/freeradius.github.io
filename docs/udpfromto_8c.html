<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>/home/runner/work/freeradius-server/freeradius-server/src/lib/util/udpfromto.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="freeradius.png"/></td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_c85d3e3c5052e9ad9ce18c6863244a25.html">lib</a></li><li class="navelem"><a class="el" href="dir_862598e893fc0f1bed46c00d00206efb.html">util</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">udpfromto.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>API for sending and receiving packets on unconnected UDP sockets.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;freeradius-devel/util/udpfromto.h&gt;</code><br />
<code>#include &lt;errno.h&gt;</code><br />
<code>#include &lt;fcntl.h&gt;</code><br />
<code>#include &lt;string.h&gt;</code><br />
<code>#include &lt;sys/socket.h&gt;</code><br />
<code>#include &lt;sys/time.h&gt;</code><br />
<code>#include &lt;<a class="el" href="time_8h_source.html">time.h</a>&gt;</code><br />
<code>#include &lt;unistd.h&gt;</code><br />
</div><div class="textblock"><div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="closed.png" alt="+"/> Include dependency graph for udpfromto.c:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="udpfromto_8c__incl.svg" width="100%" height="484"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</div>
<p><a href="udpfromto_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a68cc6215788f9cdd08a1ba436f3cb726"><td class="memItemLeft" align="right" valign="top">#<a class="el" href="build_8h.html#a0ec3f1f76900803ac4f041eb90b84a34">define</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="udpfromto_8c.html#a68cc6215788f9cdd08a1ba436f3cb726">SOL_IP</a>&#160;&#160;&#160;IPPROTO_IP</td></tr>
<tr class="separator:a68cc6215788f9cdd08a1ba436f3cb726"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ae4728a893c6d7a6a82c29b4fcaefcd16"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="udpfromto_8c.html#ae4728a893c6d7a6a82c29b4fcaefcd16">recvfromto</a> (int fd, void *buf, size_t <a class="el" href="ipaccess_8h.html#a8aed22e2c7b283705ec82e0120515618">len</a>, int flags, int *ifindex, struct sockaddr *from, socklen_t *from_len, struct sockaddr *to, socklen_t *to_len, <a class="el" href="time_8h.html#ae3bbe82b46d7b09dbfc1caa6765ddbde">fr_time_t</a> *when)</td></tr>
<tr class="memdesc:ae4728a893c6d7a6a82c29b4fcaefcd16"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read a packet from a file descriptor, retrieving additional header information.  <a href="#ae4728a893c6d7a6a82c29b4fcaefcd16">More...</a><br /></td></tr>
<tr class="separator:ae4728a893c6d7a6a82c29b4fcaefcd16"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5fffa50bafd209f8c497be945f455dd1"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="udpfromto_8c.html#a5fffa50bafd209f8c497be945f455dd1">sendfromto</a> (int fd, void *buf, size_t <a class="el" href="ipaccess_8h.html#a8aed22e2c7b283705ec82e0120515618">len</a>, int flags, int ifindex, struct sockaddr *from, socklen_t from_len, struct sockaddr *to, socklen_t to_len)</td></tr>
<tr class="memdesc:a5fffa50bafd209f8c497be945f455dd1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Send packet via a file descriptor, setting the src address and outbound interface.  <a href="#a5fffa50bafd209f8c497be945f455dd1">More...</a><br /></td></tr>
<tr class="separator:a5fffa50bafd209f8c497be945f455dd1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3df847292939efdd74f6c028b4ac8516"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="udpfromto_8c.html#a3df847292939efdd74f6c028b4ac8516">udpfromto_init</a> (int s)</td></tr>
<tr class="separator:a3df847292939efdd74f6c028b4ac8516"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>API for sending and receiving packets on unconnected UDP sockets. </p>
<p>Like recvfrom, but also stores the destination IP address. Useful on multihomed hosts.</p>
<dl class="section copyright"><dt>Copyright</dt><dd>2007 Alan DeKok (<a href="#" onclick="location.href='mai'+'lto:'+'ala'+'nd'+'@de'+'pl'+'oyi'+'ng'+'rad'+'iu'+'s.c'+'om'; return false;">aland<span style="display: none;">.nosp@m.</span>@dep<span style="display: none;">.nosp@m.</span>loyin<span style="display: none;">.nosp@m.</span>grad<span style="display: none;">.nosp@m.</span>ius.c<span style="display: none;">.nosp@m.</span>om</a>) </dd>
<dd>
2002 Miquel van Smoorenburg </dd></dl>

<p class="definition">Definition in file <a class="el" href="udpfromto_8c_source.html">udpfromto.c</a>.</p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a68cc6215788f9cdd08a1ba436f3cb726"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a68cc6215788f9cdd08a1ba436f3cb726">&#9670;&nbsp;</a></span>SOL_IP</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#<a class="el" href="build_8h.html#a0ec3f1f76900803ac4f041eb90b84a34">define</a> SOL_IP&#160;&#160;&#160;IPPROTO_IP</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="udpfromto_8c_source.html#l00047">47</a> of file <a class="el" href="udpfromto_8c_source.html">udpfromto.c</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="ae4728a893c6d7a6a82c29b4fcaefcd16"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae4728a893c6d7a6a82c29b4fcaefcd16">&#9670;&nbsp;</a></span>recvfromto()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int recvfromto </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>fd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>flags</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>ifindex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct sockaddr *&#160;</td>
          <td class="paramname"><em>from</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">socklen_t *&#160;</td>
          <td class="paramname"><em>from_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct sockaddr *&#160;</td>
          <td class="paramname"><em>to</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">socklen_t *&#160;</td>
          <td class="paramname"><em>to_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="time_8h.html#ae3bbe82b46d7b09dbfc1caa6765ddbde">fr_time_t</a> *&#160;</td>
          <td class="paramname"><em>when</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Read a packet from a file descriptor, retrieving additional header information. </p>
<p>Abstracts away the complexity of using the complexity of using recvmsg().</p>
<p>In addition to reading data from the file descriptor, the src and dst addresses and the receiving interface index are retrieved. This enables us to send replies using the correct IP interface, in the case where the server is multihomed. This is not normally possible on unconnected datagram sockets.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">fd</td><td>The file descriptor to read from. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">buf</td><td>Where to write the received datagram data. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">len</td><td>of buf. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">flags</td><td>passed unmolested to recvmsg. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ifindex</td><td>The interface which received the datagram (may be NULL). Will only be populated if to is not NULL. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">from</td><td>Where to write the source address. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">from_len</td><td>Length of the structure pointed to by from. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">to</td><td>Where to write the destination address. If NULL recvmsg() will be used instead. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">to_len</td><td>Length of the structure pointed to by to. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">when</td><td>the packet was received (may be NULL). If SO_TIMESTAMP is not available or SO_TIMESTAMP Was not set on the socket, then another method will be used instead to get the time. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><ul>
<li>0 on success.</li>
<li>-1 on failure. </li>
</ul>
</dd></dl>

<p class="definition">Definition at line <a class="el" href="udpfromto_8c_source.html#l00192">192</a> of file <a class="el" href="udpfromto_8c_source.html">udpfromto.c</a>.</p>
<div id="dynsection-1" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-1-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-1-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-1-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="udpfromto_8c_ae4728a893c6d7a6a82c29b4fcaefcd16_cgraph.svg" width="466" height="52"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
<div id="dynsection-2" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-2-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-2-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-2-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="udpfromto_8c_ae4728a893c6d7a6a82c29b4fcaefcd16_icgraph.svg" width="100%" height="460"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>

</div>
</div>
<a id="a5fffa50bafd209f8c497be945f455dd1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5fffa50bafd209f8c497be945f455dd1">&#9670;&nbsp;</a></span>sendfromto()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int sendfromto </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>fd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>flags</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ifindex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct sockaddr *&#160;</td>
          <td class="paramname"><em>from</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">socklen_t&#160;</td>
          <td class="paramname"><em>from_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct sockaddr *&#160;</td>
          <td class="paramname"><em>to</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">socklen_t&#160;</td>
          <td class="paramname"><em>to_len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Send packet via a file descriptor, setting the src address and outbound interface. </p>
<p>Abstracts away the complexity of using the complexity of using sendmsg().</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">fd</td><td>The file descriptor to write to. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">buf</td><td>Where to read datagram data from. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">len</td><td>of datagram data. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">flags</td><td>passed unmolested to sendmsg. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ifindex</td><td>The interface on which to send the datagram. If automatic interface selection is desired, value should be 0. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">from</td><td>The source address. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">from_len</td><td>Length of the structure pointed to by from. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">to</td><td>The destination address. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">to_len</td><td>Length of the structure pointed to by to. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><ul>
<li>0 on success.</li>
<li>-1 on failure. </li>
</ul>
</dd></dl>

<p class="definition">Definition at line <a class="el" href="udpfromto_8c_source.html#l00381">381</a> of file <a class="el" href="udpfromto_8c_source.html">udpfromto.c</a>.</p>
<div id="dynsection-3" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-3-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-3-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-3-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="udpfromto_8c_a5fffa50bafd209f8c497be945f455dd1_cgraph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
<div id="dynsection-4" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-4-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-4-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-4-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="udpfromto_8c_a5fffa50bafd209f8c497be945f455dd1_icgraph.svg" width="100%" height="470"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>

</div>
</div>
<a id="a3df847292939efdd74f6c028b4ac8516"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3df847292939efdd74f6c028b4ac8516">&#9670;&nbsp;</a></span>udpfromto_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int udpfromto_init </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>s</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="udpfromto_8c_source.html#l00098">98</a> of file <a class="el" href="udpfromto_8c_source.html">udpfromto.c</a>.</p>
<div id="dynsection-5" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-5-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-5-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-5-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="udpfromto_8c_a3df847292939efdd74f6c028b4ac8516_icgraph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sun Nov 15 2020 16:11:12 by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
