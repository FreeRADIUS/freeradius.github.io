<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>/home/runner/work/freeradius-server/freeradius-server/src/lib/sim/comp128.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="freeradius.png"/></td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_c85d3e3c5052e9ad9ce18c6863244a25.html">lib</a></li><li class="navelem"><a class="el" href="dir_794c1bacd89d5c58c75c4338ddce4a3f.html">sim</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">comp128.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Implementations of comp128v1, comp128v2, comp128v3 algorithms.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;string.h&gt;</code><br />
<code>#include &lt;stdint.h&gt;</code><br />
<code>#include &lt;stdbool.h&gt;</code><br />
</div><div class="textblock"><div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="closed.png" alt="+"/> Include dependency graph for comp128.h:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="comp128_8h__incl.svg" width="266" height="142"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</div><div class="textblock"><div id="dynsection-1" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-1-trigger" src="closed.png" alt="+"/> This graph shows which files directly or indirectly include this file:</div>
<div id="dynsection-1-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-1-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="comp128_8h__dep__incl.svg" width="202" height="171"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</div>
<p><a href="comp128_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a35fa4083227dc609086c80b66d05950d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="comp128_8h.html#a35fa4083227dc609086c80b66d05950d">comp128v1</a> (uint8_t sres[static 4], uint8_t kc[static 8], uint8_t const ki[static 16], uint8_t const rand[static 16])</td></tr>
<tr class="memdesc:a35fa4083227dc609086c80b66d05950d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate comp128v1 sres and kc from ki and rand.  <a href="#a35fa4083227dc609086c80b66d05950d">More...</a><br /></td></tr>
<tr class="separator:a35fa4083227dc609086c80b66d05950d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5d4168028ccd505946cb69b67abdd297"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="comp128_8h.html#a5d4168028ccd505946cb69b67abdd297">comp128v23</a> (uint8_t sres[static 4], uint8_t kc[static 8], uint8_t const ki[static 16], uint8_t const rand[static 16], bool v2)</td></tr>
<tr class="memdesc:a5d4168028ccd505946cb69b67abdd297"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate comp128v2 or comp128v3 sres and kc from ki and rand.  <a href="#a5d4168028ccd505946cb69b67abdd297">More...</a><br /></td></tr>
<tr class="separator:a5d4168028ccd505946cb69b67abdd297"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Implementations of comp128v1, comp128v2, comp128v3 algorithms. </p>
<dl class="section rcs"><dt>Id</dt><dd>72c18b820b806aa608f9628de94195f5fc081ba4 </dd></dl>
<dl class="section note"><dt>Note</dt><dd>The above GPL license only applies to comp128v1, the license for comp128v2 and comp128v3 is unknown.</dd></dl>
<dl class="section copyright"><dt>Copyright</dt><dd>2013 The FreeRADIUS server project </dd>
<dd>
2013 Hacking projects [<a href="http://www.hackingprojects.net/">http://www.hackingprojects.net/</a>] </dd>
<dd>
2009 Sylvain Munaut (<a href="#" onclick="location.href='mai'+'lto:'+'tnt'+'@2'+'46t'+'Nt'+'.co'+'m'; return false;">tnt@2<span style="display: none;">.nosp@m.</span>46tN<span style="display: none;">.nosp@m.</span>t.com</a>) </dd></dl>

<p class="definition">Definition in file <a class="el" href="comp128_8h_source.html">comp128.h</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a35fa4083227dc609086c80b66d05950d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a35fa4083227dc609086c80b66d05950d">&#9670;&nbsp;</a></span>comp128v1()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void comp128v1 </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>sres</em>[static 4], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>kc</em>[static 8], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t const&#160;</td>
          <td class="paramname"><em>ki</em>[static 16], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t const&#160;</td>
          <td class="paramname"><em>rand</em>[static 16]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate comp128v1 sres and kc from ki and rand. </p>
<p>This code derived from a leaked document from the GSM standards. Some missing pieces were filled in by reverse-engineering a working SIM. We have verified that this is the correct COMP128 algorithm.</p>
<p>The first page of the document identifies it as <em>Technical Information: GSM System Security Study</em>. 10-1617-01, 10th June 1988. The bottom of the title page is marked Racal Research Ltd. Worton Drive, Worton Grange Industrial Estate, Reading, Berks. RG2 0SB, England. Telephone: Reading (0734) 868601 Telex: 847152 The relevant bits are in Part I, Section 20 (pages 66&ndash;67). Enjoy!</p>
<p>Note: There are three typos in the spec (discovered by reverse-engineering). First, "z = (2 * x[n] + x[n]) mod 2^(9-j)" should clearly read "z = (2 * x[m] + x[n]) mod 2^(9-j)". Second, the "k" loop in the "Form bits from bytes" section is severely botched: the k index should run only from 0 to 3, and clearly the range on "the (8-k)th bit of byte j" is also off (should be 0..7, not 1..8, to be consistent with the subsequent section). Third, SRES is taken from the first 8 nibbles of x[], not the last 8 as claimed in the document. (And the document doesn't specify how Kc is derived, but that was also easily discovered with reverse engineering.) All of these typos have been corrected in the following code.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">sres</td><td>4 byte value derived from ki and rand. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">kc</td><td>8 byte value derived from ki and rand. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ki</td><td>known only by the SIM and AuC (us in this case). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rand</td><td>16 bytes of randomness. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="comp128_8c_source.html#l00241">241</a> of file <a class="el" href="comp128_8c_source.html">comp128.c</a>.</p>
<div id="dynsection-2" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-2-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-2-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-2-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="comp128_8h_a35fa4083227dc609086c80b66d05950d_cgraph.svg" width="527" height="147"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a5d4168028ccd505946cb69b67abdd297"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5d4168028ccd505946cb69b67abdd297">&#9670;&nbsp;</a></span>comp128v23()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void comp128v23 </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>sres</em>[static 4], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>kc</em>[static 8], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t const&#160;</td>
          <td class="paramname"><em>ki</em>[static 16], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t const&#160;</td>
          <td class="paramname"><em>rand</em>[static 16], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>v2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate comp128v2 or comp128v3 sres and kc from ki and rand. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">sres</td><td>4 byte value derived from ki and rand. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">kc</td><td>8 byte value derived from ki and rand. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ki</td><td>known only by the SIM and AuC (us in this case). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rand</td><td>16 bytes of randomness. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">v2</td><td>if true we use version comp128-2 else we use comp128-3. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="comp128_8c_source.html#l00336">336</a> of file <a class="el" href="comp128_8c_source.html">comp128.c</a>.</p>
<div id="dynsection-3" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-3-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-3-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-3-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="comp128_8h_a5d4168028ccd505946cb69b67abdd297_cgraph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Thu Nov 12 2020 22:38:30 by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
