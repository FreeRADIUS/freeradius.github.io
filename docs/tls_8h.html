<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>/home/runner/work/freeradius-server/freeradius-server/src/lib/eap/tls.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="freeradius.png"/></td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_c85d3e3c5052e9ad9ce18c6863244a25.html">lib</a></li><li class="navelem"><a class="el" href="dir_d14787c6953e6f59b1408f4bc89aa4da.html">eap</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">tls.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Generic EAP over TLS API.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;stdio.h&gt;</code><br />
<code>#include &lt;stdlib.h&gt;</code><br />
<code>#include &lt;string.h&gt;</code><br />
<code>#include &lt;errno.h&gt;</code><br />
<code>#include &lt;sys/types.h&gt;</code><br />
<code>#include &lt;sys/socket.h&gt;</code><br />
<code>#include &lt;netinet/in.h&gt;</code><br />
<code>#include &lt;netinet/tcp.h&gt;</code><br />
<code>#include &lt;netdb.h&gt;</code><br />
<code>#include &lt;fcntl.h&gt;</code><br />
<code>#include &lt;<a class="el" href="signal_8h_source.html">signal.h</a>&gt;</code><br />
<code>#include &lt;ctype.h&gt;</code><br />
<code>#include &lt;sys/time.h&gt;</code><br />
<code>#include &lt;arpa/inet.h&gt;</code><br />
<code>#include &lt;freeradius-devel/server/base.h&gt;</code><br />
<code>#include &lt;freeradius-devel/tls/base.h&gt;</code><br />
<code>#include &lt;freeradius-devel/eap/base.h&gt;</code><br />
</div><div class="textblock"><div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="closed.png" alt="+"/> Include dependency graph for tls.h:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="tls_8h__incl.svg" width="100%" height="417"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</div><div class="textblock"><div id="dynsection-1" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-1-trigger" src="closed.png" alt="+"/> This graph shows which files directly or indirectly include this file:</div>
<div id="dynsection-1-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-1-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="tls_8h__dep__incl.svg" width="416" height="171"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</div>
<p><a href="tls_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:structeap__tls__data__t"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tls_8h.html#structeap__tls__data__t">eap_tls_data_t</a></td></tr>
<tr class="separator:structeap__tls__data__t"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:structeap__tls__session__t"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tls_8h.html#structeap__tls__session__t">eap_tls_session_t</a></td></tr>
<tr class="memdesc:structeap__tls__session__t"><td class="mdescLeft">&#160;</td><td class="mdescRight">Tracks the state of an EAP-TLS session.  <a href="tls_8h.html#structeap__tls__session__t">More...</a><br /></td></tr>
<tr class="separator:structeap__tls__session__t"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a47bd297b084ee15f02e42739b1b83c01"><td class="memItemLeft" align="right" valign="top">#<a class="el" href="build_8h.html#a0ec3f1f76900803ac4f041eb90b84a34">define</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tls_8h.html#a47bd297b084ee15f02e42739b1b83c01">SET_LENGTH_INCLUDED</a>(x)&#160;&#160;&#160;((x) | (0x80))</td></tr>
<tr class="separator:a47bd297b084ee15f02e42739b1b83c01"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae35542219fcc47c1896a8718dbf081ca"><td class="memItemLeft" align="right" valign="top">#<a class="el" href="build_8h.html#a0ec3f1f76900803ac4f041eb90b84a34">define</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tls_8h.html#ae35542219fcc47c1896a8718dbf081ca">SET_MORE_FRAGMENTS</a>(x)&#160;&#160;&#160;((x) | (0x40))</td></tr>
<tr class="separator:ae35542219fcc47c1896a8718dbf081ca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a40e4ba9356f01f06ca4fc695102142d2"><td class="memItemLeft" align="right" valign="top">#<a class="el" href="build_8h.html#a0ec3f1f76900803ac4f041eb90b84a34">define</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tls_8h.html#a40e4ba9356f01f06ca4fc695102142d2">SET_START</a>(x)&#160;&#160;&#160;((x) | (0x20))</td></tr>
<tr class="separator:a40e4ba9356f01f06ca4fc695102142d2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a66e8d182b0eb715396f6c1e473b7e462"><td class="memItemLeft" align="right" valign="top">#<a class="el" href="build_8h.html#a0ec3f1f76900803ac4f041eb90b84a34">define</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tls_8h.html#a66e8d182b0eb715396f6c1e473b7e462">TLS_ALERT</a>(x)&#160;&#160;&#160;(((x) &amp; 0x0015) == 0x0015)</td></tr>
<tr class="separator:a66e8d182b0eb715396f6c1e473b7e462"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa0706089ab57ebb9d602f8c4f5e91f36"><td class="memItemLeft" align="right" valign="top">#<a class="el" href="build_8h.html#a0ec3f1f76900803ac4f041eb90b84a34">define</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tls_8h.html#aa0706089ab57ebb9d602f8c4f5e91f36">TLS_CHANGE_CIPHER_SPEC</a>(x)&#160;&#160;&#160;(((x) &amp; 0x0014) == 0x0014)</td></tr>
<tr class="separator:aa0706089ab57ebb9d602f8c4f5e91f36"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aca0a2136d0896035a72f3a7edd49ca94"><td class="memItemLeft" align="right" valign="top">#<a class="el" href="build_8h.html#a0ec3f1f76900803ac4f041eb90b84a34">define</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tls_8h.html#aca0a2136d0896035a72f3a7edd49ca94">TLS_HANDSHAKE</a>(x)&#160;&#160;&#160;(((x) &amp; 0x0016) == 0x0016)</td></tr>
<tr class="separator:aca0a2136d0896035a72f3a7edd49ca94"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:addd430b7f976c676619ea03e5cf46fea"><td class="memItemLeft" align="right" valign="top">#<a class="el" href="build_8h.html#a0ec3f1f76900803ac4f041eb90b84a34">define</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tls_8h.html#addd430b7f976c676619ea03e5cf46fea">TLS_HEADER_LEN</a>&#160;&#160;&#160;4</td></tr>
<tr class="separator:addd430b7f976c676619ea03e5cf46fea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae1a9505bd575561c2b95e0fc36d226d2"><td class="memItemLeft" align="right" valign="top">#<a class="el" href="build_8h.html#a0ec3f1f76900803ac4f041eb90b84a34">define</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tls_8h.html#ae1a9505bd575561c2b95e0fc36d226d2">TLS_HEADER_LENGTH_FIELD_LEN</a>&#160;&#160;&#160;4</td></tr>
<tr class="separator:ae1a9505bd575561c2b95e0fc36d226d2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaedfb0be1511fd264f20071e6f0283b4"><td class="memItemLeft" align="right" valign="top">#<a class="el" href="build_8h.html#a0ec3f1f76900803ac4f041eb90b84a34">define</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tls_8h.html#aaedfb0be1511fd264f20071e6f0283b4">TLS_LENGTH_INCLUDED</a>(x)&#160;&#160;&#160;(((x) &amp; 0x80) != 0)</td></tr>
<tr class="separator:aaedfb0be1511fd264f20071e6f0283b4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a28e0af42fadbf85bc86b0faab0a59f41"><td class="memItemLeft" align="right" valign="top">#<a class="el" href="build_8h.html#a0ec3f1f76900803ac4f041eb90b84a34">define</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tls_8h.html#a28e0af42fadbf85bc86b0faab0a59f41">TLS_MORE_FRAGMENTS</a>(x)&#160;&#160;&#160;(((x) &amp; 0x40) != 0)</td></tr>
<tr class="separator:a28e0af42fadbf85bc86b0faab0a59f41"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa589d9461b565259eb884591f76c8bb5"><td class="memItemLeft" align="right" valign="top">#<a class="el" href="build_8h.html#a0ec3f1f76900803ac4f041eb90b84a34">define</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tls_8h.html#aa589d9461b565259eb884591f76c8bb5">TLS_RESERVED0</a>(x)&#160;&#160;&#160;(((x) &amp; 0x10) != 0)</td></tr>
<tr class="separator:aa589d9461b565259eb884591f76c8bb5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a194b58dcdc2ba9f559508c4285b0ac24"><td class="memItemLeft" align="right" valign="top">#<a class="el" href="build_8h.html#a0ec3f1f76900803ac4f041eb90b84a34">define</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tls_8h.html#a194b58dcdc2ba9f559508c4285b0ac24">TLS_RESERVED1</a>(x)&#160;&#160;&#160;(((x) &amp; 0x08) != 0)</td></tr>
<tr class="separator:a194b58dcdc2ba9f559508c4285b0ac24"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab2fbbbeb0a184429bbec69b0bd1a1e8f"><td class="memItemLeft" align="right" valign="top">#<a class="el" href="build_8h.html#a0ec3f1f76900803ac4f041eb90b84a34">define</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tls_8h.html#ab2fbbbeb0a184429bbec69b0bd1a1e8f">TLS_RESERVED2</a>(x)&#160;&#160;&#160;(((x) &amp; 0x04) != 0)</td></tr>
<tr class="separator:ab2fbbbeb0a184429bbec69b0bd1a1e8f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a44d8fbd0ab6d28de0db37be2f85c7cdc"><td class="memItemLeft" align="right" valign="top">#<a class="el" href="build_8h.html#a0ec3f1f76900803ac4f041eb90b84a34">define</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tls_8h.html#a44d8fbd0ab6d28de0db37be2f85c7cdc">TLS_RESERVED3</a>(x)&#160;&#160;&#160;(((x) &amp; 0x02) != 0)</td></tr>
<tr class="separator:a44d8fbd0ab6d28de0db37be2f85c7cdc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acf4bfda0383986a7152e291982973c8e"><td class="memItemLeft" align="right" valign="top">#<a class="el" href="build_8h.html#a0ec3f1f76900803ac4f041eb90b84a34">define</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tls_8h.html#acf4bfda0383986a7152e291982973c8e">TLS_RESERVED4</a>(x)&#160;&#160;&#160;(((x) &amp; 0x01) != 0)</td></tr>
<tr class="separator:acf4bfda0383986a7152e291982973c8e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4c8f1cc9bc68125e2158b449de36baca"><td class="memItemLeft" align="right" valign="top">#<a class="el" href="build_8h.html#a0ec3f1f76900803ac4f041eb90b84a34">define</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tls_8h.html#a4c8f1cc9bc68125e2158b449de36baca">TLS_START</a>(x)&#160;&#160;&#160;(((x) &amp; 0x20) != 0)</td></tr>
<tr class="separator:a4c8f1cc9bc68125e2158b449de36baca"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:a2482e2bf7d2331807f586763386cb12e"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tls_8h.html#a2482e2bf7d2331807f586763386cb12e">eap_tls_status_t</a> { <br />
&#160;&#160;<a class="el" href="tls_8h.html#a2482e2bf7d2331807f586763386cb12ea39784fa8e7305102c83708f3183aa07d">EAP_TLS_INVALID</a> = 0, 
<br />
&#160;&#160;<a class="el" href="tls_8h.html#a2482e2bf7d2331807f586763386cb12eae82dc8452aa75cd26f01eea920f63713">EAP_TLS_ESTABLISHED</a>, 
<br />
&#160;&#160;<a class="el" href="tls_8h.html#a2482e2bf7d2331807f586763386cb12ead7fbf2f1f7e5b0355565194bdd2f8bcb">EAP_TLS_FAIL</a>, 
<br />
&#160;&#160;<a class="el" href="tls_8h.html#a2482e2bf7d2331807f586763386cb12ea3db0f4c21bdc0caec8872d72ebb915d0">EAP_TLS_HANDLED</a>, 
<br />
&#160;&#160;<a class="el" href="tls_8h.html#a2482e2bf7d2331807f586763386cb12eab5b3dcd7c3e2188c14971bf262e2eb2b">EAP_TLS_START_SEND</a>, 
<br />
&#160;&#160;<a class="el" href="tls_8h.html#a2482e2bf7d2331807f586763386cb12ea73ca6a0612687dfa380d9b73aa39278c">EAP_TLS_RECORD_SEND</a>, 
<br />
&#160;&#160;<a class="el" href="tls_8h.html#a2482e2bf7d2331807f586763386cb12ea6794bd6bcbd27745e1b02e55f6f473b5">EAP_TLS_ACK_SEND</a>, 
<br />
&#160;&#160;<a class="el" href="tls_8h.html#a2482e2bf7d2331807f586763386cb12ea1fc2b015da94cd9af63a9bca668d4d55">EAP_TLS_RECORD_RECV_FIRST</a>, 
<br />
&#160;&#160;<a class="el" href="tls_8h.html#a2482e2bf7d2331807f586763386cb12ea4b55266191e0c623429d533c89f42665">EAP_TLS_RECORD_RECV_MORE</a>, 
<br />
&#160;&#160;<a class="el" href="tls_8h.html#a2482e2bf7d2331807f586763386cb12ea8c89313b84d28b0a7f369d2e3842a1fc">EAP_TLS_RECORD_RECV_COMPLETE</a>
<br />
 }</td></tr>
<tr class="separator:a2482e2bf7d2331807f586763386cb12e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a584eb5a16a56a0554858c2130965a255"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tls_8h.html#a584eb5a16a56a0554858c2130965a255">eap_crypto_mppe_keys</a> (<a class="el" href="radclient_8c.html#a2fc1b64f51f8225195d32592e6fe8fc5">request_t</a> *request, SSL *ssl, char const *prf_label, size_t prf_label_len)</td></tr>
<tr class="memdesc:a584eb5a16a56a0554858c2130965a255"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generate keys according to RFC 2716 and add to the reply.  <a href="#a584eb5a16a56a0554858c2130965a255">More...</a><br /></td></tr>
<tr class="separator:a584eb5a16a56a0554858c2130965a255"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a651a0ab926e5013ce46d88d5b0030672"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tls_8h.html#a651a0ab926e5013ce46d88d5b0030672">eap_crypto_tls_session_id</a> (TALLOC_CTX *ctx, <a class="el" href="radclient_8c.html#a2fc1b64f51f8225195d32592e6fe8fc5">request_t</a> *request, SSL *ssl, uint8_t **<a class="el" href="value_8h.html#af17d2d4e72bd60de680d3f4a29a1275f">out</a>, uint8_t eap_type, char const *prf_label, size_t prf_label_len)</td></tr>
<tr class="separator:a651a0ab926e5013ce46d88d5b0030672"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6249e352898859663be29f75b1e829a7"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tls_8h.html#a6249e352898859663be29f75b1e829a7">eap_tls_compose</a> (<a class="el" href="radclient_8c.html#a2fc1b64f51f8225195d32592e6fe8fc5">request_t</a> *request, <a class="el" href="session_8h.html#a772e0f06abb52a90a255b6b0d9724fe7">eap_session_t</a> *eap_session, <a class="el" href="tls_8h.html#a2482e2bf7d2331807f586763386cb12e">eap_tls_status_t</a> status, uint8_t flags, fr_tls_record_t *record, size_t record_len, size_t frag_len)</td></tr>
<tr class="memdesc:a6249e352898859663be29f75b1e829a7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Convert the EAP-TLS reply packet into an EAP packet.  <a href="#a6249e352898859663be29f75b1e829a7">More...</a><br /></td></tr>
<tr class="separator:a6249e352898859663be29f75b1e829a7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa14aeb21ae4ac981b6afcec0c95a2095"><td class="memItemLeft" align="right" valign="top">fr_tls_conf_t *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tls_8h.html#aa14aeb21ae4ac981b6afcec0c95a2095">eap_tls_conf_parse</a> (<a class="el" href="cf__util_8h.html#a0f39d8043920472ea4c687c97f7173b3">CONF_SECTION</a> *cs, char const *key)</td></tr>
<tr class="memdesc:aa14aeb21ae4ac981b6afcec0c95a2095"><td class="mdescLeft">&#160;</td><td class="mdescRight">Parse TLS configuration.  <a href="#aa14aeb21ae4ac981b6afcec0c95a2095">More...</a><br /></td></tr>
<tr class="separator:aa14aeb21ae4ac981b6afcec0c95a2095"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a97b48775a94a972992a883fd82947290"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tls_8h.html#a97b48775a94a972992a883fd82947290">eap_tls_fail</a> (<a class="el" href="radclient_8c.html#a2fc1b64f51f8225195d32592e6fe8fc5">request_t</a> *request, <a class="el" href="session_8h.html#a772e0f06abb52a90a255b6b0d9724fe7">eap_session_t</a> *eap_session)</td></tr>
<tr class="memdesc:a97b48775a94a972992a883fd82947290"><td class="mdescLeft">&#160;</td><td class="mdescRight">Send an EAP-TLS failure.  <a href="#a97b48775a94a972992a883fd82947290">More...</a><br /></td></tr>
<tr class="separator:a97b48775a94a972992a883fd82947290"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a27e244d3f33734be5a788ab610528e06"><td class="memItemLeft" align="right" valign="top"><a class="el" href="tls_8h.html#a2482e2bf7d2331807f586763386cb12e">eap_tls_status_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tls_8h.html#a27e244d3f33734be5a788ab610528e06">eap_tls_process</a> (<a class="el" href="radclient_8c.html#a2fc1b64f51f8225195d32592e6fe8fc5">request_t</a> *request, <a class="el" href="session_8h.html#a772e0f06abb52a90a255b6b0d9724fe7">eap_session_t</a> *eap_session)</td></tr>
<tr class="memdesc:a27e244d3f33734be5a788ab610528e06"><td class="mdescLeft">&#160;</td><td class="mdescRight">Process an EAP TLS request.  <a href="#a27e244d3f33734be5a788ab610528e06">More...</a><br /></td></tr>
<tr class="separator:a27e244d3f33734be5a788ab610528e06"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a94d9f18de6fa10711657a0f9d4d103cb"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tls_8h.html#a94d9f18de6fa10711657a0f9d4d103cb">eap_tls_request</a> (<a class="el" href="radclient_8c.html#a2fc1b64f51f8225195d32592e6fe8fc5">request_t</a> *request, <a class="el" href="session_8h.html#a772e0f06abb52a90a255b6b0d9724fe7">eap_session_t</a> *eap_session)</td></tr>
<tr class="memdesc:a94d9f18de6fa10711657a0f9d4d103cb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Frames the OpenSSL data that needs to be sent to the client in an EAP-Request.  <a href="#a94d9f18de6fa10711657a0f9d4d103cb">More...</a><br /></td></tr>
<tr class="separator:a94d9f18de6fa10711657a0f9d4d103cb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad8d9a6b0edd299041c70c2f0574b15b4"><td class="memItemLeft" align="right" valign="top"><a class="el" href="tls_8h.html#structeap__tls__session__t">eap_tls_session_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tls_8h.html#ad8d9a6b0edd299041c70c2f0574b15b4">eap_tls_session_init</a> (<a class="el" href="radclient_8c.html#a2fc1b64f51f8225195d32592e6fe8fc5">request_t</a> *request, <a class="el" href="session_8h.html#a772e0f06abb52a90a255b6b0d9724fe7">eap_session_t</a> *eap_session, fr_tls_conf_t *tls_conf, bool client_cert)</td></tr>
<tr class="memdesc:ad8d9a6b0edd299041c70c2f0574b15b4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create a new fr_tls_session_t associated with an <a class="el" href="session_8h.html#a772e0f06abb52a90a255b6b0d9724fe7">eap_session_t</a>.  <a href="#ad8d9a6b0edd299041c70c2f0574b15b4">More...</a><br /></td></tr>
<tr class="separator:ad8d9a6b0edd299041c70c2f0574b15b4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a92b2882222297ba5cb85329be7ebb2ea"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tls_8h.html#a92b2882222297ba5cb85329be7ebb2ea">eap_tls_start</a> (<a class="el" href="radclient_8c.html#a2fc1b64f51f8225195d32592e6fe8fc5">request_t</a> *request, <a class="el" href="session_8h.html#a772e0f06abb52a90a255b6b0d9724fe7">eap_session_t</a> *eap_session)</td></tr>
<tr class="memdesc:a92b2882222297ba5cb85329be7ebb2ea"><td class="mdescLeft">&#160;</td><td class="mdescRight">Send an initial EAP-TLS request to the peer.  <a href="#a92b2882222297ba5cb85329be7ebb2ea">More...</a><br /></td></tr>
<tr class="separator:a92b2882222297ba5cb85329be7ebb2ea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acaf3efd415b5f2a7fccfbcc9f7235254"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tls_8h.html#acaf3efd415b5f2a7fccfbcc9f7235254">eap_tls_success</a> (<a class="el" href="radclient_8c.html#a2fc1b64f51f8225195d32592e6fe8fc5">request_t</a> *request, <a class="el" href="session_8h.html#a772e0f06abb52a90a255b6b0d9724fe7">eap_session_t</a> *eap_session, char const *keying_prf_label, size_t keying_prf_label_len, char const *sessid_prf_label, size_t sessid_prf_label_len))</td></tr>
<tr class="memdesc:acaf3efd415b5f2a7fccfbcc9f7235254"><td class="mdescLeft">&#160;</td><td class="mdescRight">Send an EAP-TLS success.  <a href="#acaf3efd415b5f2a7fccfbcc9f7235254">More...</a><br /></td></tr>
<tr class="separator:acaf3efd415b5f2a7fccfbcc9f7235254"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a6d6a114ba908303049edb167870c81a6"><td class="memItemLeft" align="right" valign="top"><a class="el" href="table_8h.html#structfr__table__num__ordered__t">fr_table_num_ordered_t</a> const&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tls_8h.html#a6d6a114ba908303049edb167870c81a6">eap_tls_status_table</a> []</td></tr>
<tr class="separator:a6d6a114ba908303049edb167870c81a6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a76915fb753f22f60c92cf61e9b267bd5"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tls_8h.html#a76915fb753f22f60c92cf61e9b267bd5">eap_tls_status_table_len</a></td></tr>
<tr class="separator:a76915fb753f22f60c92cf61e9b267bd5"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Generic EAP over TLS API. </p>
<dl class="section rcs"><dt>Id</dt><dd>3d9f2bd6ce17f79f685845523d6160a09c7f8281 </dd></dl>
<dl class="section copyright"><dt>Copyright</dt><dd>2001 hereUare Communications, Inc. (<a href="#" onclick="location.href='mai'+'lto:'+'rag'+'hu'+'d@h'+'er'+'eua'+'re'+'.co'+'m'; return false;">raghu<span style="display: none;">.nosp@m.</span>d@he<span style="display: none;">.nosp@m.</span>reuar<span style="display: none;">.nosp@m.</span>e.co<span style="display: none;">.nosp@m.</span>m</a>) </dd>
<dd>
2003 Alan DeKok (<a href="#" onclick="location.href='mai'+'lto:'+'ala'+'nd'+'@fr'+'ee'+'rad'+'iu'+'s.o'+'rg'; return false;">aland<span style="display: none;">.nosp@m.</span>@fre<span style="display: none;">.nosp@m.</span>eradi<span style="display: none;">.nosp@m.</span>us.o<span style="display: none;">.nosp@m.</span>rg</a>) </dd>
<dd>
2006 The FreeRADIUS server project </dd></dl>

<p class="definition">Definition in file <a class="el" href="tls_8h_source.html">tls.h</a>.</p>
</div><hr/><h2 class="groupheader">Data Structure Documentation</h2>
<a name="structeap__tls__data__t" id="structeap__tls__data__t"></a>
<h2 class="memtitle"><span class="permalink"><a href="#structeap__tls__data__t">&#9670;&nbsp;</a></span>eap_tls_data_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct eap_tls_data_t</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="textblock">
<p class="definition">Definition at line <a class="el" href="tls_8h_source.html#l00114">114</a> of file <a class="el" href="tls_8h_source.html">tls.h</a>.</p>
</div><table class="fieldtable">
<tr><th colspan="3">Data Fields</th></tr>
<tr><td class="fieldtype">
<a id="aaeadc014b13b2d3c0915ad22a8ed599d"></a>uint8_t</td>
<td class="fieldname">
data[1]</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a489cf6379d62b4600a16e49c66e62978"></a>uint8_t</td>
<td class="fieldname">
flags</td>
<td class="fielddoc">
</td></tr>
</table>

</div>
</div>
<a name="structeap__tls__session__t" id="structeap__tls__session__t"></a>
<h2 class="memtitle"><span class="permalink"><a href="#structeap__tls__session__t">&#9670;&nbsp;</a></span>eap_tls_session_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct eap_tls_session_t</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="textblock"><p>Tracks the state of an EAP-TLS session. </p>
<p>Contains any EAP-TLS specific state information, such as whether we're sending/receiving fragments, and the progress of those operations.</p>
<p>TLS session state is stored in a fr_tls_session_t accessed via the tls_session field. </p>

<p class="definition">Definition at line <a class="el" href="tls_8h_source.html#l00126">126</a> of file <a class="el" href="tls_8h_source.html">tls.h</a>.</p>
</div><table class="fieldtable">
<tr><th colspan="3">Data Fields</th></tr>
<tr><td class="fieldtype">
<a id="a06c5b10c2ecb65428ca2d0b88487aa09"></a>int</td>
<td class="fieldname">
base_flags</td>
<td class="fielddoc">
Some protocols use the reserved bits of the EAP-TLS flags (such as PEAP). <p>This allows the base flags to be set. </p>
</td></tr>
<tr><td class="fieldtype">
<a id="af92e4638de364aad07df33ee6245d6f3"></a>bool</td>
<td class="fieldname">
include_length</td>
<td class="fielddoc">
A flag to include length in every TLS Data/Alert packet. <p>If set to no then only the first fragment contains length. </p>
</td></tr>
<tr><td class="fieldtype">
<a id="a166153c4d7581c294c28556ac08a601b"></a>bool</td>
<td class="fieldname">
phase2</td>
<td class="fielddoc">
Whether we're in phase 2. </td></tr>
<tr><td class="fieldtype">
<a id="aacf381768437180b70bbd87bdfc61bf2"></a>size_t</td>
<td class="fieldname">
record_in_recvd_len</td>
<td class="fielddoc">
How much of the record we've received so far. </td></tr>
<tr><td class="fieldtype">
<a id="a3f308b9c6617afe178c118bb1c8ffcca"></a>bool</td>
<td class="fieldname">
record_in_started</td>
<td class="fielddoc">
Whether a record transfer from the peer is currently in progress. </td></tr>
<tr><td class="fieldtype">
<a id="a74161d28baec09d0e2a84b23ec9b49cc"></a>size_t</td>
<td class="fieldname">
record_in_total_len</td>
<td class="fielddoc">
How long the peer indicated the complete tls record would be. </td></tr>
<tr><td class="fieldtype">
<a id="aa7428ad1533176f145c2de200b36748d"></a>bool</td>
<td class="fieldname">
record_out_started</td>
<td class="fielddoc">
Whether a record transfer to the peer is currently in progress. </td></tr>
<tr><td class="fieldtype">
<a id="a40213313680810afc687fa3628817bb5"></a>size_t</td>
<td class="fieldname">
record_out_total_len</td>
<td class="fielddoc">
Actual/Total TLS message length we're sending. </td></tr>
<tr><td class="fieldtype">
<a id="a1091e971183b8ec6d1df634ca0c44f27"></a><a class="el" href="tls_8h.html#a2482e2bf7d2331807f586763386cb12e">eap_tls_status_t</a></td>
<td class="fieldname">
state</td>
<td class="fielddoc">
The state of the EAP-TLS session. </td></tr>
<tr><td class="fieldtype">
<a id="a368e15fb7cabcf6b370c96e8b48faf04"></a>fr_tls_session_t *</td>
<td class="fieldname">
tls_session</td>
<td class="fielddoc">
TLS session used to authenticate peer. <p>or tunnel sensitive data. </p>
</td></tr>
</table>

</div>
</div>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a47bd297b084ee15f02e42739b1b83c01"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a47bd297b084ee15f02e42739b1b83c01">&#9670;&nbsp;</a></span>SET_LENGTH_INCLUDED</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#<a class="el" href="build_8h.html#a0ec3f1f76900803ac4f041eb90b84a34">define</a> SET_LENGTH_INCLUDED</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">x</td><td>)</td>
          <td>&#160;&#160;&#160;((x) | (0x80))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="tls_8h_source.html#l00088">88</a> of file <a class="el" href="tls_8h_source.html">tls.h</a>.</p>

</div>
</div>
<a id="ae35542219fcc47c1896a8718dbf081ca"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae35542219fcc47c1896a8718dbf081ca">&#9670;&nbsp;</a></span>SET_MORE_FRAGMENTS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#<a class="el" href="build_8h.html#a0ec3f1f76900803ac4f041eb90b84a34">define</a> SET_MORE_FRAGMENTS</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">x</td><td>)</td>
          <td>&#160;&#160;&#160;((x) | (0x40))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="tls_8h_source.html#l00087">87</a> of file <a class="el" href="tls_8h_source.html">tls.h</a>.</p>

</div>
</div>
<a id="a40e4ba9356f01f06ca4fc695102142d2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a40e4ba9356f01f06ca4fc695102142d2">&#9670;&nbsp;</a></span>SET_START</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#<a class="el" href="build_8h.html#a0ec3f1f76900803ac4f041eb90b84a34">define</a> SET_START</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">x</td><td>)</td>
          <td>&#160;&#160;&#160;((x) | (0x20))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="tls_8h_source.html#l00086">86</a> of file <a class="el" href="tls_8h_source.html">tls.h</a>.</p>

</div>
</div>
<a id="a66e8d182b0eb715396f6c1e473b7e462"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a66e8d182b0eb715396f6c1e473b7e462">&#9670;&nbsp;</a></span>TLS_ALERT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#<a class="el" href="build_8h.html#a0ec3f1f76900803ac4f041eb90b84a34">define</a> TLS_ALERT</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">x</td><td>)</td>
          <td>&#160;&#160;&#160;(((x) &amp; 0x0015) == 0x0015)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="tls_8h_source.html#l00083">83</a> of file <a class="el" href="tls_8h_source.html">tls.h</a>.</p>

</div>
</div>
<a id="aa0706089ab57ebb9d602f8c4f5e91f36"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa0706089ab57ebb9d602f8c4f5e91f36">&#9670;&nbsp;</a></span>TLS_CHANGE_CIPHER_SPEC</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#<a class="el" href="build_8h.html#a0ec3f1f76900803ac4f041eb90b84a34">define</a> TLS_CHANGE_CIPHER_SPEC</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">x</td><td>)</td>
          <td>&#160;&#160;&#160;(((x) &amp; 0x0014) == 0x0014)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="tls_8h_source.html#l00082">82</a> of file <a class="el" href="tls_8h_source.html">tls.h</a>.</p>

</div>
</div>
<a id="aca0a2136d0896035a72f3a7edd49ca94"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aca0a2136d0896035a72f3a7edd49ca94">&#9670;&nbsp;</a></span>TLS_HANDSHAKE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#<a class="el" href="build_8h.html#a0ec3f1f76900803ac4f041eb90b84a34">define</a> TLS_HANDSHAKE</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">x</td><td>)</td>
          <td>&#160;&#160;&#160;(((x) &amp; 0x0016) == 0x0016)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="tls_8h_source.html#l00084">84</a> of file <a class="el" href="tls_8h_source.html">tls.h</a>.</p>

</div>
</div>
<a id="addd430b7f976c676619ea03e5cf46fea"></a>
<h2 class="memtitle"><span class="permalink"><a href="#addd430b7f976c676619ea03e5cf46fea">&#9670;&nbsp;</a></span>TLS_HEADER_LEN</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#<a class="el" href="build_8h.html#a0ec3f1f76900803ac4f041eb90b84a34">define</a> TLS_HEADER_LEN&#160;&#160;&#160;4</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="tls_8h_source.html#l00055">55</a> of file <a class="el" href="tls_8h_source.html">tls.h</a>.</p>

</div>
</div>
<a id="ae1a9505bd575561c2b95e0fc36d226d2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae1a9505bd575561c2b95e0fc36d226d2">&#9670;&nbsp;</a></span>TLS_HEADER_LENGTH_FIELD_LEN</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#<a class="el" href="build_8h.html#a0ec3f1f76900803ac4f041eb90b84a34">define</a> TLS_HEADER_LENGTH_FIELD_LEN&#160;&#160;&#160;4</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="tls_8h_source.html#l00056">56</a> of file <a class="el" href="tls_8h_source.html">tls.h</a>.</p>

</div>
</div>
<a id="aaedfb0be1511fd264f20071e6f0283b4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaedfb0be1511fd264f20071e6f0283b4">&#9670;&nbsp;</a></span>TLS_LENGTH_INCLUDED</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#<a class="el" href="build_8h.html#a0ec3f1f76900803ac4f041eb90b84a34">define</a> TLS_LENGTH_INCLUDED</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">x</td><td>)</td>
          <td>&#160;&#160;&#160;(((x) &amp; 0x80) != 0)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="tls_8h_source.html#l00080">80</a> of file <a class="el" href="tls_8h_source.html">tls.h</a>.</p>

</div>
</div>
<a id="a28e0af42fadbf85bc86b0faab0a59f41"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a28e0af42fadbf85bc86b0faab0a59f41">&#9670;&nbsp;</a></span>TLS_MORE_FRAGMENTS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#<a class="el" href="build_8h.html#a0ec3f1f76900803ac4f041eb90b84a34">define</a> TLS_MORE_FRAGMENTS</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">x</td><td>)</td>
          <td>&#160;&#160;&#160;(((x) &amp; 0x40) != 0)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="tls_8h_source.html#l00079">79</a> of file <a class="el" href="tls_8h_source.html">tls.h</a>.</p>

</div>
</div>
<a id="aa589d9461b565259eb884591f76c8bb5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa589d9461b565259eb884591f76c8bb5">&#9670;&nbsp;</a></span>TLS_RESERVED0</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#<a class="el" href="build_8h.html#a0ec3f1f76900803ac4f041eb90b84a34">define</a> TLS_RESERVED0</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">x</td><td>)</td>
          <td>&#160;&#160;&#160;(((x) &amp; 0x10) != 0)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="tls_8h_source.html#l00077">77</a> of file <a class="el" href="tls_8h_source.html">tls.h</a>.</p>

</div>
</div>
<a id="a194b58dcdc2ba9f559508c4285b0ac24"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a194b58dcdc2ba9f559508c4285b0ac24">&#9670;&nbsp;</a></span>TLS_RESERVED1</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#<a class="el" href="build_8h.html#a0ec3f1f76900803ac4f041eb90b84a34">define</a> TLS_RESERVED1</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">x</td><td>)</td>
          <td>&#160;&#160;&#160;(((x) &amp; 0x08) != 0)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="tls_8h_source.html#l00076">76</a> of file <a class="el" href="tls_8h_source.html">tls.h</a>.</p>

</div>
</div>
<a id="ab2fbbbeb0a184429bbec69b0bd1a1e8f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab2fbbbeb0a184429bbec69b0bd1a1e8f">&#9670;&nbsp;</a></span>TLS_RESERVED2</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#<a class="el" href="build_8h.html#a0ec3f1f76900803ac4f041eb90b84a34">define</a> TLS_RESERVED2</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">x</td><td>)</td>
          <td>&#160;&#160;&#160;(((x) &amp; 0x04) != 0)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="tls_8h_source.html#l00075">75</a> of file <a class="el" href="tls_8h_source.html">tls.h</a>.</p>

</div>
</div>
<a id="a44d8fbd0ab6d28de0db37be2f85c7cdc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a44d8fbd0ab6d28de0db37be2f85c7cdc">&#9670;&nbsp;</a></span>TLS_RESERVED3</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#<a class="el" href="build_8h.html#a0ec3f1f76900803ac4f041eb90b84a34">define</a> TLS_RESERVED3</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">x</td><td>)</td>
          <td>&#160;&#160;&#160;(((x) &amp; 0x02) != 0)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="tls_8h_source.html#l00074">74</a> of file <a class="el" href="tls_8h_source.html">tls.h</a>.</p>

</div>
</div>
<a id="acf4bfda0383986a7152e291982973c8e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acf4bfda0383986a7152e291982973c8e">&#9670;&nbsp;</a></span>TLS_RESERVED4</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#<a class="el" href="build_8h.html#a0ec3f1f76900803ac4f041eb90b84a34">define</a> TLS_RESERVED4</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">x</td><td>)</td>
          <td>&#160;&#160;&#160;(((x) &amp; 0x01) != 0)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="tls_8h_source.html#l00073">73</a> of file <a class="el" href="tls_8h_source.html">tls.h</a>.</p>

</div>
</div>
<a id="a4c8f1cc9bc68125e2158b449de36baca"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4c8f1cc9bc68125e2158b449de36baca">&#9670;&nbsp;</a></span>TLS_START</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#<a class="el" href="build_8h.html#a0ec3f1f76900803ac4f041eb90b84a34">define</a> TLS_START</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">x</td><td>)</td>
          <td>&#160;&#160;&#160;(((x) &amp; 0x20) != 0)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="tls_8h_source.html#l00078">78</a> of file <a class="el" href="tls_8h_source.html">tls.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Enumeration Type Documentation</h2>
<a id="a2482e2bf7d2331807f586763386cb12e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2482e2bf7d2331807f586763386cb12e">&#9670;&nbsp;</a></span>eap_tls_status_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="tls_8h.html#a2482e2bf7d2331807f586763386cb12e">eap_tls_status_t</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="a2482e2bf7d2331807f586763386cb12ea39784fa8e7305102c83708f3183aa07d"></a>EAP_TLS_INVALID&#160;</td><td class="fielddoc"><p>Invalid, don't reply. </p>
</td></tr>
<tr><td class="fieldname"><a id="a2482e2bf7d2331807f586763386cb12eae82dc8452aa75cd26f01eea920f63713"></a>EAP_TLS_ESTABLISHED&#160;</td><td class="fielddoc"><p>Session established, send success (or start phase2). </p>
</td></tr>
<tr><td class="fieldname"><a id="a2482e2bf7d2331807f586763386cb12ead7fbf2f1f7e5b0355565194bdd2f8bcb"></a>EAP_TLS_FAIL&#160;</td><td class="fielddoc"><p>Fail, send fail. </p>
</td></tr>
<tr><td class="fieldname"><a id="a2482e2bf7d2331807f586763386cb12ea3db0f4c21bdc0caec8872d72ebb915d0"></a>EAP_TLS_HANDLED&#160;</td><td class="fielddoc"><p>TLS code has handled it. </p>
</td></tr>
<tr><td class="fieldname"><a id="a2482e2bf7d2331807f586763386cb12eab5b3dcd7c3e2188c14971bf262e2eb2b"></a>EAP_TLS_START_SEND&#160;</td><td class="fielddoc"><p>We're starting a new TLS session. </p>
</td></tr>
<tr><td class="fieldname"><a id="a2482e2bf7d2331807f586763386cb12ea73ca6a0612687dfa380d9b73aa39278c"></a>EAP_TLS_RECORD_SEND&#160;</td><td class="fielddoc"><p>We're sending a record. </p>
</td></tr>
<tr><td class="fieldname"><a id="a2482e2bf7d2331807f586763386cb12ea6794bd6bcbd27745e1b02e55f6f473b5"></a>EAP_TLS_ACK_SEND&#160;</td><td class="fielddoc"><p>Acknowledge receipt of a record or record fragment. </p>
</td></tr>
<tr><td class="fieldname"><a id="a2482e2bf7d2331807f586763386cb12ea1fc2b015da94cd9af63a9bca668d4d55"></a>EAP_TLS_RECORD_RECV_FIRST&#160;</td><td class="fielddoc"><p>Received first fragment of a record. </p>
</td></tr>
<tr><td class="fieldname"><a id="a2482e2bf7d2331807f586763386cb12ea4b55266191e0c623429d533c89f42665"></a>EAP_TLS_RECORD_RECV_MORE&#160;</td><td class="fielddoc"><p>Received additional fragment of a record. </p>
</td></tr>
<tr><td class="fieldname"><a id="a2482e2bf7d2331807f586763386cb12ea8c89313b84d28b0a7f369d2e3842a1fc"></a>EAP_TLS_RECORD_RECV_COMPLETE&#160;</td><td class="fielddoc"><p>Received final fragment of a record. </p>
</td></tr>
</table>

<p class="definition">Definition at line <a class="el" href="tls_8h_source.html#l00090">90</a> of file <a class="el" href="tls_8h_source.html">tls.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a584eb5a16a56a0554858c2130965a255"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a584eb5a16a56a0554858c2130965a255">&#9670;&nbsp;</a></span>eap_crypto_mppe_keys()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int eap_crypto_mppe_keys </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="radclient_8c.html#a2fc1b64f51f8225195d32592e6fe8fc5">request_t</a> *&#160;</td>
          <td class="paramname"><em>request</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SSL *&#160;</td>
          <td class="paramname"><em>ssl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char const *&#160;</td>
          <td class="paramname"><em>prf_label</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>prf_label_len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Generate keys according to RFC 2716 and add to the reply. </p>

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00050">50</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>
<div id="dynsection-2" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-2-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-2-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-2-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="tls_8h_a584eb5a16a56a0554858c2130965a255_cgraph.svg" width="100%" height="480"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>

</div>
</div>
<a id="a651a0ab926e5013ce46d88d5b0030672"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a651a0ab926e5013ce46d88d5b0030672">&#9670;&nbsp;</a></span>eap_crypto_tls_session_id()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int eap_crypto_tls_session_id </td>
          <td>(</td>
          <td class="paramtype">TALLOC_CTX *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="radclient_8c.html#a2fc1b64f51f8225195d32592e6fe8fc5">request_t</a> *&#160;</td>
          <td class="paramname"><em>request</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SSL *&#160;</td>
          <td class="paramname"><em>ssl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t **&#160;</td>
          <td class="paramname"><em>out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>eap_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char const *&#160;</td>
          <td class="paramname"><em>prf_label</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>prf_label_len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a6249e352898859663be29f75b1e829a7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6249e352898859663be29f75b1e829a7">&#9670;&nbsp;</a></span>eap_tls_compose()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int eap_tls_compose </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="radclient_8c.html#a2fc1b64f51f8225195d32592e6fe8fc5">request_t</a> *&#160;</td>
          <td class="paramname"><em>request</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="session_8h.html#a772e0f06abb52a90a255b6b0d9724fe7">eap_session_t</a> *&#160;</td>
          <td class="paramname"><em>eap_session</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="tls_8h.html#a2482e2bf7d2331807f586763386cb12e">eap_tls_status_t</a>&#160;</td>
          <td class="paramname"><em>status</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>flags</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">fr_tls_record_t *&#160;</td>
          <td class="paramname"><em>record</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>record_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>frag_len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Convert the EAP-TLS reply packet into an EAP packet. </p>
<p>The EAP packet will be written to eap_round-&gt;request, with the original reply being untouched.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">request</td><td>The current subrequest. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">eap_session</td><td>to continue. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">status</td><td>What type of packet we're sending. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">flags</td><td>to set. This is checked to determine if we need to include a length field. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">record</td><td>The record buffer to read from. This most only be set for EAP_TLS_RECORD_SEND packets. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">record_len</td><td>the length of the record we're sending. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">frag_len</td><td>the length of the fragment we're sending. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><ul>
<li>0 on success.</li>
<li>-1 on failure. </li>
</ul>
</dd></dl>

<p class="definition">Definition at line <a class="el" href="tls_8c_source.html#l00111">111</a> of file <a class="el" href="tls_8c_source.html">tls.c</a>.</p>

</div>
</div>
<a id="aa14aeb21ae4ac981b6afcec0c95a2095"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa14aeb21ae4ac981b6afcec0c95a2095">&#9670;&nbsp;</a></span>eap_tls_conf_parse()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">fr_tls_conf_t* eap_tls_conf_parse </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="cf__util_8h.html#a0f39d8043920472ea4c687c97f7173b3">CONF_SECTION</a> *&#160;</td>
          <td class="paramname"><em>cs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char const *&#160;</td>
          <td class="paramname"><em>attr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Parse TLS configuration. </p>
<p>If the option given by 'attr' is set, we find the config section of that name and use that for the TLS configuration. If not, we fall back to compatibility mode and read the TLS options from the 'tls' section.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cs</td><td>to derive the configuration from. </td></tr>
    <tr><td class="paramname">attr</td><td>identifier for common TLS configuration. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><ul>
<li>NULL on error.</li>
<li>A new fr_tls_conf_t on success. </li>
</ul>
</dd></dl>

<p class="definition">Definition at line <a class="el" href="tls_8c_source.html#l01132">1132</a> of file <a class="el" href="tls_8c_source.html">tls.c</a>.</p>
<div id="dynsection-3" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-3-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-3-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-3-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="tls_8h_aa14aeb21ae4ac981b6afcec0c95a2095_cgraph.svg" width="100%" height="442"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>

</div>
</div>
<a id="a97b48775a94a972992a883fd82947290"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a97b48775a94a972992a883fd82947290">&#9670;&nbsp;</a></span>eap_tls_fail()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int eap_tls_fail </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="radclient_8c.html#a2fc1b64f51f8225195d32592e6fe8fc5">request_t</a> *&#160;</td>
          <td class="paramname"><em>request</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="session_8h.html#a772e0f06abb52a90a255b6b0d9724fe7">eap_session_t</a> *&#160;</td>
          <td class="paramname"><em>eap_session</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Send an EAP-TLS failure. </p>
<p>Composes an EAP-TLS-Failure. This is a message with code EAP_TLS_FAILURE. It contains no cryptographic material, and is not protected.</p>
<p>In addition to sending the failure, will destroy any cached session data.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">request</td><td>The current subrequest. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">eap_session</td><td>that failed. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><ul>
<li>0 on success.</li>
<li>-1 on failure (to compose a valid packet). </li>
</ul>
</dd></dl>

<p class="definition">Definition at line <a class="el" href="tls_8c_source.html#l00350">350</a> of file <a class="el" href="tls_8c_source.html">tls.c</a>.</p>
<div id="dynsection-4" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-4-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-4-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-4-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="tls_8h_a97b48775a94a972992a883fd82947290_cgraph.svg" width="271" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a27e244d3f33734be5a788ab610528e06"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a27e244d3f33734be5a788ab610528e06">&#9670;&nbsp;</a></span>eap_tls_process()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="tls_8h.html#a2482e2bf7d2331807f586763386cb12e">eap_tls_status_t</a> eap_tls_process </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="radclient_8c.html#a2fc1b64f51f8225195d32592e6fe8fc5">request_t</a> *&#160;</td>
          <td class="paramname"><em>request</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="session_8h.html#a772e0f06abb52a90a255b6b0d9724fe7">eap_session_t</a> *&#160;</td>
          <td class="paramname"><em>eap_session</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Process an EAP TLS request. </p>
<p>Here we implement a basic state machine. The state machine is implicit and is driven by the state of the TLS session and the flags sent. INCOMING <a class="el" href="snprintf_8h.html#structDATA">DATA</a>:</p><ol type="1">
<li>EAP-TLS should get the compelete TLS data from the peer.</li>
<li>Store that data in a data structure with any other required info</li>
<li>Hand this data structure to the TLS module.</li>
<li>TLS module will perform its operations on the data and hands back to EAP-TLS OUTGOING <a class="el" href="snprintf_8h.html#structDATA">DATA</a>:</li>
</ol>
<ol type="1">
<li>EAP-TLS if necessary will fragment it and send it to the destination.</li>
</ol>
<p>During EAP-TLS initialization, TLS Context object will be initialised and stored. For every new authentication request, TLS will open a new session object and that session object SHOULD be maintained even after the session is completed, for session resumption.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">request</td><td>the request </td></tr>
    <tr><td class="paramname">eap_session</td><td>to continue. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><ul>
<li>EAP_TLS_ESTABLISHED</li>
<li>EAP_TLS_HANDLED </li>
</ul>
</dd></dl>

<p class="definition">Definition at line <a class="el" href="tls_8c_source.html#l00904">904</a> of file <a class="el" href="tls_8c_source.html">tls.c</a>.</p>
<div id="dynsection-5" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-5-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-5-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-5-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="tls_8h_a27e244d3f33734be5a788ab610528e06_cgraph.svg" width="100%" height="460"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>

</div>
</div>
<a id="a94d9f18de6fa10711657a0f9d4d103cb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a94d9f18de6fa10711657a0f9d4d103cb">&#9670;&nbsp;</a></span>eap_tls_request()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int eap_tls_request </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="radclient_8c.html#a2fc1b64f51f8225195d32592e6fe8fc5">request_t</a> *&#160;</td>
          <td class="paramname"><em>request</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="session_8h.html#a772e0f06abb52a90a255b6b0d9724fe7">eap_session_t</a> *&#160;</td>
          <td class="paramname"><em>eap_session</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Frames the OpenSSL data that needs to be sent to the client in an EAP-Request. </p>
<p>A single TLS record may be up to 16384 octets in length, but a TLS message may span multiple TLS records, and a TLS certificate message may theoretically, be as big as 16MB.</p>
<p>In EAP-TLS with no inner method, this is used primarily to send our certificate chain to the peer.</p>
<p>In other methods this function is also called to package up application data for the inner tunnel method.</p>
<p>The eap_tls_session-&gt;length_included flag determines whether we include the extra four byte length field in the request and set the L flag.</p>
<p>If present, the tls_length field indicates the total length of the reassembled TLS record.</p>
<p>If eap_tls_session-&gt;length_included this means we include L flag and the tls_length field in EVERY packet we send out.</p>
<p>If !eap_tls_session-&gt;length_included this means we include L flag and tls_length field <b>ONLY</b> in First packet of a fragment series. We do not use it anywhere else.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">request</td><td>the request </td></tr>
    <tr><td class="paramname">eap_session</td><td>that's continuing. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><ul>
<li>0 on success.</li>
<li>-1 on failure. </li>
</ul>
</dd></dl>

<p class="definition">Definition at line <a class="el" href="tls_8c_source.html#l00400">400</a> of file <a class="el" href="tls_8c_source.html">tls.c</a>.</p>
<div id="dynsection-6" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-6-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-6-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-6-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="tls_8h_a94d9f18de6fa10711657a0f9d4d103cb_cgraph.svg" width="298" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="ad8d9a6b0edd299041c70c2f0574b15b4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad8d9a6b0edd299041c70c2f0574b15b4">&#9670;&nbsp;</a></span>eap_tls_session_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="tls_8h.html#structeap__tls__session__t">eap_tls_session_t</a>* eap_tls_session_init </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="radclient_8c.html#a2fc1b64f51f8225195d32592e6fe8fc5">request_t</a> *&#160;</td>
          <td class="paramname"><em>request</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="session_8h.html#a772e0f06abb52a90a255b6b0d9724fe7">eap_session_t</a> *&#160;</td>
          <td class="paramname"><em>eap_session</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">fr_tls_conf_t *&#160;</td>
          <td class="paramname"><em>tls_conf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>client_cert</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Create a new fr_tls_session_t associated with an <a class="el" href="session_8h.html#a772e0f06abb52a90a255b6b0d9724fe7">eap_session_t</a>. </p>
<p>Creates a new server fr_tls_session_t and associates it with an <a class="el" href="session_8h.html#a772e0f06abb52a90a255b6b0d9724fe7">eap_session_t</a> adding EAP specific opaque data to the SSL session created during fr_tls_session_t initialisation.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">request</td><td>The current subrequest. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">eap_session</td><td>to use as a context for the <a class="el" href="tls_8h.html#structeap__tls__session__t" title="Tracks the state of an EAP-TLS session. ">eap_tls_session_t</a> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tls_conf</td><td>to use to configure the fr_tls_session_t. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">client_cert</td><td>Whether we require the peer to prevent a certificate. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><ul>
<li>A new eap_tls_session on success.</li>
<li>NULL on error. </li>
</ul>
</dd></dl>

<p class="definition">Definition at line <a class="el" href="tls_8c_source.html#l01068">1068</a> of file <a class="el" href="tls_8c_source.html">tls.c</a>.</p>

</div>
</div>
<a id="a92b2882222297ba5cb85329be7ebb2ea"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a92b2882222297ba5cb85329be7ebb2ea">&#9670;&nbsp;</a></span>eap_tls_start()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int eap_tls_start </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="radclient_8c.html#a2fc1b64f51f8225195d32592e6fe8fc5">request_t</a> *&#160;</td>
          <td class="paramname"><em>request</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="session_8h.html#a772e0f06abb52a90a255b6b0d9724fe7">eap_session_t</a> *&#160;</td>
          <td class="paramname"><em>eap_session</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Send an initial EAP-TLS request to the peer. </p>
<p>Once having received the peer's Identity, the EAP server MUST respond with an EAP-TLS/Start packet, which is an EAP-Request packet with EAP-Type = EAP-TLS, the Start (S) bit set, and no data.</p>
<p>The EAP-TLS conversation will then begin, with the peer sending an EAP-Response packet with EAP-Type = EAP-TLS. The data field of that packet will be the TLS data.</p>
<p>The S flag is set only within the EAP-TLS start message sent from the EAP server to the peer.</p>
<ul>
<li>len = header + type + tls_typedata</li>
<li>tls_typedata = flags(Start (S) bit set, and no data)</li>
</ul>
<p>Fragment length is Framed-MTU - 4.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">request</td><td>The current subrequest. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">eap_session</td><td>to initiate. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><ul>
<li>0 on success.</li>
<li>-1 on failure. </li>
</ul>
</dd></dl>

<p class="definition">Definition at line <a class="el" href="tls_8c_source.html#l00236">236</a> of file <a class="el" href="tls_8c_source.html">tls.c</a>.</p>
<div id="dynsection-7" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-7-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-7-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-7-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="tls_8h_a92b2882222297ba5cb85329be7ebb2ea_cgraph.svg" width="280" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="acaf3efd415b5f2a7fccfbcc9f7235254"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acaf3efd415b5f2a7fccfbcc9f7235254">&#9670;&nbsp;</a></span>eap_tls_success()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int eap_tls_success </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="radclient_8c.html#a2fc1b64f51f8225195d32592e6fe8fc5">request_t</a> *&#160;</td>
          <td class="paramname"><em>request</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="session_8h.html#a772e0f06abb52a90a255b6b0d9724fe7">eap_session_t</a> *&#160;</td>
          <td class="paramname"><em>eap_session</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char const *&#160;</td>
          <td class="paramname"><em>keying_prf_label</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>keying_prf_label_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char const *&#160;</td>
          <td class="paramname"><em>sessid_prf_label</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>sessid_prf_label_len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Send an EAP-TLS success. </p>
<p>Composes an EAP-TLS-Success. This is a message with code EAP_TLS_ESTABLISHED. It contains no cryptographic material, and is not protected.</p>
<p>We add the MPPE keys here. These are used by the NAS. The supplicant will derive the same keys separately.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">request</td><td>The current subrequest. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">eap_session</td><td>that completed successfully. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">keying_prf_label</td><td>PRF label to use for generating keying material. If NULL, no MPPE keys will be generated. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">keying_prf_label_len</td><td>Length of the keying PRF label. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">sessid_prf_label</td><td>PRF label to use when generating the session ID. If NULL, session ID will be based on client/server randoms. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">sessid_prf_label_len</td><td>Length of the session ID PRF label. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><ul>
<li>0 on success.</li>
<li>-1 on failure. </li>
</ul>
</dd></dl>

<p class="definition">Definition at line <a class="el" href="tls_8c_source.html#l00266">266</a> of file <a class="el" href="tls_8c_source.html">tls.c</a>.</p>
<div id="dynsection-8" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-8-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-8-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-8-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="tls_8h_acaf3efd415b5f2a7fccfbcc9f7235254_cgraph.svg" width="100%" height="466"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a6d6a114ba908303049edb167870c81a6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6d6a114ba908303049edb167870c81a6">&#9670;&nbsp;</a></span>eap_tls_status_table</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="table_8h.html#structfr__table__num__ordered__t">fr_table_num_ordered_t</a> const eap_tls_status_table[]</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="tls_8c_source.html#l00077">77</a> of file <a class="el" href="tls_8c_source.html">tls.c</a>.</p>

</div>
</div>
<a id="a76915fb753f22f60c92cf61e9b267bd5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a76915fb753f22f60c92cf61e9b267bd5">&#9670;&nbsp;</a></span>eap_tls_status_table_len</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t eap_tls_status_table_len</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="tls_8c_source.html#l00091">91</a> of file <a class="el" href="tls_8c_source.html">tls.c</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Thu Nov 12 2020 22:44:25 by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
