<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>/home/runner/work/freeradius-server/freeradius-server/src/lib/ldap/util.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="freeradius.png"/></td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_c85d3e3c5052e9ad9ce18c6863244a25.html">lib</a></li><li class="navelem"><a class="el" href="dir_92eccc346776d861491b6a4e09141fef.html">ldap</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">util.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Utility functions to escape and parse DNs.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;freeradius-devel/ldap/base.h&gt;</code><br />
<code>#include &lt;freeradius-devel/util/hex.h&gt;</code><br />
<code>#include &lt;stdarg.h&gt;</code><br />
<code>#include &lt;ctype.h&gt;</code><br />
</div><div class="textblock"><div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="closed.png" alt="+"/> Include dependency graph for util.c:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="lib_2ldap_2util_8c__incl.svg" width="496" height="156"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</div>
<p><a href="lib_2ldap_2util_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a15944643fb7d65088db5617daa0b0b1a"><td class="memItemLeft" align="right" valign="top">uint8_t *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="lib_2ldap_2util_8c.html#a15944643fb7d65088db5617daa0b0b1a">fr_ldap_berval_to_bin</a> (TALLOC_CTX *ctx, struct berval const *<a class="el" href="value_8h.html#a47ef05ec8d75829006b7eba839c1b603">in</a>)</td></tr>
<tr class="memdesc:a15944643fb7d65088db5617daa0b0b1a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Convert a berval to a talloced buffer.  <a href="#a15944643fb7d65088db5617daa0b0b1a">More...</a><br /></td></tr>
<tr class="separator:a15944643fb7d65088db5617daa0b0b1a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9a39273437e93b71a723b85a39690616"><td class="memItemLeft" align="right" valign="top">char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="lib_2ldap_2util_8c.html#a9a39273437e93b71a723b85a39690616">fr_ldap_berval_to_string</a> (TALLOC_CTX *ctx, struct berval const *<a class="el" href="value_8h.html#a47ef05ec8d75829006b7eba839c1b603">in</a>)</td></tr>
<tr class="memdesc:a9a39273437e93b71a723b85a39690616"><td class="mdescLeft">&#160;</td><td class="mdescRight">Convert a berval to a talloced string.  <a href="#a9a39273437e93b71a723b85a39690616">More...</a><br /></td></tr>
<tr class="separator:a9a39273437e93b71a723b85a39690616"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3bbe1f06785352e62d10a38b2ea6eb47"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="lib_2ldap_2util_8c.html#a3bbe1f06785352e62d10a38b2ea6eb47">fr_ldap_common_dn</a> (char const *full, char const *part)</td></tr>
<tr class="memdesc:a3bbe1f06785352e62d10a38b2ea6eb47"><td class="mdescLeft">&#160;</td><td class="mdescRight">Find the place at which the two DN strings diverge.  <a href="#a3bbe1f06785352e62d10a38b2ea6eb47">More...</a><br /></td></tr>
<tr class="separator:a3bbe1f06785352e62d10a38b2ea6eb47"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a19ac903e2a4930e8ae9973e86e87f464"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="lib_2ldap_2util_8c.html#a19ac903e2a4930e8ae9973e86e87f464">fr_ldap_escape_func</a> (<a class="el" href="build_8h.html#addf5ec070e9499d36b7f2009ce736076">UNUSED</a> <a class="el" href="radclient_8c.html#a2fc1b64f51f8225195d32592e6fe8fc5">request_t</a> *request, char *<a class="el" href="value_8h.html#af17d2d4e72bd60de680d3f4a29a1275f">out</a>, size_t outlen, char const *<a class="el" href="value_8h.html#a47ef05ec8d75829006b7eba839c1b603">in</a>, <a class="el" href="build_8h.html#addf5ec070e9499d36b7f2009ce736076">UNUSED</a> void *arg)</td></tr>
<tr class="memdesc:a19ac903e2a4930e8ae9973e86e87f464"><td class="mdescLeft">&#160;</td><td class="mdescRight">Converts "bad" strings into ones which are safe for LDAP.  <a href="#a19ac903e2a4930e8ae9973e86e87f464">More...</a><br /></td></tr>
<tr class="separator:a19ac903e2a4930e8ae9973e86e87f464"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a47f2f663944b67e92cbf483296e65b66"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="lib_2ldap_2util_8c.html#a47f2f663944b67e92cbf483296e65b66">fr_ldap_parse_url_extensions</a> (LDAPControl **sss, <a class="el" href="radclient_8c.html#a2fc1b64f51f8225195d32592e6fe8fc5">request_t</a> *request, <a class="el" href="ldap_2base_8h.html#structfr__ldap__connection__t">fr_ldap_connection_t</a> *conn, char **extensions)</td></tr>
<tr class="memdesc:a47f2f663944b67e92cbf483296e65b66"><td class="mdescLeft">&#160;</td><td class="mdescRight">Parse a subset (just server side sort for now) of LDAP URL extensions.  <a href="#a47f2f663944b67e92cbf483296e65b66">More...</a><br /></td></tr>
<tr class="separator:a47f2f663944b67e92cbf483296e65b66"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af93958eb325ed94d0207487d544f524a"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="lib_2ldap_2util_8c.html#af93958eb325ed94d0207487d544f524a">fr_ldap_unescape_func</a> (<a class="el" href="build_8h.html#addf5ec070e9499d36b7f2009ce736076">UNUSED</a> <a class="el" href="radclient_8c.html#a2fc1b64f51f8225195d32592e6fe8fc5">request_t</a> *request, char *<a class="el" href="value_8h.html#af17d2d4e72bd60de680d3f4a29a1275f">out</a>, size_t outlen, char const *<a class="el" href="value_8h.html#a47ef05ec8d75829006b7eba839c1b603">in</a>, <a class="el" href="build_8h.html#addf5ec070e9499d36b7f2009ce736076">UNUSED</a> void *arg)</td></tr>
<tr class="memdesc:af93958eb325ed94d0207487d544f524a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Converts escaped DNs and filter strings into normal.  <a href="#af93958eb325ed94d0207487d544f524a">More...</a><br /></td></tr>
<tr class="separator:af93958eb325ed94d0207487d544f524a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a31c477ea5b61299a8a2aa2a2170fdafa"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="lib_2ldap_2util_8c.html#a31c477ea5b61299a8a2aa2a2170fdafa">fr_ldap_util_is_dn</a> (char const *<a class="el" href="value_8h.html#a47ef05ec8d75829006b7eba839c1b603">in</a>, size_t <a class="el" href="value_8h.html#a26bd6a430c456629c00363322491f55a">inlen</a>)</td></tr>
<tr class="memdesc:a31c477ea5b61299a8a2aa2a2170fdafa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check whether a string looks like a DN.  <a href="#a31c477ea5b61299a8a2aa2a2170fdafa">More...</a><br /></td></tr>
<tr class="separator:a31c477ea5b61299a8a2aa2a2170fdafa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0616964a710595ead3bc3a52a30b54cb"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="lib_2ldap_2util_8c.html#a0616964a710595ead3bc3a52a30b54cb">fr_ldap_util_normalise_dn</a> (char *<a class="el" href="value_8h.html#af17d2d4e72bd60de680d3f4a29a1275f">out</a>, char const *<a class="el" href="value_8h.html#a47ef05ec8d75829006b7eba839c1b603">in</a>)</td></tr>
<tr class="memdesc:a0616964a710595ead3bc3a52a30b54cb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Normalise escape sequences in a DN.  <a href="#a0616964a710595ead3bc3a52a30b54cb">More...</a><br /></td></tr>
<tr class="separator:a0616964a710595ead3bc3a52a30b54cb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa54c44e2d431dcede12b8c59e4b2c7d2"><td class="memItemLeft" align="right" valign="top">ssize_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="lib_2ldap_2util_8c.html#aa54c44e2d431dcede12b8c59e4b2c7d2">fr_ldap_xlat_filter</a> (<a class="el" href="radclient_8c.html#a2fc1b64f51f8225195d32592e6fe8fc5">request_t</a> *request, char const **sub, size_t sublen, char *<a class="el" href="value_8h.html#af17d2d4e72bd60de680d3f4a29a1275f">out</a>, size_t outlen)</td></tr>
<tr class="memdesc:aa54c44e2d431dcede12b8c59e4b2c7d2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Combine and expand filters.  <a href="#aa54c44e2d431dcede12b8c59e4b2c7d2">More...</a><br /></td></tr>
<tr class="separator:aa54c44e2d431dcede12b8c59e4b2c7d2"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a02f0747e2432b74ec44a2b53d26b5426"><td class="memItemLeft" align="right" valign="top">static const char&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="lib_2ldap_2util_8c.html#a02f0747e2432b74ec44a2b53d26b5426">hextab</a> [] = &quot;0123456789abcdef&quot;</td></tr>
<tr class="separator:a02f0747e2432b74ec44a2b53d26b5426"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4c7dcff9f21597b7d0b40d6b70fb6fcc"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="build_8h.html#a07ff0f2b21314d8f74a61d89be974f66">USES_APPLE_DEPRECATED_API</a> const char&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="lib_2ldap_2util_8c.html#a4c7dcff9f21597b7d0b40d6b70fb6fcc">specials</a> [] = &quot;,+\&quot;\&lt;&gt;;*=()&quot;</td></tr>
<tr class="separator:a4c7dcff9f21597b7d0b40d6b70fb6fcc"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Utility functions to escape and parse DNs. </p>
<dl class="section rcs"><dt>Id</dt><dd>c14862be23cb93ea60d789fa0cc8ad1a08cc226e </dd></dl>
<dl class="section author"><dt>Author</dt><dd>Arran Cudbard-Bell (<a href="#" onclick="location.href='mai'+'lto:'+'a.c'+'ud'+'bar'+'db'+'@fr'+'ee'+'rad'+'iu'+'s.o'+'rg'; return false;">a.cud<span style="display: none;">.nosp@m.</span>bard<span style="display: none;">.nosp@m.</span>b@fre<span style="display: none;">.nosp@m.</span>erad<span style="display: none;">.nosp@m.</span>ius.o<span style="display: none;">.nosp@m.</span>rg</a>) </dd></dl>
<dl class="section copyright"><dt>Copyright</dt><dd>2017 Arran Cudbard-Bell (<a href="#" onclick="location.href='mai'+'lto:'+'a.c'+'ud'+'bar'+'db'+'@fr'+'ee'+'rad'+'iu'+'s.o'+'rg'; return false;">a.cud<span style="display: none;">.nosp@m.</span>bard<span style="display: none;">.nosp@m.</span>b@fre<span style="display: none;">.nosp@m.</span>erad<span style="display: none;">.nosp@m.</span>ius.o<span style="display: none;">.nosp@m.</span>rg</a>) </dd>
<dd>
2017 The FreeRADIUS Server Project. </dd></dl>

<p class="definition">Definition in file <a class="el" href="lib_2ldap_2util_8c_source.html">util.c</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a15944643fb7d65088db5617daa0b0b1a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a15944643fb7d65088db5617daa0b0b1a">&#9670;&nbsp;</a></span>fr_ldap_berval_to_bin()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t* fr_ldap_berval_to_bin </td>
          <td>(</td>
          <td class="paramtype">TALLOC_CTX *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct berval const *&#160;</td>
          <td class="paramname"><em>in</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Convert a berval to a talloced buffer. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>to allocate in. </td></tr>
    <tr><td class="paramname">in</td><td>Berval to copy. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>buffer containing in-&gt;bv_val. </dd></dl>

<p class="definition">Definition at line <a class="el" href="lib_2ldap_2util_8c_source.html#l00366">366</a> of file <a class="el" href="lib_2ldap_2util_8c_source.html">util.c</a>.</p>
<div id="dynsection-1" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-1-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-1-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-1-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="lib_2ldap_2util_8c_a15944643fb7d65088db5617daa0b0b1a_icgraph.svg" width="100%" height="416"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>

</div>
</div>
<a id="a9a39273437e93b71a723b85a39690616"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9a39273437e93b71a723b85a39690616">&#9670;&nbsp;</a></span>fr_ldap_berval_to_string()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* fr_ldap_berval_to_string </td>
          <td>(</td>
          <td class="paramtype">TALLOC_CTX *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct berval const *&#160;</td>
          <td class="paramname"><em>in</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Convert a berval to a talloced string. </p>
<p>The ldap_get_values function is deprecated, and ldap_get_values_len does not guarantee the berval buffers it returns are \0 terminated.</p>
<p>For some cases this is fine, for others we require a \0 terminated buffer (feeding DNs back into libldap for example).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>to allocate in. </td></tr>
    <tr><td class="paramname">in</td><td>Berval to copy. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>\0 terminated buffer containing in-&gt;bv_val. </dd></dl>

<p class="definition">Definition at line <a class="el" href="lib_2ldap_2util_8c_source.html#l00347">347</a> of file <a class="el" href="lib_2ldap_2util_8c_source.html">util.c</a>.</p>
<div id="dynsection-2" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-2-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-2-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-2-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="lib_2ldap_2util_8c_a9a39273437e93b71a723b85a39690616_icgraph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>

</div>
</div>
<a id="a3bbe1f06785352e62d10a38b2ea6eb47"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3bbe1f06785352e62d10a38b2ea6eb47">&#9670;&nbsp;</a></span>fr_ldap_common_dn()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t fr_ldap_common_dn </td>
          <td>(</td>
          <td class="paramtype">char const *&#160;</td>
          <td class="paramname"><em>full</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char const *&#160;</td>
          <td class="paramname"><em>part</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Find the place at which the two DN strings diverge. </p>
<p>Returns the length of the non matching string in full.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">full</td><td>DN. </td></tr>
    <tr><td class="paramname">part</td><td>Partial DN as returned by ldap_parse_result. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><ul>
<li>Length of the portion of full which wasn't matched</li>
<li>-1 on failure. </li>
</ul>
</dd></dl>

<p class="definition">Definition at line <a class="el" href="lib_2ldap_2util_8c_source.html#l00459">459</a> of file <a class="el" href="lib_2ldap_2util_8c_source.html">util.c</a>.</p>
<div id="dynsection-3" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-3-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-3-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-3-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="lib_2ldap_2util_8c_a3bbe1f06785352e62d10a38b2ea6eb47_icgraph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>

</div>
</div>
<a id="a19ac903e2a4930e8ae9973e86e87f464"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a19ac903e2a4930e8ae9973e86e87f464">&#9670;&nbsp;</a></span>fr_ldap_escape_func()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t fr_ldap_escape_func </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="build_8h.html#addf5ec070e9499d36b7f2009ce736076">UNUSED</a> <a class="el" href="radclient_8c.html#a2fc1b64f51f8225195d32592e6fe8fc5">request_t</a> *&#160;</td>
          <td class="paramname"><em>request</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>outlen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char const *&#160;</td>
          <td class="paramname"><em>in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="build_8h.html#addf5ec070e9499d36b7f2009ce736076">UNUSED</a> void *&#160;</td>
          <td class="paramname"><em>arg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Converts "bad" strings into ones which are safe for LDAP. </p>
<dl class="section note"><dt>Note</dt><dd>RFC 4515 says filter strings can only use the<pre class="fragment">\&lt;hex&gt;&lt;hex&gt; </pre> format, whereas RFC 4514 indicates that some chars in DNs, may be escaped simply with a backslash. For simplicity, we always use the hex escape sequences. In other areas where we're doing DN comparison, the DNs need to be normalised first so that they both use only hex escape sequences.</dd>
<dd>
This is a callback for xlat operations.</dd></dl>
<p>Will escape any characters in input strings that would cause the string to be interpreted as part of a DN and or filter. Escape sequence is</p><pre class="fragment">\&lt;hex&gt;&lt;hex&gt; </pre><p>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">request</td><td>The current request. </td></tr>
    <tr><td class="paramname">out</td><td>Pointer to output buffer. </td></tr>
    <tr><td class="paramname">outlen</td><td>Size of the output buffer. </td></tr>
    <tr><td class="paramname">in</td><td>Raw unescaped string. </td></tr>
    <tr><td class="paramname">arg</td><td>Any additional arguments (unused). </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="lib_2ldap_2util_8c_source.html#l00058">58</a> of file <a class="el" href="lib_2ldap_2util_8c_source.html">util.c</a>.</p>
<div id="dynsection-4" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-4-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-4-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-4-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="lib_2ldap_2util_8c_a19ac903e2a4930e8ae9973e86e87f464_cgraph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
<div id="dynsection-5" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-5-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-5-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-5-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="lib_2ldap_2util_8c_a19ac903e2a4930e8ae9973e86e87f464_icgraph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>

</div>
</div>
<a id="a47f2f663944b67e92cbf483296e65b66"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a47f2f663944b67e92cbf483296e65b66">&#9670;&nbsp;</a></span>fr_ldap_parse_url_extensions()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int fr_ldap_parse_url_extensions </td>
          <td>(</td>
          <td class="paramtype">LDAPControl **&#160;</td>
          <td class="paramname"><em>sss</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="radclient_8c.html#a2fc1b64f51f8225195d32592e6fe8fc5">request_t</a> *&#160;</td>
          <td class="paramname"><em>request</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ldap_2base_8h.html#structfr__ldap__connection__t">fr_ldap_connection_t</a> *&#160;</td>
          <td class="paramname"><em>conn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **&#160;</td>
          <td class="paramname"><em>extensions</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Parse a subset (just server side sort for now) of LDAP URL extensions. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">sss</td><td>Where to write a pointer to the server side sort control we created. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">request</td><td>The current request. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">conn</td><td>Handle to allocate controls under. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">extensions</td><td>A NULL terminated array of extensions. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><ul>
<li>0 on success.</li>
<li>-1 on failure. </li>
</ul>
</dd></dl>

<p class="definition">Definition at line <a class="el" href="lib_2ldap_2util_8c_source.html#l00273">273</a> of file <a class="el" href="lib_2ldap_2util_8c_source.html">util.c</a>.</p>
<div id="dynsection-6" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-6-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-6-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-6-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="lib_2ldap_2util_8c_a47f2f663944b67e92cbf483296e65b66_icgraph.svg" width="100%" height="416"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>

</div>
</div>
<a id="af93958eb325ed94d0207487d544f524a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af93958eb325ed94d0207487d544f524a">&#9670;&nbsp;</a></span>fr_ldap_unescape_func()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t fr_ldap_unescape_func </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="build_8h.html#addf5ec070e9499d36b7f2009ce736076">UNUSED</a> <a class="el" href="radclient_8c.html#a2fc1b64f51f8225195d32592e6fe8fc5">request_t</a> *&#160;</td>
          <td class="paramname"><em>request</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>outlen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char const *&#160;</td>
          <td class="paramname"><em>in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="build_8h.html#addf5ec070e9499d36b7f2009ce736076">UNUSED</a> void *&#160;</td>
          <td class="paramname"><em>arg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Converts escaped DNs and filter strings into normal. </p>
<dl class="section note"><dt>Note</dt><dd>RFC 4515 says filter strings can only use the<pre class="fragment">\&lt;hex&gt;&lt;hex&gt; </pre> format, whereas RFC 4514 indicates that some chars in DNs, may be escaped simply with a backslash..</dd></dl>
<p>Will unescape any special characters in strings, or</p><pre class="fragment">\&lt;hex&gt;&lt;hex&gt; </pre><p> sequences.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">request</td><td>The current request. </td></tr>
    <tr><td class="paramname">out</td><td>Pointer to output buffer. </td></tr>
    <tr><td class="paramname">outlen</td><td>Size of the output buffer. </td></tr>
    <tr><td class="paramname">in</td><td>Escaped string string. </td></tr>
    <tr><td class="paramname">arg</td><td>Any additional arguments (unused). </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="lib_2ldap_2util_8c_source.html#l00114">114</a> of file <a class="el" href="lib_2ldap_2util_8c_source.html">util.c</a>.</p>
<div id="dynsection-7" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-7-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-7-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-7-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="lib_2ldap_2util_8c_af93958eb325ed94d0207487d544f524a_icgraph.svg" width="100%" height="378"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>

</div>
</div>
<a id="a31c477ea5b61299a8a2aa2a2170fdafa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a31c477ea5b61299a8a2aa2a2170fdafa">&#9670;&nbsp;</a></span>fr_ldap_util_is_dn()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool fr_ldap_util_is_dn </td>
          <td>(</td>
          <td class="paramtype">char const *&#160;</td>
          <td class="paramname"><em>in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>inlen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check whether a string looks like a DN. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">in</td><td>Str to check. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">inlen</td><td>Length of string to check. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><ul>
<li>true if string looks like a DN.</li>
<li>false if string does not look like DN. </li>
</ul>
</dd></dl>

<p class="definition">Definition at line <a class="el" href="lib_2ldap_2util_8c_source.html#l00161">161</a> of file <a class="el" href="lib_2ldap_2util_8c_source.html">util.c</a>.</p>
<div id="dynsection-8" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-8-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-8-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-8-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="lib_2ldap_2util_8c_a31c477ea5b61299a8a2aa2a2170fdafa_cgraph.svg" width="264" height="88"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
<div id="dynsection-9" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-9-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-9-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-9-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="lib_2ldap_2util_8c_a31c477ea5b61299a8a2aa2a2170fdafa_icgraph.svg" width="100%" height="525"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>

</div>
</div>
<a id="a0616964a710595ead3bc3a52a30b54cb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0616964a710595ead3bc3a52a30b54cb">&#9670;&nbsp;</a></span>fr_ldap_util_normalise_dn()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t fr_ldap_util_normalise_dn </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char const *&#160;</td>
          <td class="paramname"><em>in</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Normalise escape sequences in a DN. </p>
<p>Characters in a DN can either be escaped as </p><pre class="fragment">\&lt;hex&gt;&lt;hex&gt; </pre><p> or</p><pre class="fragment">\&lt;special&gt; </pre><p>The LDAP directory chooses how characters are escaped, which can make local comparisons of DNs difficult.</p>
<p>Here we search for hex sequences that match special chars, and convert them to the</p><pre class="fragment">\&lt;special&gt; </pre><p> form.</p>
<dl class="section note"><dt>Note</dt><dd>the resulting output string will only ever be shorter than the input, so it's fine to use the same buffer for both out and in.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">out</td><td>Where to write the normalised DN. </td></tr>
    <tr><td class="paramname">in</td><td>The input DN. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The number of bytes written to out. </dd></dl>

<p class="definition">Definition at line <a class="el" href="lib_2ldap_2util_8c_source.html#l00396">396</a> of file <a class="el" href="lib_2ldap_2util_8c_source.html">util.c</a>.</p>
<div id="dynsection-10" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-10-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-10-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-10-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="lib_2ldap_2util_8c_a0616964a710595ead3bc3a52a30b54cb_cgraph.svg" width="311" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
<div id="dynsection-11" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-11-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-11-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-11-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="lib_2ldap_2util_8c_a0616964a710595ead3bc3a52a30b54cb_icgraph.svg" width="100%" height="596"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>

</div>
</div>
<a id="aa54c44e2d431dcede12b8c59e4b2c7d2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa54c44e2d431dcede12b8c59e4b2c7d2">&#9670;&nbsp;</a></span>fr_ldap_xlat_filter()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ssize_t fr_ldap_xlat_filter </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="radclient_8c.html#a2fc1b64f51f8225195d32592e6fe8fc5">request_t</a> *&#160;</td>
          <td class="paramname"><em>request</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char const **&#160;</td>
          <td class="paramname"><em>sub</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>sublen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>outlen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Combine and expand filters. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">request</td><td>Current request. </td></tr>
    <tr><td class="paramname">out</td><td>Where to write the expanded string. </td></tr>
    <tr><td class="paramname">outlen</td><td>Length of output buffer. </td></tr>
    <tr><td class="paramname">sub</td><td>Array of subfilters (may contain NULLs). </td></tr>
    <tr><td class="paramname">sublen</td><td>Number of potential subfilters in array. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>length of expanded data. </dd></dl>

<p class="definition">Definition at line <a class="el" href="lib_2ldap_2util_8c_source.html#l00488">488</a> of file <a class="el" href="lib_2ldap_2util_8c_source.html">util.c</a>.</p>
<div id="dynsection-12" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-12-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-12-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-12-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="lib_2ldap_2util_8c_aa54c44e2d431dcede12b8c59e4b2c7d2_cgraph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
<div id="dynsection-13" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-13-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-13-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-13-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="lib_2ldap_2util_8c_aa54c44e2d431dcede12b8c59e4b2c7d2_icgraph.svg" width="100%" height="437"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a02f0747e2432b74ec44a2b53d26b5426"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a02f0747e2432b74ec44a2b53d26b5426">&#9670;&nbsp;</a></span>hextab</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const char hextab[] = &quot;0123456789abcdef&quot;</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="lib_2ldap_2util_8c_source.html#l00037">37</a> of file <a class="el" href="lib_2ldap_2util_8c_source.html">util.c</a>.</p>

</div>
</div>
<a id="a4c7dcff9f21597b7d0b40d6b70fb6fcc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4c7dcff9f21597b7d0b40d6b70fb6fcc">&#9670;&nbsp;</a></span>specials</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="build_8h.html#a07ff0f2b21314d8f74a61d89be974f66">USES_APPLE_DEPRECATED_API</a> const char specials[] = &quot;,+\&quot;\&lt;&gt;;*=()&quot;</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="lib_2ldap_2util_8c_source.html#l00036">36</a> of file <a class="el" href="lib_2ldap_2util_8c_source.html">util.c</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Tue Nov 17 2020 00:02:36 by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
