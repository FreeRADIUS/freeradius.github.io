<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>/home/runner/work/freeradius-server/freeradius-server/src/lib/unlang/switch.c Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="freeradius.png"/></td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_c85d3e3c5052e9ad9ce18c6863244a25.html">lib</a></li><li class="navelem"><a class="el" href="dir_8bd9041bb00c2961befd0c0eb73aa27b.html">unlang</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">switch.c</div>  </div>
</div><!--header-->
<div class="contents">
<a href="switch_8c.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"> *   This program is free software; you can redistribute it and/or modify</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"> *   it under the terms of the GNU General Public License as published by</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"> *   the Free Software Foundation; either version 2 of the License, or</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment"> *   (at your option) any later version.</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment"> *   This program is distributed in the hope that it will be useful,</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment"> *   but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment"> *   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment"> *   GNU General Public License for more details.</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment"> *   You should have received a copy of the GNU General Public License</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment"> *   along with this program; if not, write to the Free Software</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment"> *   Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301, USA</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">/**</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment"> * $Id: 09019bc70c5293d24e567e7b023d6433faa266fd $</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment"> * @file unlang/switch.c</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment"> * @brief Unlang &quot;switch&quot; keyword evaluation.</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment"> * @copyright 2006-2019 The FreeRADIUS server project</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<a class="code" href="build_8h.html#a17c6430174bd106c2fa80061361f0f7b">RCSID</a>(<span class="stringliteral">&quot;$Id: 09019bc70c5293d24e567e7b023d6433faa266fd $&quot;</span>)</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#include &lt;freeradius-devel/server/cond.h&gt;</span></div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="group__priv_8h.html">group_priv.h</a>&quot;</span></div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="switch__priv_8h.html">switch_priv.h</a>&quot;</span></div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="unlang__priv_8h.html">unlang_priv.h</a>&quot;</span></div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;</div><div class="line"><a name="l00033"></a><span class="lineno"><a class="line" href="switch_8c.html#a98227d8b5f78c9876102b7e58ab63d7b">   33</a></span>&#160;<span class="keyword">static</span> <a class="code" href="action_8h.html#ad02ab717522305fe70aab72d152fc812">unlang_action_t</a> <a class="code" href="switch_8c.html#a98227d8b5f78c9876102b7e58ab63d7b">unlang_switch</a>(<a class="code" href="build_8h.html#addf5ec070e9499d36b7f2009ce736076">UNUSED</a> <a class="code" href="rcode_8h.html#adcc711080df76349e177fc29a641d1fb">rlm_rcode_t</a> *p_result, <a class="code" href="request_8h.html#structrequest__s">request_t</a> *request)</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;{</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;        <a class="code" href="unlang__priv_8h.html#structunlang__stack__t">unlang_stack_t</a>          *<a class="code" href="modules_2proto__control_2radmin_8c.html#acbb0ad34f5d8b226a09b81ea4973082d">stack</a> = request-&gt;<a class="code" href="request_8h.html#aa657d8b77f62b69d04c549bf81a30228">stack</a>;</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;        <a class="code" href="unlang__priv_8h.html#structunlang__stack__frame__t">unlang_stack_frame_t</a>    *frame = &amp;stack-&gt;<a class="code" href="unlang__priv_8h.html#a4605abd932d2e10385f6e5c234cd62e0">frame</a>[stack-&gt;<a class="code" href="unlang__priv_8h.html#a80e6b040af5d0bd35a5c7a0449c7b452">depth</a>];</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;        <a class="code" href="unlang__priv_8h.html#structunlang__s">unlang_t</a>                *instruction = frame-&gt;<a class="code" href="unlang__priv_8h.html#aca1fa2fa71442204099637da828cdd94">instruction</a>;</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;        <a class="code" href="unlang__priv_8h.html#structunlang__s">unlang_t</a>                *<span class="keyword">this</span>, *found, *null_case;</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;        <a class="code" href="unlang__priv_8h.html#structunlang__group__t">unlang_group_t</a>          *switch_g;</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;        <a class="code" href="switch__priv_8h.html#structunlang__switch__t">unlang_switch_t</a> *switch_gext;</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;        <a class="code" href="cond_8h.html#structfr__cond__s">fr_cond_t</a>               cond;</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;        <a class="code" href="map_8h.html#structvp__map__s">map_t</a>           <a class="code" href="rlm__expr_8c.html#a67a61c02f0eccbad6b342dd9adeb7994">map</a>;</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;        <a class="code" href="server_2tmpl_8h.html#structtmpl__s">tmpl_t</a>                  vpt;</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;        switch_g = <a class="code" href="unlang__priv_8h.html#aac8f5c5ad9dc7c337553f920e1a181d4">unlang_generic_to_group</a>(instruction);</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;        switch_gext = <a class="code" href="switch__priv_8h.html#ab52a777157c7127065a6846884132c49">unlang_group_to_switch</a>(switch_g);</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;        memset(&amp;cond, 0, <span class="keyword">sizeof</span>(cond));</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;        memset(&amp;map, 0, <span class="keyword">sizeof</span>(map));</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;        memset(&amp;vpt, 0, <span class="keyword">sizeof</span>(vpt));</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;        cond.<a class="code" href="cond_8h.html#adc7d308924b2ebc59aa439692da92eab">type</a> = <a class="code" href="cond_8h.html#aa1a5aa02b488ff1199d02a1b00597bfcaa6c4d3e5aed0383fbd90d44b524c2a2e">COND_TYPE_MAP</a>;</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;        cond.<a class="code" href="cond_8h.html#a0b51bf1aabbd4b510bb4201785c9e006">data</a>.map = &amp;<a class="code" href="rlm__expr_8c.html#a67a61c02f0eccbad6b342dd9adeb7994">map</a>;</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;        map.<a class="code" href="map_8h.html#a4f5dcea8b5109909db55f18b72a8ffdf">op</a> = <a class="code" href="token_8h.html#a28164fda426e3d8b88ae9b52bffafde7aa05bbdd5100a8af99b04349ce8977319">T_OP_CMP_EQ</a>;</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;        map.<a class="code" href="map_8h.html#a08684c8861f48325d03a6b25caf24282">ci</a> = <a class="code" href="cf__util_8c.html#a11cfb91b7dd7bf343a4031ba7846c2ad">cf_section_to_item</a>(switch_g-&gt;<a class="code" href="unlang__priv_8h.html#a1a481704ce6ad0a8cb0cc6b2280e60fa">cs</a>);</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;        <a class="code" href="rad__assert_8h.html#ae8fbce32ab994abf84b95a7c57de209a">fr_assert</a>(switch_gext-&gt;<a class="code" href="switch__priv_8h.html#ad8ce89293822f6954c9022a7fae8f0a0">vpt</a> != NULL);</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;        null_case = found = NULL;</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;        <span class="comment">/*</span></div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="comment">         *      The attribute doesn&#39;t exist.  We can skip</span></div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="comment">         *      directly to the default &#39;case&#39; statement.</span></div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="comment">         */</span></div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="server_2tmpl_8h.html#a3d23dc2c5065ac256a7fb7931cd883b5">tmpl_is_attr</a>(switch_gext-&gt;<a class="code" href="switch__priv_8h.html#ad8ce89293822f6954c9022a7fae8f0a0">vpt</a>) &amp;&amp; (<a class="code" href="server_2tmpl_8h.html#a0d370ecb367dac1d9fdc49a185355bd4">tmpl_find_vp</a>(NULL, request, switch_gext-&gt;<a class="code" href="switch__priv_8h.html#ad8ce89293822f6954c9022a7fae8f0a0">vpt</a>) &lt; 0)) {</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;        find_null_case:</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;                <span class="keywordflow">for</span> (<span class="keyword">this</span> = switch_g-&gt;<a class="code" href="unlang__priv_8h.html#af27b189699bf167e3d0b32cc745ac552">children</a>; <span class="keyword">this</span>; <span class="keyword">this</span> = this-&gt;<a class="code" href="unlang__priv_8h.html#a0fe61fff5588709c463112bf511248ef">next</a>) {</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;                        <a class="code" href="unlang__priv_8h.html#structunlang__group__t">unlang_group_t</a>          *case_g;</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;                        <a class="code" href="switch__priv_8h.html#structunlang__case__t">unlang_case_t</a>   *case_gext;</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;                        <a class="code" href="rad__assert_8h.html#ae8fbce32ab994abf84b95a7c57de209a">fr_assert</a>(this-&gt;type == <a class="code" href="unlang__priv_8h.html#a9125308c5289036c4809f39fc5fcf7eba5d68a4e7663a1cd15b5a120175fd3f66">UNLANG_TYPE_CASE</a>);</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;                        case_g = <a class="code" href="unlang__priv_8h.html#aac8f5c5ad9dc7c337553f920e1a181d4">unlang_generic_to_group</a>(<span class="keyword">this</span>);</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;                        case_gext = <a class="code" href="switch__priv_8h.html#ad136d9125de0013659f36a95ce1fcb27">unlang_group_to_case</a>(case_g);</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;                        <span class="keywordflow">if</span> (case_gext-&gt;<a class="code" href="switch__priv_8h.html#ab80befedb0affbde9ce6f7561acf9e6e">vpt</a>) <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;                        found = <span class="keyword">this</span>;</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;                        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;                }</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;                <span class="keywordflow">goto</span> do_null_case;</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;        }</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;        <span class="comment">/*</span></div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="comment">         *      Expand the template if necessary, so that it</span></div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="comment">         *      is evaluated once instead of for each &#39;case&#39;</span></div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="comment">         *      statement.</span></div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="comment">         */</span></div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="server_2tmpl_8h.html#a0da633e8a97c147e7cfff41754eaa972">tmpl_is_xlat</a>(switch_gext-&gt;<a class="code" href="switch__priv_8h.html#ad8ce89293822f6954c9022a7fae8f0a0">vpt</a>) ||</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;            <a class="code" href="server_2tmpl_8h.html#a32e9708275750f174d70fbc3cc3b20c8">tmpl_is_xlat_unresolved</a>(switch_gext-&gt;<a class="code" href="switch__priv_8h.html#ad8ce89293822f6954c9022a7fae8f0a0">vpt</a>) ||</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;            <a class="code" href="server_2tmpl_8h.html#a3eafdf3d140103b937b8cf47fbe59504">tmpl_is_exec</a>(switch_gext-&gt;<a class="code" href="switch__priv_8h.html#ad8ce89293822f6954c9022a7fae8f0a0">vpt</a>)) {</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;                <span class="keywordtype">char</span> *p;</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;                ssize_t <a class="code" href="ipaccess_8h.html#a8aed22e2c7b283705ec82e0120515618">len</a>;</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;                len = <a class="code" href="server_2tmpl_8h.html#ae024bc57caeffeddb92f4eee323e6b76">tmpl_aexpand</a>(request, &amp;p, request, switch_gext-&gt;<a class="code" href="switch__priv_8h.html#ad8ce89293822f6954c9022a7fae8f0a0">vpt</a>, NULL, NULL);</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;                <span class="keywordflow">if</span> (len &lt; 0) <span class="keywordflow">goto</span> find_null_case;</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;                <a class="code" href="server_2tmpl_8h.html#a287c154cb0ad6da4a6027e762aa2de72">tmpl_init_shallow</a>(&amp;vpt, <a class="code" href="server_2tmpl_8h.html#a6253c44d928d1abe5d85e2b02365a489a925a409742fda003b63ac53a0a96aaa9">TMPL_TYPE_DATA</a>, <a class="code" href="token_8h.html#a28164fda426e3d8b88ae9b52bffafde7a4350224762c9479edfa380d21b845945">T_SINGLE_QUOTED_STRING</a>, p, len);</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;                <a class="code" href="value_8c.html#af675e0a826689eeb4ee6a593de6c457d">fr_value_box_bstrndup_shallow</a>(&amp;vpt.<a class="code" href="server_2tmpl_8h.html#abb7e47028acb4fc2996d3489559afd39">data</a>.literal, NULL, p, len, <span class="keyword">false</span>);</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;        }</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;        <span class="comment">/*</span></div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="comment">         *      Find either the exact matching name, or the</span></div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="comment">         *      &quot;case {...}&quot; statement.</span></div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="comment">         */</span></div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">this</span> = switch_g-&gt;<a class="code" href="unlang__priv_8h.html#af27b189699bf167e3d0b32cc745ac552">children</a>; <span class="keyword">this</span>; <span class="keyword">this</span> = this-&gt;<a class="code" href="unlang__priv_8h.html#a0fe61fff5588709c463112bf511248ef">next</a>) {</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;                <a class="code" href="unlang__priv_8h.html#structunlang__group__t">unlang_group_t</a>          *case_g;</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;                <a class="code" href="switch__priv_8h.html#structunlang__case__t">unlang_case_t</a>   *case_gext;</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;                <a class="code" href="rad__assert_8h.html#ae8fbce32ab994abf84b95a7c57de209a">fr_assert</a>(this-&gt;type == <a class="code" href="unlang__priv_8h.html#a9125308c5289036c4809f39fc5fcf7eba5d68a4e7663a1cd15b5a120175fd3f66">UNLANG_TYPE_CASE</a>);</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;                case_g = <a class="code" href="unlang__priv_8h.html#aac8f5c5ad9dc7c337553f920e1a181d4">unlang_generic_to_group</a>(<span class="keyword">this</span>);</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;                case_gext = <a class="code" href="switch__priv_8h.html#ad136d9125de0013659f36a95ce1fcb27">unlang_group_to_case</a>(case_g);</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;                <span class="comment">/*</span></div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="comment">                 *      Remember the default case</span></div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="comment">                 */</span></div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;                <span class="keywordflow">if</span> (!case_gext-&gt;<a class="code" href="switch__priv_8h.html#ab80befedb0affbde9ce6f7561acf9e6e">vpt</a>) {</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;                        <span class="keywordflow">if</span> (!null_case) null_case = <span class="keyword">this</span>;</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;                        <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;                }</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;                <span class="comment">/*</span></div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<span class="comment">                 *      If we&#39;re switching over an attribute</span></div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<span class="comment">                 *      AND we haven&#39;t pre-parsed the data for</span></div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;<span class="comment">                 *      the case statement, then cast the data</span></div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<span class="comment">                 *      to the type of the attribute.</span></div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;<span class="comment">                 */</span></div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="server_2tmpl_8h.html#a3d23dc2c5065ac256a7fb7931cd883b5">tmpl_is_attr</a>(switch_gext-&gt;<a class="code" href="switch__priv_8h.html#ad8ce89293822f6954c9022a7fae8f0a0">vpt</a>) &amp;&amp; !<a class="code" href="server_2tmpl_8h.html#a8faefb97c0cd22db370df3f28f56011b">tmpl_is_data</a>(case_gext-&gt;<a class="code" href="switch__priv_8h.html#ab80befedb0affbde9ce6f7561acf9e6e">vpt</a>)) {</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;                        map.<a class="code" href="map_8h.html#a5a85c5f09d52789050bf48dadcd6e3c9">rhs</a> = switch_gext-&gt;<a class="code" href="switch__priv_8h.html#ad8ce89293822f6954c9022a7fae8f0a0">vpt</a>;</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;                        map.<a class="code" href="map_8h.html#a70c36816f3c70857dbe4190bebdbb677">lhs</a> = case_gext-&gt;<a class="code" href="switch__priv_8h.html#ab80befedb0affbde9ce6f7561acf9e6e">vpt</a>;</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;                        cond.<a class="code" href="cond_8h.html#af08b8d22488bdb42ba61aeb3b5b1d1c1">cast</a> = <a class="code" href="server_2tmpl_8h.html#a05f111bc75c174486c0a8e7cbfaa638a">tmpl_da</a>(switch_gext-&gt;<a class="code" href="switch__priv_8h.html#ad8ce89293822f6954c9022a7fae8f0a0">vpt</a>);</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;                        <span class="comment">/*</span></div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;<span class="comment">                         *      Remove unnecessary casting.</span></div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="comment">                         */</span></div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;                        <span class="keywordflow">if</span> (<a class="code" href="server_2tmpl_8h.html#a3d23dc2c5065ac256a7fb7931cd883b5">tmpl_is_attr</a>(case_gext-&gt;<a class="code" href="switch__priv_8h.html#ab80befedb0affbde9ce6f7561acf9e6e">vpt</a>) &amp;&amp;</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;                            (<a class="code" href="server_2tmpl_8h.html#a05f111bc75c174486c0a8e7cbfaa638a">tmpl_da</a>(switch_gext-&gt;<a class="code" href="switch__priv_8h.html#ad8ce89293822f6954c9022a7fae8f0a0">vpt</a>)-&gt;<a class="code" href="dict_8h.html#ae8c7bc3ae3818eae7f8ccdee6a8b8b75">type</a> == <a class="code" href="server_2tmpl_8h.html#a05f111bc75c174486c0a8e7cbfaa638a">tmpl_da</a>(case_gext-&gt;<a class="code" href="switch__priv_8h.html#ab80befedb0affbde9ce6f7561acf9e6e">vpt</a>)-&gt;<a class="code" href="dict_8h.html#ae8c7bc3ae3818eae7f8ccdee6a8b8b75">type</a>)) {</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;                                cond.<a class="code" href="cond_8h.html#af08b8d22488bdb42ba61aeb3b5b1d1c1">cast</a> = NULL;</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;                        }</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;                <span class="comment">/*</span></div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="comment">                 *      Use the pre-expanded string.</span></div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;<span class="comment">                 */</span></div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;                } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="server_2tmpl_8h.html#a0da633e8a97c147e7cfff41754eaa972">tmpl_is_xlat</a>(switch_gext-&gt;<a class="code" href="switch__priv_8h.html#ad8ce89293822f6954c9022a7fae8f0a0">vpt</a>) ||</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;                           <a class="code" href="server_2tmpl_8h.html#a32e9708275750f174d70fbc3cc3b20c8">tmpl_is_xlat_unresolved</a>(switch_gext-&gt;<a class="code" href="switch__priv_8h.html#ad8ce89293822f6954c9022a7fae8f0a0">vpt</a>) ||</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;                           <a class="code" href="server_2tmpl_8h.html#a3eafdf3d140103b937b8cf47fbe59504">tmpl_is_exec</a>(switch_gext-&gt;<a class="code" href="switch__priv_8h.html#ad8ce89293822f6954c9022a7fae8f0a0">vpt</a>)) {</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;                        map.<a class="code" href="map_8h.html#a5a85c5f09d52789050bf48dadcd6e3c9">rhs</a> = case_gext-&gt;<a class="code" href="switch__priv_8h.html#ab80befedb0affbde9ce6f7561acf9e6e">vpt</a>;</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;                        map.<a class="code" href="map_8h.html#a70c36816f3c70857dbe4190bebdbb677">lhs</a> = &amp;vpt;</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;                        cond.<a class="code" href="cond_8h.html#af08b8d22488bdb42ba61aeb3b5b1d1c1">cast</a> = NULL;</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;                <span class="comment">/*</span></div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;<span class="comment">                 *      Else evaluate the &#39;switch&#39; statement.</span></div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;<span class="comment">                 */</span></div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;                } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;                        map.<a class="code" href="map_8h.html#a5a85c5f09d52789050bf48dadcd6e3c9">rhs</a> = case_gext-&gt;<a class="code" href="switch__priv_8h.html#ab80befedb0affbde9ce6f7561acf9e6e">vpt</a>;</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;                        map.<a class="code" href="map_8h.html#a70c36816f3c70857dbe4190bebdbb677">lhs</a> = switch_gext-&gt;<a class="code" href="switch__priv_8h.html#ad8ce89293822f6954c9022a7fae8f0a0">vpt</a>;</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;                        cond.<a class="code" href="cond_8h.html#af08b8d22488bdb42ba61aeb3b5b1d1c1">cast</a> = NULL;</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;                }</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="cond__eval_8c.html#ab27229c9ec6ad5533f687ec2cddc7818">cond_eval_map</a>(request, 0, &amp;cond) == 1) {</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;                        found = <span class="keyword">this</span>;</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;                        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;                }</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;        }</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;        <span class="keywordflow">if</span> (!found) found = null_case;</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;do_null_case:</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;        <span class="keywordflow">if</span> (vpt.<a class="code" href="server_2tmpl_8h.html#a9679a30b38a66bccd8daf96ac90d0840">type</a> == <a class="code" href="server_2tmpl_8h.html#a6253c44d928d1abe5d85e2b02365a489a925a409742fda003b63ac53a0a96aaa9">TMPL_TYPE_DATA</a>) <a class="code" href="value_8c.html#a6ea38f6b901bbcf6206f242e63d4f898">fr_value_box_clear_value</a>(&amp;vpt.<a class="code" href="server_2tmpl_8h.html#abb7e47028acb4fc2996d3489559afd39">data</a>.literal);</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;        <span class="comment">/*</span></div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;<span class="comment">         *      Nothing found.  Just continue, and ignore the &quot;switch&quot;</span></div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;<span class="comment">         *      statement.</span></div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;<span class="comment">         */</span></div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;        <span class="keywordflow">if</span> (!found) <span class="keywordflow">return</span> <a class="code" href="action_8h.html#ad02ab717522305fe70aab72d152fc812a0d4e12265f83be9d0d1b09b1e06a7fcc">UNLANG_ACTION_EXECUTE_NEXT</a>;</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="interpret_8c.html#a06f6fba9b6f8a9831a34c445ff1ecb9f">unlang_interpret_push</a>(request, found, frame-&gt;<a class="code" href="unlang__priv_8h.html#ab59bbe9174e9ec170b2b6fad735456c7">result</a>, <a class="code" href="unlang__priv_8h.html#a2eb2bcc75dbd1f7aa8482447d2e03e4a">UNLANG_NEXT_STOP</a>, <a class="code" href="interpret_8h.html#a54b628155bf10ce7a98f2c2875b5291f">UNLANG_SUB_FRAME</a>) &lt; 0) {</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;                *p_result = <a class="code" href="rcode_8h.html#adcc711080df76349e177fc29a641d1fba495339cd07320051ff163afcb1e12e2f">RLM_MODULE_FAIL</a>;</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="action_8h.html#ad02ab717522305fe70aab72d152fc812a43bd4a0389dfe7900024d31d430553a9">UNLANG_ACTION_STOP_PROCESSING</a>;</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;        }</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="action_8h.html#ad02ab717522305fe70aab72d152fc812a0ae46890971801229932e878d3e2b52b">UNLANG_ACTION_PUSHED_CHILD</a>;</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;}</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;</div><div class="line"><a name="l00190"></a><span class="lineno"><a class="line" href="switch_8c.html#a7b38d5ce7058bfb433fb4023ea1f42a6">  190</a></span>&#160;<span class="keyword">static</span> <a class="code" href="action_8h.html#ad02ab717522305fe70aab72d152fc812">unlang_action_t</a> <a class="code" href="switch_8c.html#a7b38d5ce7058bfb433fb4023ea1f42a6">unlang_case</a>(<a class="code" href="rcode_8h.html#adcc711080df76349e177fc29a641d1fb">rlm_rcode_t</a> *p_result, <a class="code" href="request_8h.html#structrequest__s">request_t</a> *request)</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;{</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;        <a class="code" href="unlang__priv_8h.html#structunlang__stack__t">unlang_stack_t</a>          *<a class="code" href="modules_2proto__control_2radmin_8c.html#acbb0ad34f5d8b226a09b81ea4973082d">stack</a> = request-&gt;<a class="code" href="request_8h.html#aa657d8b77f62b69d04c549bf81a30228">stack</a>;</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;        <a class="code" href="unlang__priv_8h.html#structunlang__stack__frame__t">unlang_stack_frame_t</a>    *frame = &amp;stack-&gt;<a class="code" href="unlang__priv_8h.html#a4605abd932d2e10385f6e5c234cd62e0">frame</a>[stack-&gt;<a class="code" href="unlang__priv_8h.html#a80e6b040af5d0bd35a5c7a0449c7b452">depth</a>];</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;        <a class="code" href="unlang__priv_8h.html#structunlang__s">unlang_t</a>                *instruction = frame-&gt;<a class="code" href="unlang__priv_8h.html#aca1fa2fa71442204099637da828cdd94">instruction</a>;</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;        <a class="code" href="unlang__priv_8h.html#structunlang__group__t">unlang_group_t</a>          *g;</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;        g = <a class="code" href="unlang__priv_8h.html#aac8f5c5ad9dc7c337553f920e1a181d4">unlang_generic_to_group</a>(instruction);</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;        <span class="keywordflow">if</span> (!g-&gt;<a class="code" href="unlang__priv_8h.html#af27b189699bf167e3d0b32cc745ac552">children</a>) {</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;                *p_result = <a class="code" href="rcode_8h.html#adcc711080df76349e177fc29a641d1fbaa3578451b69a6df08f4c54fa3ef5fb55">RLM_MODULE_NOOP</a>;</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="action_8h.html#ad02ab717522305fe70aab72d152fc812a618366c76a4235e924e0523024a29ce3">UNLANG_ACTION_CALCULATE_RESULT</a>;</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;        }</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="group_8c.html#a56a2028da21c88303189b3baa9cdb11e">unlang_group</a>(p_result, request);</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;}</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;</div><div class="line"><a name="l00207"></a><span class="lineno"><a class="line" href="unlang__priv_8h.html#a12512095434e22f5438a21735f75dea6">  207</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="switch_8c.html#a12512095434e22f5438a21735f75dea6">unlang_switch_init</a>(<span class="keywordtype">void</span>)</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;{</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;        <a class="code" href="lib_2unlang_2base_8c.html#a0ecfcb4b05d880692f9648311b7989e0">unlang_register</a>(<a class="code" href="unlang__priv_8h.html#a9125308c5289036c4809f39fc5fcf7eba00e4be4c4de85069a9ec613aa187b889">UNLANG_TYPE_SWITCH</a>,</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;                           &amp;(<a class="code" href="interpret_8h.html#structunlang__op__t">unlang_op_t</a>){</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;                                .name = <span class="stringliteral">&quot;switch&quot;</span>,</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;                                .interpret = <a class="code" href="switch_8c.html#a98227d8b5f78c9876102b7e58ab63d7b">unlang_switch</a>,</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;                                .debug_braces = <span class="keyword">true</span></div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;                           });</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;        <a class="code" href="lib_2unlang_2base_8c.html#a0ecfcb4b05d880692f9648311b7989e0">unlang_register</a>(<a class="code" href="unlang__priv_8h.html#a9125308c5289036c4809f39fc5fcf7eba5d68a4e7663a1cd15b5a120175fd3f66">UNLANG_TYPE_CASE</a>,</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;                           &amp;(<a class="code" href="interpret_8h.html#structunlang__op__t">unlang_op_t</a>){</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;                                .name = <span class="stringliteral">&quot;case&quot;</span>,</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;                                .interpret = <a class="code" href="switch_8c.html#a7b38d5ce7058bfb433fb4023ea1f42a6">unlang_case</a>,</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;                                .debug_braces = <span class="keyword">true</span></div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;                           });</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;}</div><div class="ttc" id="group_8c_html_a56a2028da21c88303189b3baa9cdb11e"><div class="ttname"><a href="group_8c.html#a56a2028da21c88303189b3baa9cdb11e">unlang_group</a></div><div class="ttdeci">unlang_action_t unlang_group(rlm_rcode_t *p_result, request_t *request)</div><div class="ttdef"><b>Definition:</b> <a href="group_8c_source.html#l00030">group.c:30</a></div></div>
<div class="ttc" id="rcode_8h_html_adcc711080df76349e177fc29a641d1fbaa3578451b69a6df08f4c54fa3ef5fb55"><div class="ttname"><a href="rcode_8h.html#adcc711080df76349e177fc29a641d1fbaa3578451b69a6df08f4c54fa3ef5fb55">RLM_MODULE_NOOP</a></div><div class="ttdoc">Module succeeded without doing anything. </div><div class="ttdef"><b>Definition:</b> <a href="rcode_8h_source.html#l00048">rcode.h:48</a></div></div>
<div class="ttc" id="unlang__priv_8h_html_structunlang__stack__t"><div class="ttname"><a href="unlang__priv_8h.html#structunlang__stack__t">unlang_stack_t</a></div><div class="ttdoc">An unlang stack associated with a request. </div><div class="ttdef"><b>Definition:</b> <a href="unlang__priv_8h_source.html#l00202">unlang_priv.h:202</a></div></div>
<div class="ttc" id="dict_8h_html_ae8c7bc3ae3818eae7f8ccdee6a8b8b75"><div class="ttname"><a href="dict_8h.html#ae8c7bc3ae3818eae7f8ccdee6a8b8b75">dict_attr_s::type</a></div><div class="ttdeci">fr_type_t type</div><div class="ttdoc">Value type. </div><div class="ttdef"><b>Definition:</b> <a href="dict_8h_source.html#l00143">dict.h:143</a></div></div>
<div class="ttc" id="server_2tmpl_8h_html_a3d23dc2c5065ac256a7fb7931cd883b5"><div class="ttname"><a href="server_2tmpl_8h.html#a3d23dc2c5065ac256a7fb7931cd883b5">tmpl_is_attr</a></div><div class="ttdeci">#define tmpl_is_attr(vpt)</div><div class="ttdef"><b>Definition:</b> <a href="server_2tmpl_8h_source.html#l00226">tmpl.h:226</a></div></div>
<div class="ttc" id="rad__assert_8h_html_ae8fbce32ab994abf84b95a7c57de209a"><div class="ttname"><a href="rad__assert_8h.html#ae8fbce32ab994abf84b95a7c57de209a">fr_assert</a></div><div class="ttdeci">#define fr_assert(_expr)</div><div class="ttdef"><b>Definition:</b> <a href="rad__assert_8h_source.html#l00038">rad_assert.h:38</a></div></div>
<div class="ttc" id="switch__priv_8h_html_ad136d9125de0013659f36a95ce1fcb27"><div class="ttname"><a href="switch__priv_8h.html#ad136d9125de0013659f36a95ce1fcb27">unlang_group_to_case</a></div><div class="ttdeci">static unlang_case_t * unlang_group_to_case(unlang_group_t *g)</div><div class="ttdoc">Cast a group structure to the case keyword extension. </div><div class="ttdef"><b>Definition:</b> <a href="switch__priv_8h_source.html#l00060">switch_priv.h:60</a></div></div>
<div class="ttc" id="cond_8h_html_structfr__cond__s"><div class="ttname"><a href="cond_8h.html#structfr__cond__s">fr_cond_s</a></div><div class="ttdef"><b>Definition:</b> <a href="cond_8h_source.html#l00080">cond.h:80</a></div></div>
<div class="ttc" id="switch_8c_html_a7b38d5ce7058bfb433fb4023ea1f42a6"><div class="ttname"><a href="switch_8c.html#a7b38d5ce7058bfb433fb4023ea1f42a6">unlang_case</a></div><div class="ttdeci">static unlang_action_t unlang_case(rlm_rcode_t *p_result, request_t *request)</div><div class="ttdef"><b>Definition:</b> <a href="switch_8c_source.html#l00190">switch.c:190</a></div></div>
<div class="ttc" id="unlang__priv_8h_html_af27b189699bf167e3d0b32cc745ac552"><div class="ttname"><a href="unlang__priv_8h.html#af27b189699bf167e3d0b32cc745ac552">unlang_group_t::children</a></div><div class="ttdeci">unlang_t * children</div><div class="ttdoc">Children beneath this group. </div><div class="ttdef"><b>Definition:</b> <a href="unlang__priv_8h_source.html#l00142">unlang_priv.h:142</a></div></div>
<div class="ttc" id="server_2tmpl_8h_html_a05f111bc75c174486c0a8e7cbfaa638a"><div class="ttname"><a href="server_2tmpl_8h.html#a05f111bc75c174486c0a8e7cbfaa638a">tmpl_da</a></div><div class="ttdeci">static fr_dict_attr_t const  * tmpl_da(tmpl_t const *vpt)</div><div class="ttdef"><b>Definition:</b> <a href="server_2tmpl_8h_source.html#l00602">tmpl.h:602</a></div></div>
<div class="ttc" id="cf__util_8c_html_a11cfb91b7dd7bf343a4031ba7846c2ad"><div class="ttname"><a href="cf__util_8c.html#a11cfb91b7dd7bf343a4031ba7846c2ad">cf_section_to_item</a></div><div class="ttdeci">CONF_ITEM * cf_section_to_item(CONF_SECTION const *cs)</div><div class="ttdoc">Cast a CONF_SECTION to a CONF_ITEM. </div><div class="ttdef"><b>Definition:</b> <a href="cf__util_8c_source.html#l00673">cf_util.c:673</a></div></div>
<div class="ttc" id="action_8h_html_ad02ab717522305fe70aab72d152fc812a0ae46890971801229932e878d3e2b52b"><div class="ttname"><a href="action_8h.html#ad02ab717522305fe70aab72d152fc812a0ae46890971801229932e878d3e2b52b">UNLANG_ACTION_PUSHED_CHILD</a></div><div class="ttdoc">unlang_t pushed a new child onto the stack, execute it instead of continuing. </div><div class="ttdef"><b>Definition:</b> <a href="action_8h_source.html#l00038">action.h:38</a></div></div>
<div class="ttc" id="switch_8c_html_a12512095434e22f5438a21735f75dea6"><div class="ttname"><a href="switch_8c.html#a12512095434e22f5438a21735f75dea6">unlang_switch_init</a></div><div class="ttdeci">void unlang_switch_init(void)</div><div class="ttdef"><b>Definition:</b> <a href="switch_8c_source.html#l00207">switch.c:207</a></div></div>
<div class="ttc" id="request_8h_html_aa657d8b77f62b69d04c549bf81a30228"><div class="ttname"><a href="request_8h.html#aa657d8b77f62b69d04c549bf81a30228">request_s::stack</a></div><div class="ttdeci">void * stack</div><div class="ttdoc">unlang interpreter stack. </div><div class="ttdef"><b>Definition:</b> <a href="request_8h_source.html#l00125">request.h:125</a></div></div>
<div class="ttc" id="unlang__priv_8h_html_a1a481704ce6ad0a8cb0cc6b2280e60fa"><div class="ttname"><a href="unlang__priv_8h.html#a1a481704ce6ad0a8cb0cc6b2280e60fa">unlang_group_t::cs</a></div><div class="ttdeci">CONF_SECTION * cs</div><div class="ttdef"><b>Definition:</b> <a href="unlang__priv_8h_source.html#l00145">unlang_priv.h:145</a></div></div>
<div class="ttc" id="interpret_8c_html_a06f6fba9b6f8a9831a34c445ff1ecb9f"><div class="ttname"><a href="interpret_8c.html#a06f6fba9b6f8a9831a34c445ff1ecb9f">unlang_interpret_push</a></div><div class="ttdeci">int unlang_interpret_push(request_t *request, unlang_t *instruction, rlm_rcode_t default_rcode, bool do_next_sibling, bool top_frame)</div><div class="ttdoc">Push a new frame onto the stack. </div><div class="ttdef"><b>Definition:</b> <a href="interpret_8c_source.html#l00170">interpret.c:170</a></div></div>
<div class="ttc" id="server_2tmpl_8h_html_a8faefb97c0cd22db370df3f28f56011b"><div class="ttname"><a href="server_2tmpl_8h.html#a8faefb97c0cd22db370df3f28f56011b">tmpl_is_data</a></div><div class="ttdeci">#define tmpl_is_data(vpt)</div><div class="ttdef"><b>Definition:</b> <a href="server_2tmpl_8h_source.html#l00224">tmpl.h:224</a></div></div>
<div class="ttc" id="map_8h_html_a08684c8861f48325d03a6b25caf24282"><div class="ttname"><a href="map_8h.html#a08684c8861f48325d03a6b25caf24282">vp_map_s::ci</a></div><div class="ttdeci">CONF_ITEM * ci</div><div class="ttdoc">Config item that the map was created from. </div><div class="ttdef"><b>Definition:</b> <a href="map_8h_source.html#l00077">map.h:77</a></div></div>
<div class="ttc" id="rcode_8h_html_adcc711080df76349e177fc29a641d1fb"><div class="ttname"><a href="rcode_8h.html#adcc711080df76349e177fc29a641d1fb">rlm_rcode_t</a></div><div class="ttdeci">rlm_rcode_t</div><div class="ttdoc">Return codes indicating the result of the module call. </div><div class="ttdef"><b>Definition:</b> <a href="rcode_8h_source.html#l00040">rcode.h:40</a></div></div>
<div class="ttc" id="unlang__priv_8h_html_structunlang__stack__frame__t"><div class="ttname"><a href="unlang__priv_8h.html#structunlang__stack__frame__t">unlang_stack_frame_t</a></div><div class="ttdoc">Our interpreter stack, as distinct from the C stack. </div><div class="ttdef"><b>Definition:</b> <a href="unlang__priv_8h_source.html#l00172">unlang_priv.h:172</a></div></div>
<div class="ttc" id="switch__priv_8h_html_ad8ce89293822f6954c9022a7fae8f0a0"><div class="ttname"><a href="switch__priv_8h.html#ad8ce89293822f6954c9022a7fae8f0a0">unlang_switch_t::vpt</a></div><div class="ttdeci">tmpl_t * vpt</div><div class="ttdef"><b>Definition:</b> <a href="switch__priv_8h_source.html#l00033">switch_priv.h:33</a></div></div>
<div class="ttc" id="rlm__expr_8c_html_a67a61c02f0eccbad6b342dd9adeb7994"><div class="ttname"><a href="rlm__expr_8c.html#a67a61c02f0eccbad6b342dd9adeb7994">map</a></div><div class="ttdeci">static expr_map_t map[]</div><div class="ttdef"><b>Definition:</b> <a href="rlm__expr_8c_source.html#l00144">rlm_expr.c:144</a></div></div>
<div class="ttc" id="group__priv_8h_html"><div class="ttname"><a href="group__priv_8h.html">group_priv.h</a></div><div class="ttdoc">Declarations for the &quot;group&quot; keyword. </div></div>
<div class="ttc" id="server_2tmpl_8h_html_a0da633e8a97c147e7cfff41754eaa972"><div class="ttname"><a href="server_2tmpl_8h.html#a0da633e8a97c147e7cfff41754eaa972">tmpl_is_xlat</a></div><div class="ttdeci">#define tmpl_is_xlat(vpt)</div><div class="ttdef"><b>Definition:</b> <a href="server_2tmpl_8h_source.html#l00229">tmpl.h:229</a></div></div>
<div class="ttc" id="cond_8h_html_adc7d308924b2ebc59aa439692da92eab"><div class="ttname"><a href="cond_8h.html#adc7d308924b2ebc59aa439692da92eab">fr_cond_s::type</a></div><div class="ttdeci">fr_cond_type_t type</div><div class="ttdef"><b>Definition:</b> <a href="cond_8h_source.html#l00081">cond.h:81</a></div></div>
<div class="ttc" id="cond__eval_8c_html_ab27229c9ec6ad5533f687ec2cddc7818"><div class="ttname"><a href="cond__eval_8c.html#ab27229c9ec6ad5533f687ec2cddc7818">cond_eval_map</a></div><div class="ttdeci">int cond_eval_map(request_t *request, UNUSED int depth, fr_cond_t const *c)</div><div class="ttdoc">Evaluate a map. </div><div class="ttdef"><b>Definition:</b> <a href="cond__eval_8c_source.html#l00631">cond_eval.c:631</a></div></div>
<div class="ttc" id="map_8h_html_a70c36816f3c70857dbe4190bebdbb677"><div class="ttname"><a href="map_8h.html#a70c36816f3c70857dbe4190bebdbb677">vp_map_s::lhs</a></div><div class="ttdeci">tmpl_t * lhs</div><div class="ttdoc">Typically describes the attribute to add, modify or compare. </div><div class="ttdef"><b>Definition:</b> <a href="map_8h_source.html#l00070">map.h:70</a></div></div>
<div class="ttc" id="action_8h_html_ad02ab717522305fe70aab72d152fc812a618366c76a4235e924e0523024a29ce3"><div class="ttname"><a href="action_8h.html#ad02ab717522305fe70aab72d152fc812a618366c76a4235e924e0523024a29ce3">UNLANG_ACTION_CALCULATE_RESULT</a></div><div class="ttdoc">Calculate a new section rlm_rcode_t value. </div><div class="ttdef"><b>Definition:</b> <a href="action_8h_source.html#l00036">action.h:36</a></div></div>
<div class="ttc" id="switch__priv_8h_html_structunlang__switch__t"><div class="ttname"><a href="switch__priv_8h.html#structunlang__switch__t">unlang_switch_t</a></div><div class="ttdef"><b>Definition:</b> <a href="switch__priv_8h_source.html#l00031">switch_priv.h:31</a></div></div>
<div class="ttc" id="interpret_8h_html_structunlang__op__t"><div class="ttname"><a href="interpret_8h.html#structunlang__op__t">unlang_op_t</a></div><div class="ttdoc">An unlang operation. </div><div class="ttdef"><b>Definition:</b> <a href="interpret_8h_source.html#l00070">interpret.h:70</a></div></div>
<div class="ttc" id="value_8c_html_a6ea38f6b901bbcf6206f242e63d4f898"><div class="ttname"><a href="value_8c.html#a6ea38f6b901bbcf6206f242e63d4f898">fr_value_box_clear_value</a></div><div class="ttdeci">void fr_value_box_clear_value(fr_value_box_t *data)</div><div class="ttdoc">Clear/free any existing value. </div><div class="ttdef"><b>Definition:</b> <a href="value_8c_source.html#l03108">value.c:3108</a></div></div>
<div class="ttc" id="lib_2unlang_2base_8c_html_a0ecfcb4b05d880692f9648311b7989e0"><div class="ttname"><a href="lib_2unlang_2base_8c.html#a0ecfcb4b05d880692f9648311b7989e0">unlang_register</a></div><div class="ttdeci">void unlang_register(int type, unlang_op_t *op)</div><div class="ttdoc">Register an operation with the interpreter. </div><div class="ttdef"><b>Definition:</b> <a href="lib_2unlang_2base_8c_source.html#l00061">base.c:61</a></div></div>
<div class="ttc" id="switch__priv_8h_html_structunlang__case__t"><div class="ttname"><a href="switch__priv_8h.html#structunlang__case__t">unlang_case_t</a></div><div class="ttdef"><b>Definition:</b> <a href="switch__priv_8h_source.html#l00052">switch_priv.h:52</a></div></div>
<div class="ttc" id="token_8h_html_a28164fda426e3d8b88ae9b52bffafde7a4350224762c9479edfa380d21b845945"><div class="ttname"><a href="token_8h.html#a28164fda426e3d8b88ae9b52bffafde7a4350224762c9479edfa380d21b845945">T_SINGLE_QUOTED_STRING</a></div><div class="ttdef"><b>Definition:</b> <a href="token_8h_source.html#l00066">token.h:66</a></div></div>
<div class="ttc" id="cond_8h_html_a0b51bf1aabbd4b510bb4201785c9e006"><div class="ttname"><a href="cond_8h.html#a0b51bf1aabbd4b510bb4201785c9e006">fr_cond_s::data</a></div><div class="ttdeci">union fr_cond_s::@41 data</div></div>
<div class="ttc" id="server_2tmpl_8h_html_abb7e47028acb4fc2996d3489559afd39"><div class="ttname"><a href="server_2tmpl_8h.html#abb7e47028acb4fc2996d3489559afd39">tmpl_s::data</a></div><div class="ttdeci">union tmpl_s::@51 data</div></div>
<div class="ttc" id="rcode_8h_html_adcc711080df76349e177fc29a641d1fba495339cd07320051ff163afcb1e12e2f"><div class="ttname"><a href="rcode_8h.html#adcc711080df76349e177fc29a641d1fba495339cd07320051ff163afcb1e12e2f">RLM_MODULE_FAIL</a></div><div class="ttdoc">Module failed, don&amp;#39;t reply. </div><div class="ttdef"><b>Definition:</b> <a href="rcode_8h_source.html#l00042">rcode.h:42</a></div></div>
<div class="ttc" id="server_2tmpl_8h_html_a287c154cb0ad6da4a6027e762aa2de72"><div class="ttname"><a href="server_2tmpl_8h.html#a287c154cb0ad6da4a6027e762aa2de72">tmpl_init_shallow</a></div><div class="ttdeci">tmpl_t * tmpl_init_shallow(tmpl_t *vpt, tmpl_type_t type, fr_token_t quote, char const *name, ssize_t len)</div><div class="ttdoc">Initialise a tmpl without copying the input name string. </div><div class="ttdef"><b>Definition:</b> <a href="tmpl__tokenize_8c_source.html#l00561">tmpl_tokenize.c:561</a></div></div>
<div class="ttc" id="server_2tmpl_8h_html_structtmpl__s"><div class="ttname"><a href="server_2tmpl_8h.html#structtmpl__s">tmpl_s</a></div><div class="ttdoc">A source or sink of value data. </div><div class="ttdef"><b>Definition:</b> <a href="server_2tmpl_8h_source.html#l00426">tmpl.h:426</a></div></div>
<div class="ttc" id="unlang__priv_8h_html_structunlang__s"><div class="ttname"><a href="unlang__priv_8h.html#structunlang__s">unlang_s</a></div><div class="ttdoc">A node in a graph of unlang_op_t (s) that we execute. </div><div class="ttdef"><b>Definition:</b> <a href="unlang__priv_8h_source.html#l00115">unlang_priv.h:115</a></div></div>
<div class="ttc" id="map_8h_html_a5a85c5f09d52789050bf48dadcd6e3c9"><div class="ttname"><a href="map_8h.html#a5a85c5f09d52789050bf48dadcd6e3c9">vp_map_s::rhs</a></div><div class="ttdeci">tmpl_t * rhs</div><div class="ttdoc">Typically describes a literal value or a src attribute. </div><div class="ttdef"><b>Definition:</b> <a href="map_8h_source.html#l00071">map.h:71</a></div></div>
<div class="ttc" id="unlang__priv_8h_html_aca1fa2fa71442204099637da828cdd94"><div class="ttname"><a href="unlang__priv_8h.html#aca1fa2fa71442204099637da828cdd94">unlang_stack_frame_t::instruction</a></div><div class="ttdeci">unlang_t * instruction</div><div class="ttdoc">The unlang node we&amp;#39;re evaluating. </div><div class="ttdef"><b>Definition:</b> <a href="unlang__priv_8h_source.html#l00173">unlang_priv.h:173</a></div></div>
<div class="ttc" id="unlang__priv_8h_html_a9125308c5289036c4809f39fc5fcf7eba00e4be4c4de85069a9ec613aa187b889"><div class="ttname"><a href="unlang__priv_8h.html#a9125308c5289036c4809f39fc5fcf7eba00e4be4c4de85069a9ec613aa187b889">UNLANG_TYPE_SWITCH</a></div><div class="ttdoc">Switch section. </div><div class="ttdef"><b>Definition:</b> <a href="unlang__priv_8h_source.html#l00068">unlang_priv.h:68</a></div></div>
<div class="ttc" id="interpret_8h_html_a54b628155bf10ce7a98f2c2875b5291f"><div class="ttname"><a href="interpret_8h.html#a54b628155bf10ce7a98f2c2875b5291f">UNLANG_SUB_FRAME</a></div><div class="ttdeci">#define UNLANG_SUB_FRAME</div><div class="ttdef"><b>Definition:</b> <a href="interpret_8h_source.html#l00034">interpret.h:34</a></div></div>
<div class="ttc" id="build_8h_html_addf5ec070e9499d36b7f2009ce736076"><div class="ttname"><a href="build_8h.html#addf5ec070e9499d36b7f2009ce736076">UNUSED</a></div><div class="ttdeci">#define UNUSED</div><div class="ttdef"><b>Definition:</b> <a href="build_8h_source.html#l00124">build.h:124</a></div></div>
<div class="ttc" id="cond_8h_html_af08b8d22488bdb42ba61aeb3b5b1d1c1"><div class="ttname"><a href="cond_8h.html#af08b8d22488bdb42ba61aeb3b5b1d1c1">fr_cond_s::cast</a></div><div class="ttdeci">fr_dict_attr_t const  * cast</div><div class="ttdoc">Legacy - Should be removed. </div><div class="ttdef"><b>Definition:</b> <a href="cond_8h_source.html#l00097">cond.h:97</a></div></div>
<div class="ttc" id="server_2tmpl_8h_html_a6253c44d928d1abe5d85e2b02365a489a925a409742fda003b63ac53a0a96aaa9"><div class="ttname"><a href="server_2tmpl_8h.html#a6253c44d928d1abe5d85e2b02365a489a925a409742fda003b63ac53a0a96aaa9">TMPL_TYPE_DATA</a></div><div class="ttdoc">Value in native boxed format. </div><div class="ttdef"><b>Definition:</b> <a href="server_2tmpl_8h_source.html#l00152">tmpl.h:152</a></div></div>
<div class="ttc" id="server_2tmpl_8h_html_a3eafdf3d140103b937b8cf47fbe59504"><div class="ttname"><a href="server_2tmpl_8h.html#a3eafdf3d140103b937b8cf47fbe59504">tmpl_is_exec</a></div><div class="ttdeci">#define tmpl_is_exec(vpt)</div><div class="ttdef"><b>Definition:</b> <a href="server_2tmpl_8h_source.html#l00230">tmpl.h:230</a></div></div>
<div class="ttc" id="cond_8h_html_aa1a5aa02b488ff1199d02a1b00597bfcaa6c4d3e5aed0383fbd90d44b524c2a2e"><div class="ttname"><a href="cond_8h.html#aa1a5aa02b488ff1199d02a1b00597bfcaa6c4d3e5aed0383fbd90d44b524c2a2e">COND_TYPE_MAP</a></div><div class="ttdef"><b>Definition:</b> <a href="cond_8h_source.html#l00060">cond.h:60</a></div></div>
<div class="ttc" id="action_8h_html_ad02ab717522305fe70aab72d152fc812a0d4e12265f83be9d0d1b09b1e06a7fcc"><div class="ttname"><a href="action_8h.html#ad02ab717522305fe70aab72d152fc812a0d4e12265f83be9d0d1b09b1e06a7fcc">UNLANG_ACTION_EXECUTE_NEXT</a></div><div class="ttdoc">Execute the next unlang_t. </div><div class="ttdef"><b>Definition:</b> <a href="action_8h_source.html#l00037">action.h:37</a></div></div>
<div class="ttc" id="map_8h_html_a4f5dcea8b5109909db55f18b72a8ffdf"><div class="ttname"><a href="map_8h.html#a4f5dcea8b5109909db55f18b72a8ffdf">vp_map_s::op</a></div><div class="ttdeci">fr_token_t op</div><div class="ttdoc">The operator that controls insertion of the dst attribute. </div><div class="ttdef"><b>Definition:</b> <a href="map_8h_source.html#l00074">map.h:74</a></div></div>
<div class="ttc" id="modules_2proto__control_2radmin_8c_html_acbb0ad34f5d8b226a09b81ea4973082d"><div class="ttname"><a href="modules_2proto__control_2radmin_8c.html#acbb0ad34f5d8b226a09b81ea4973082d">stack</a></div><div class="ttdeci">static char * stack[MAX_STACK]</div><div class="ttdef"><b>Definition:</b> <a href="modules_2proto__control_2radmin_8c_source.html#l00159">radmin.c:159</a></div></div>
<div class="ttc" id="server_2tmpl_8h_html_ae024bc57caeffeddb92f4eee323e6b76"><div class="ttname"><a href="server_2tmpl_8h.html#ae024bc57caeffeddb92f4eee323e6b76">tmpl_aexpand</a></div><div class="ttdeci">#define tmpl_aexpand(_ctx, _out, _request, _vpt, _escape, _escape_ctx)</div><div class="ttdoc">Expand a tmpl to a C type, allocing a new buffer to hold the string. </div><div class="ttdef"><b>Definition:</b> <a href="server_2tmpl_8h_source.html#l00826">tmpl.h:826</a></div></div>
<div class="ttc" id="server_2tmpl_8h_html_a0d370ecb367dac1d9fdc49a185355bd4"><div class="ttname"><a href="server_2tmpl_8h.html#a0d370ecb367dac1d9fdc49a185355bd4">tmpl_find_vp</a></div><div class="ttdeci">int tmpl_find_vp(fr_pair_t **out, request_t *request, tmpl_t const *vpt)</div><div class="ttdoc">Returns the first VP matching a tmpl_t. </div><div class="ttdef"><b>Definition:</b> <a href="tmpl__eval_8c_source.html#l01403">tmpl_eval.c:1403</a></div></div>
<div class="ttc" id="switch_8c_html_a98227d8b5f78c9876102b7e58ab63d7b"><div class="ttname"><a href="switch_8c.html#a98227d8b5f78c9876102b7e58ab63d7b">unlang_switch</a></div><div class="ttdeci">static unlang_action_t unlang_switch(UNUSED rlm_rcode_t *p_result, request_t *request)</div><div class="ttdef"><b>Definition:</b> <a href="switch_8c_source.html#l00033">switch.c:33</a></div></div>
<div class="ttc" id="action_8h_html_ad02ab717522305fe70aab72d152fc812"><div class="ttname"><a href="action_8h.html#ad02ab717522305fe70aab72d152fc812">unlang_action_t</a></div><div class="ttdeci">unlang_action_t</div><div class="ttdoc">Returned by unlang_op_t calls, determine the next action of the interpreter. </div><div class="ttdef"><b>Definition:</b> <a href="action_8h_source.html#l00035">action.h:35</a></div></div>
<div class="ttc" id="server_2tmpl_8h_html_a32e9708275750f174d70fbc3cc3b20c8"><div class="ttname"><a href="server_2tmpl_8h.html#a32e9708275750f174d70fbc3cc3b20c8">tmpl_is_xlat_unresolved</a></div><div class="ttdeci">#define tmpl_is_xlat_unresolved(vpt)</div><div class="ttdef"><b>Definition:</b> <a href="server_2tmpl_8h_source.html#l00239">tmpl.h:239</a></div></div>
<div class="ttc" id="value_8c_html_af675e0a826689eeb4ee6a593de6c457d"><div class="ttname"><a href="value_8c.html#af675e0a826689eeb4ee6a593de6c457d">fr_value_box_bstrndup_shallow</a></div><div class="ttdeci">void fr_value_box_bstrndup_shallow(fr_value_box_t *dst, fr_dict_attr_t const *enumv, char const *src, size_t len, bool tainted)</div><div class="ttdoc">Assign a string to to a fr_value_box_t. </div><div class="ttdef"><b>Definition:</b> <a href="value_8c_source.html#l03584">value.c:3584</a></div></div>
<div class="ttc" id="switch__priv_8h_html_ab52a777157c7127065a6846884132c49"><div class="ttname"><a href="switch__priv_8h.html#ab52a777157c7127065a6846884132c49">unlang_group_to_switch</a></div><div class="ttdeci">static unlang_switch_t * unlang_group_to_switch(unlang_group_t *g)</div><div class="ttdoc">Cast a group structure to the switch keyword extension. </div><div class="ttdef"><b>Definition:</b> <a href="switch__priv_8h_source.html#l00039">switch_priv.h:39</a></div></div>
<div class="ttc" id="unlang__priv_8h_html_a4605abd932d2e10385f6e5c234cd62e0"><div class="ttname"><a href="unlang__priv_8h.html#a4605abd932d2e10385f6e5c234cd62e0">unlang_stack_t::frame</a></div><div class="ttdeci">unlang_stack_frame_t frame[UNLANG_STACK_MAX]</div><div class="ttdoc">The stack... </div><div class="ttdef"><b>Definition:</b> <a href="unlang__priv_8h_source.html#l00207">unlang_priv.h:207</a></div></div>
<div class="ttc" id="server_2tmpl_8h_html_a9679a30b38a66bccd8daf96ac90d0840"><div class="ttname"><a href="server_2tmpl_8h.html#a9679a30b38a66bccd8daf96ac90d0840">tmpl_s::type</a></div><div class="ttdeci">tmpl_type_t _CONST type</div><div class="ttdoc">What type of value tmpl refers to. </div><div class="ttdef"><b>Definition:</b> <a href="server_2tmpl_8h_source.html#l00427">tmpl.h:427</a></div></div>
<div class="ttc" id="unlang__priv_8h_html_aac8f5c5ad9dc7c337553f920e1a181d4"><div class="ttname"><a href="unlang__priv_8h.html#aac8f5c5ad9dc7c337553f920e1a181d4">unlang_generic_to_group</a></div><div class="ttdeci">static unlang_group_t * unlang_generic_to_group(unlang_t *p)</div><div class="ttdef"><b>Definition:</b> <a href="unlang__priv_8h_source.html#l00271">unlang_priv.h:271</a></div></div>
<div class="ttc" id="unlang__priv_8h_html_a0fe61fff5588709c463112bf511248ef"><div class="ttname"><a href="unlang__priv_8h.html#a0fe61fff5588709c463112bf511248ef">unlang_s::next</a></div><div class="ttdeci">unlang_t * next</div><div class="ttdoc">Next node (executed on UNLANG_ACTION_EXECUTE_NEXT et al). </div><div class="ttdef"><b>Definition:</b> <a href="unlang__priv_8h_source.html#l00117">unlang_priv.h:117</a></div></div>
<div class="ttc" id="action_8h_html_ad02ab717522305fe70aab72d152fc812a43bd4a0389dfe7900024d31d430553a9"><div class="ttname"><a href="action_8h.html#ad02ab717522305fe70aab72d152fc812a43bd4a0389dfe7900024d31d430553a9">UNLANG_ACTION_STOP_PROCESSING</a></div><div class="ttdoc">Break out of processing the current request (unwind). </div><div class="ttdef"><b>Definition:</b> <a href="action_8h_source.html#l00042">action.h:42</a></div></div>
<div class="ttc" id="switch__priv_8h_html_ab80befedb0affbde9ce6f7561acf9e6e"><div class="ttname"><a href="switch__priv_8h.html#ab80befedb0affbde9ce6f7561acf9e6e">unlang_case_t::vpt</a></div><div class="ttdeci">tmpl_t * vpt</div><div class="ttdef"><b>Definition:</b> <a href="switch__priv_8h_source.html#l00054">switch_priv.h:54</a></div></div>
<div class="ttc" id="map_8h_html_structvp__map__s"><div class="ttname"><a href="map_8h.html#structvp__map__s">vp_map_s</a></div><div class="ttdoc">Value pair map. </div><div class="ttdef"><b>Definition:</b> <a href="map_8h_source.html#l00069">map.h:69</a></div></div>
<div class="ttc" id="unlang__priv_8h_html_a9125308c5289036c4809f39fc5fcf7eba5d68a4e7663a1cd15b5a120175fd3f66"><div class="ttname"><a href="unlang__priv_8h.html#a9125308c5289036c4809f39fc5fcf7eba5d68a4e7663a1cd15b5a120175fd3f66">UNLANG_TYPE_CASE</a></div><div class="ttdoc">Case section (within a UNLANG_TYPE_SWITCH). </div><div class="ttdef"><b>Definition:</b> <a href="unlang__priv_8h_source.html#l00069">unlang_priv.h:69</a></div></div>
<div class="ttc" id="unlang__priv_8h_html_structunlang__group__t"><div class="ttname"><a href="unlang__priv_8h.html#structunlang__group__t">unlang_group_t</a></div><div class="ttdoc">Generic representation of a grouping. </div><div class="ttdef"><b>Definition:</b> <a href="unlang__priv_8h_source.html#l00140">unlang_priv.h:140</a></div></div>
<div class="ttc" id="token_8h_html_a28164fda426e3d8b88ae9b52bffafde7aa05bbdd5100a8af99b04349ce8977319"><div class="ttname"><a href="token_8h.html#a28164fda426e3d8b88ae9b52bffafde7aa05bbdd5100a8af99b04349ce8977319">T_OP_CMP_EQ</a></div><div class="ttdef"><b>Definition:</b> <a href="token_8h_source.html#l00062">token.h:62</a></div></div>
<div class="ttc" id="unlang__priv_8h_html_ab59bbe9174e9ec170b2b6fad735456c7"><div class="ttname"><a href="unlang__priv_8h.html#ab59bbe9174e9ec170b2b6fad735456c7">unlang_stack_frame_t::result</a></div><div class="ttdeci">rlm_rcode_t result</div><div class="ttdoc">The result from executing the instruction. </div><div class="ttdef"><b>Definition:</b> <a href="unlang__priv_8h_source.html#l00190">unlang_priv.h:190</a></div></div>
<div class="ttc" id="build_8h_html_a17c6430174bd106c2fa80061361f0f7b"><div class="ttname"><a href="build_8h.html#a17c6430174bd106c2fa80061361f0f7b">RCSID</a></div><div class="ttdeci">#define RCSID(id)</div><div class="ttdef"><b>Definition:</b> <a href="build_8h_source.html#l00218">build.h:218</a></div></div>
<div class="ttc" id="unlang__priv_8h_html_a80e6b040af5d0bd35a5c7a0449c7b452"><div class="ttname"><a href="unlang__priv_8h.html#a80e6b040af5d0bd35a5c7a0449c7b452">unlang_stack_t::depth</a></div><div class="ttdeci">int depth</div><div class="ttdoc">Current depth we&amp;#39;re executing at. </div><div class="ttdef"><b>Definition:</b> <a href="unlang__priv_8h_source.html#l00204">unlang_priv.h:204</a></div></div>
<div class="ttc" id="unlang__priv_8h_html_a2eb2bcc75dbd1f7aa8482447d2e03e4a"><div class="ttname"><a href="unlang__priv_8h.html#a2eb2bcc75dbd1f7aa8482447d2e03e4a">UNLANG_NEXT_STOP</a></div><div class="ttdeci">#define UNLANG_NEXT_STOP</div><div class="ttdef"><b>Definition:</b> <a href="unlang__priv_8h_source.html#l00096">unlang_priv.h:96</a></div></div>
<div class="ttc" id="request_8h_html_structrequest__s"><div class="ttname"><a href="request_8h.html#structrequest__s">request_s</a></div><div class="ttdef"><b>Definition:</b> <a href="request_8h_source.html#l00083">request.h:83</a></div></div>
<div class="ttc" id="unlang__priv_8h_html"><div class="ttname"><a href="unlang__priv_8h.html">unlang_priv.h</a></div><div class="ttdoc">Private interpreter structures and functions. </div></div>
<div class="ttc" id="ipaccess_8h_html_a8aed22e2c7b283705ec82e0120515618"><div class="ttname"><a href="ipaccess_8h.html#a8aed22e2c7b283705ec82e0120515618">len</a></div><div class="ttdeci">uint16_t len</div><div class="ttdef"><b>Definition:</b> <a href="ipaccess_8h_source.html#l00047">ipaccess.h:47</a></div></div>
<div class="ttc" id="switch__priv_8h_html"><div class="ttname"><a href="switch__priv_8h.html">switch_priv.h</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Fri Nov 13 2020 22:11:08 by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
