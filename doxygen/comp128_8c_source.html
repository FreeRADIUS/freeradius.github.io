<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>/home/runner/work/freeradius-server/freeradius-server/src/lib/sim/comp128.c Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="freeradius.png"/></td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_c85d3e3c5052e9ad9ce18c6863244a25.html">lib</a></li><li class="navelem"><a class="el" href="dir_794c1bacd89d5c58c75c4338ddce4a3f.html">sim</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">comp128.c</div>  </div>
</div><!--header-->
<div class="contents">
<a href="comp128_8c.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"> *   This program is is free software; you can redistribute it and/or modify</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"> *   it under the terms of the GNU General Public License as published by</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"> *   the Free Software Foundation; either version 2 of the License, or (at</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment"> *   your option) any later version.</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment"> *   This program is distributed in the hope that it will be useful,</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment"> *   but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment"> *   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment"> *   GNU General Public License for more details.</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment"> *   You should have received a copy of the GNU General Public License</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment"> *   along with this program; if not, write to the Free Software</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment"> *   Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301, USA</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">/**</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment"> * @file comp128.c</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment"> * @brief Implementations of comp128v1, comp128v2, comp128v3 algorithms</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment"> * Comp128v1 was inspired by code from:</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment"> *  Marc Briceno &lt;marc@scard.org&gt;, Ian Goldberg &lt;iang@cs.berkeley.edu&gt;,</span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment"> *  and David Wagner &lt;daw@cs.berkeley.edu&gt;</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment"> * But it has been fully rewritten (Sylvain Munaut &lt;tnt@246tNt.com&gt;) from various PDFs found online</span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment"> * describing the algorithm because the licence of the code referenced above was unclear.</span></div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment"> * A comment snippet from the original code is included below, it describes where the doc came</span></div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment"> * from and how the algorithm was reverse engineered.</span></div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment"> * Comp128v2 &amp; v3 is a port of the python code from:</span></div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment"> *   http://www.hackingprojects.net/</span></div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="comment"> * The author of the original code is Tamas Jos &lt;tamas.jos@skelsec.com&gt;</span></div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="comment"> * @note The above GPL license only applies to comp128v1, the license for comp128v2 and comp128v3 is unknown.</span></div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment"> * @copyright 2013 The FreeRADIUS server project</span></div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment"> * @copyright 2013 Hacking projects [http://www.hackingprojects.net/]</span></div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment"> * @copyright 2009 Sylvain Munaut (tnt@246tNt.com)</span></div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<a class="code" href="build_8h.html#a17c6430174bd106c2fa80061361f0f7b">RCSID</a>(<span class="stringliteral">&quot;$Id: 7c955398a865c22512ab16fab1428d09b541d513 $&quot;</span>)</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="preprocessor">#include &quot;comp128.h&quot;</span></div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="preprocessor">#include &lt;stdio.h&gt;</span></div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment">/* 512 bytes */</span></div><div class="line"><a name="l00045"></a><span class="lineno"><a class="line" href="comp128_8c.html#a62590521aad292649cc57f0a453c8489">   45</a></span>&#160;<span class="keyword">static</span> uint8_t <span class="keyword">const</span> comp128v1_t0[] = {</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;        102, 177, 186, 162, 2,   156, 112, 75,  55,  25,  8,   12,  251, 193, 246, 188,</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;        109, 213, 151, 53,  42,  79,  191, 115, 233, 242, 164, 223, 209, 148, 108, 161,</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;        252, 37,  244, 47,  64,  211, 6,   237, 185, 160, 139, 113, 76,  138, 59,  70,</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;        67,  26,  13,  157, 63,  179, 221, 30,  214, 36,  166, 69,  152, 124, 207, 116,</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;        247, 194, 41,  84,  71,  1,   49,  14,  95,  35,  169, 21,  96,  78,  215, 225,</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;        182, 243, 28,  92,  201, 118, 4,   74,  248, 128, 17,  11,  146, 132, 245, 48,</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;        149, 90,  120, 39,  87,  230, 106, 232, 175, 19,  126, 190, 202, 141, 137, 176,</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;        250, 27,  101, 40,  219, 227, 58,  20,  51,  178, 98,  216, 140, 22,  32,  121,</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;        61,  103, 203, 72,  29,  110, 85,  212, 180, 204, 150, 183, 15,  66,  172, 196,</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;        56,  197, 158, 0,   100, 45,  153, 7,   144, 222, 163, 167, 60,  135, 210, 231,</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;        174, 165, 38,  249, 224, 34,  220, 229, 217, 208, 241, 68,  206, 189, 125, 255,</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;        239, 54,  168, 89,  123, 122, 73,  145, 117, 234, 143, 99,  129, 200, 192, 82,</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;        104, 170, 136, 235, 93,  81,  205, 173, 236, 94,  105, 52,  46,  228, 198, 5,</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;        57,  254, 97,  155, 142, 133, 199, 171, 187, 50,  65,  181, 127, 107, 147, 226,</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;        184, 218, 131, 33,  77,  86,  31,  44,  88,  62,  238, 18,  24,  43,  154, 23,</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;        80,  159, 134, 111, 9,   114, 3,   91,  16,  130, 83,  10,  195, 240, 253, 119,</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;        177, 102, 162, 186, 156, 2,   75,  112, 25,  55,  12,  8,   193, 251, 188, 246,</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;        213, 109, 53,  151, 79,  42,  115, 191, 242, 233, 223, 164, 148, 209, 161, 108,</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;        37,  252, 47,  244, 211, 64,  237, 6,   160, 185, 113, 139, 138, 76,  70,  59,</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;        26,  67,  157, 13,  179, 63,  30,  221, 36,  214, 69,  166, 124, 152, 116, 207,</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;        194, 247, 84,  41,  1,   71,  14,  49,  35,  95,  21,  169, 78,  96,  225, 215,</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;        243, 182, 92,  28,  118, 201, 74,  4,   128, 248, 11,  17,  132, 146, 48,  245,</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;        90,  149, 39,  120, 230, 87,  232, 106, 19,  175, 190, 126, 141, 202, 176, 137,</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;        27,  250, 40,  101, 227, 219, 20,  58,  178, 51,  216, 98,  22,  140, 121, 32,</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;        103, 61,  72,  203, 110, 29,  212, 85,  204, 180, 183, 150, 66,  15,  196, 172,</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;        197, 56,  0,   158, 45,  100, 7,   153, 222, 144, 167, 163, 135, 60,  231, 210,</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;        165, 174, 249, 38,  34,  224, 229, 220, 208, 217, 68,  241, 189, 206, 255, 125,</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;        54,  239, 89,  168, 122, 123, 145, 73,  234, 117, 99,  143, 200, 129, 82,  192,</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;        170, 104, 235, 136, 81,  93,  173, 205, 94,  236, 52,  105, 228, 46,  5,   198,</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;        254, 57,  155, 97,  133, 142, 171, 199, 50,  187, 181, 65,  107, 127, 226, 147,</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;        218, 184, 33,  131, 86,  77,  44,  31,  62,  88,  18,  238, 43,  24,  23,  154,</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;        159, 80,  111, 134, 114, 9,   91,  3,   130, 16,  10,  83,  240, 195, 119, 253};</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="comment">/* 256 bytes */</span></div><div class="line"><a name="l00080"></a><span class="lineno"><a class="line" href="comp128_8c.html#ad4bff799d424f4f9897aed3c53f973fb">   80</a></span>&#160;<span class="keyword">static</span> uint8_t <span class="keyword">const</span> comp128v1_t1[] = {</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;        19,  11,  80,  114, 43,  1,   69,  94,  39,  18,  127, 117, 97,  3,   85,  43,</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;        27,  124, 70,  83,  47,  71,  63,  10,  47,  89,  79,  4,   14,  59,  11,  5,</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;        35,  107, 103, 68,  21,  86,  36,  91,  85,  126, 32,  50,  109, 94,  120, 6,</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;        53,  79,  28,  45,  99,  95,  41,  34,  88,  68,  93,  55,  110, 125, 105, 20,</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;        90,  80,  76,  96,  23,  60,  89,  64,  121, 56,  14,  74,  101, 8,   19,  78,</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;        76,  66,  104, 46,  111, 50,  32,  3,   39,  0,   58,  25,  92,  22,  18,  51,</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;        57,  65,  119, 116, 22,  109, 7,   86,  59,  93,  62,  110, 78,  99,  77,  67,</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;        12,  113, 87,  98,  102, 5,   88,  33,  38,  56,  23,  8,   75,  45,  13,  75,</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;        95,  63,  28,  49,  123, 120, 20,  112, 44,  30,  15,  98,  106, 2,   103, 29,</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;        82,  107, 42,  124, 24,  30,  41,  16,  108, 100, 117, 40,  73,  40,  7,   114,</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;        82,  115, 36,  112, 12,  102, 100, 84,  92,  48,  72,  97,  9,   54,  55,  74,</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;        113, 123, 17,  26,  53,  58,  4,   9,   69,  122, 21,  118, 42,  60,  27,  73,</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;        118, 125, 34,  15,  65,  115, 84,  64,  62,  81,  70,  1,   24,  111, 121, 83,</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;        104, 81,  49,  127, 48,  105, 31,  10,  6,   91,  87,  37,  16,  54,  116, 126,</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;        31,  38,  13,  0,   72,  106, 77,  61,  26,  67,  46,  29,  96,  37,  61,  52,</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;        101, 17,  44,  108, 71,  52,  66,  57,  33,  51,  25,  90,  2,   119, 122, 35};</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="comment">/* 128 bytes */</span></div><div class="line"><a name="l00099"></a><span class="lineno"><a class="line" href="comp128_8c.html#a63efe01c33d76cb7f35cd6bb1bbe95ee">   99</a></span>&#160;<span class="keyword">static</span> uint8_t <span class="keyword">const</span> comp128v1_t2[] = {</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;        52,  50,  44,   6,  21,  49,  41,  59,  39,  51,  25,  32,  51,  47,  52,  43,</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;        37,  4,   40,  34,  61,  12,  28,   4,  58,  23,   8,  15,  12,  22,   9,  18,</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;        55,  10,  33,  35,  50,   1,  43,   3,  57,  13,  62,  14,   7,  42,  44,  59,</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;        62,  57,  27,   6,   8,  31,  26,  54,  41,  22,  45,  20,  39,   3,  16,  56,</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;        48,  2,   21,  28,  36,  42,  60,  33,  34,  18,   0,  11,  24,  10,  17,  61,</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;        29,  14,  45,  26,  55,  46,  11,  17,  54,  46,   9,  24,  30,  60,  32,   0,</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;        20,  38,  2,   30,  58,  35,   1,  16,  56,  40,  23,  48,  13,  19,  19,  27,</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;        31,  53,  47,  38,  63,  15,  49,   5,  37,  53,  25,  36,  63,  29,   5,   7};</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="comment">/* 64 bytes */</span></div><div class="line"><a name="l00110"></a><span class="lineno"><a class="line" href="comp128_8c.html#ab449497d51d9e65dabf2cd58626fbb90">  110</a></span>&#160;<span class="keyword">static</span> uint8_t <span class="keyword">const</span> comp128v1_t3[] = {</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;        1,   5,   29,  6,   25,  1,   18,  23,  17,  19,  0,   9,   24,  25,  6,   31,</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;        28,  20,  24,  30,  4,   27,  3,   13,  15,  16,  14,  18,  4,   3,   8,   9,</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;        20,  0,   12,  26,  21,  8,   28,  2,   29,  2,   15,  7,   11,  22,  14,  10,</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;        17,  21,  12,  30,  26,  27,  16,  31,  11,  7,   13,  23,  10,  5,   22,  19};</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="comment">/* 32 bytes */</span></div><div class="line"><a name="l00117"></a><span class="lineno"><a class="line" href="comp128_8c.html#a0b3902d4a7d63906b187e14a8c4e6ee5">  117</a></span>&#160;<span class="keyword">static</span> uint8_t <span class="keyword">const</span> comp128v1_t4[] = {</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;        15,  12,  10,  4,   1,   14,  11,  7,   5,   0,   14,  7,   1,   2,   13,  8,</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;        10,  3,   4,   9,   6,   0,   3,   2,   5,   6,   8,   9,   11,  13,  15,  12};</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;</div><div class="line"><a name="l00121"></a><span class="lineno"><a class="line" href="comp128_8c.html#a42272c5ea4fe63c408555f27382406e3">  121</a></span>&#160;<span class="keyword">static</span> uint8_t <span class="keyword">const</span> *_comp128_table[] = { <a class="code" href="comp128_8c.html#a62590521aad292649cc57f0a453c8489">comp128v1_t0</a>, <a class="code" href="comp128_8c.html#ad4bff799d424f4f9897aed3c53f973fb">comp128v1_t1</a>, <a class="code" href="comp128_8c.html#a63efe01c33d76cb7f35cd6bb1bbe95ee">comp128v1_t2</a>, <a class="code" href="comp128_8c.html#ab449497d51d9e65dabf2cd58626fbb90">comp128v1_t3</a>, comp128v1_t4 };</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;<span class="comment">/* 256 bytes */</span></div><div class="line"><a name="l00124"></a><span class="lineno"><a class="line" href="comp128_8c.html#abc535633e21fb26749aef59a84158d41">  124</a></span>&#160;<span class="keyword">static</span> uint8_t <span class="keyword">const</span> comp128v23_t0[] = {</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;        197, 235, 60,  151, 98,  96,  3,   100, 248, 118, 42,  117, 172, 211, 181, 203,</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;        61,  126, 156, 87,  149, 224, 55,  132, 186, 63,  238, 255, 85,  83,  152, 33,</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;        160, 184, 210, 219, 159, 11,  180, 194, 130, 212, 147, 5,   215, 92,  27,  46,</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;        113, 187, 52,  25,  185, 79,  221, 48,  70,  31,  101, 15,  195, 201, 50,  222,</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;        137, 233, 229, 106, 122, 183, 178, 177, 144, 207, 234, 182, 37,  254, 227, 231,</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;        54,  209, 133, 65,  202, 69,  237, 220, 189, 146, 120, 68,  21,  125, 38,  30,</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;        2,   155, 53,  196, 174, 176, 51,  246, 167, 76,  110, 20,  82,  121, 103, 112,</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;        56,  173, 49,  217, 252, 0,   114, 228, 123, 12,  93,  161, 253, 232, 240, 175,</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;        67,  128, 22,  158, 89,  18,  77,  109, 190, 17,  62,  4,   153, 163, 59,  145,</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;        138, 7,   74,  205, 10,  162, 80,  45,  104, 111, 150, 214, 154, 28,  191, 169,</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;        213, 88,  193, 198, 200, 245, 39,  164, 124, 84,  78,  1,   188, 170, 23,  86,</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;        226, 141, 32,  6,   131, 127, 199, 40,  135, 16,  57,  71,  91,  225, 168, 242,</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;        206, 97,  166, 44,  14,  90,  236, 239, 230, 244, 223, 108, 102, 119, 148, 251,</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;        29,  216, 8,   9,   249, 208, 24,  105, 94,  34,  64,  95,  115, 72,  134, 204,</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;        43,  247, 243, 218, 47,  58,  73,  107, 241, 179, 116, 66,  36,  143, 81,  250,</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;        139, 19,  13,  142, 140, 129, 192, 99,  171, 157, 136, 41,  75,  35,  165, 26</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;};</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;<span class="comment">/* 256 bytes */</span></div><div class="line"><a name="l00144"></a><span class="lineno"><a class="line" href="comp128_8c.html#a1bf5be18cea6234a518954a54ccc9f4d">  144</a></span>&#160;<span class="keyword">static</span> uint8_t <span class="keyword">const</span> comp128v23_t1[] = {</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;        170, 42,  95,  141, 109, 30,  71,  89,  26,  147, 231, 205, 239, 212, 124, 129,</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;        216, 79,  15,  185, 153, 14,  251, 162, 0,   241, 172, 197, 43,  10,  194, 235,</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;        6,   20,  72,  45,  143, 104, 161, 119, 41,  136, 38,  189, 135, 25,  93,  18,</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;        224, 171, 252, 195, 63,  19,  58,  165, 23,  55,  133, 254, 214, 144, 220, 178,</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;        156, 52,  110, 225, 97,  183, 140, 39,  53,  88,  219, 167, 16,  198, 62,  222,</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;        76,  139, 175, 94,  51,  134, 115, 22,  67,  1,   249, 217, 3,   5,   232, 138,</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;        31,  56,  116, 163, 70,  128, 234, 132, 229, 184, 244, 13,  34,  73,  233, 154,</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;        179, 131, 215, 236, 142, 223, 27,  57,  246, 108, 211, 8,   253, 85,  66,  245,</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;        193, 78,  190, 4,   17,  7,   150, 127, 152, 213, 37,  186, 2,   243, 46,  169,</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;        68,  101, 60,  174, 208, 158, 176, 69,  238, 191, 90,  83,  166, 125, 77,  59,</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;        21,  92,  49,  151, 168, 99,  9,   50,  146, 113, 117, 228, 65,  230, 40,  82,</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;        54,  237, 227, 102, 28,  36,  107, 24,  44,  126, 206, 201, 61,  114, 164, 207,</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;        181, 29,  91,  64,  221, 255, 48,  155, 192, 111, 180, 210, 182, 247, 203, 148,</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;        209, 98,  173, 11,  75,  123, 250, 118, 32,  47,  240, 202, 74,  177, 100, 80,</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;        196, 33,  248, 86,  157, 137, 120, 130, 84,  204, 122, 81,  242, 188, 200, 149,</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;        226, 218, 160, 187, 106, 35,  87,  105, 96,  145, 199, 159, 12,  121, 103, 112</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;};</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;</div><div class="line"><a name="l00163"></a><span class="lineno"><a class="line" href="comp128_8c.html#a0304701c01325fbee210e956ecfb5d8a">  163</a></span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="comp128_8c.html#a0304701c01325fbee210e956ecfb5d8a">_comp128_compression_round</a>(uint8_t *x, <span class="keywordtype">int</span> <a class="code" href="acutest_8h.html#a4eacae1d9e7c39f8236bb36d4ececa77">n</a>, <span class="keyword">const</span> uint8_t *tbl)</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;{</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;        <span class="keywordtype">int</span> i, j, m, a, b, y, z;</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;        m = 4 - <a class="code" href="acutest_8h.html#a4eacae1d9e7c39f8236bb36d4ececa77">n</a>;</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;        <span class="keywordflow">for</span> (i = 0; i &lt; (1 &lt;&lt; <a class="code" href="acutest_8h.html#a4eacae1d9e7c39f8236bb36d4ececa77">n</a>); i++) {</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;                <span class="keywordflow">for</span> (j = 0; j &lt; (1 &lt;&lt; m); j++) {</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;                        a = j + i * (2 &lt;&lt; m);</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;                        b = a + (1 &lt;&lt; m);</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;                        y = (x[a] + (x[b] &lt;&lt; 1)) &amp; ((32 &lt;&lt; m) - 1);</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;                        z = ((x[a] &lt;&lt; 1) + x[b]) &amp; ((32 &lt;&lt; m) - 1);</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;                        x[a] = tbl[y];</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;                        x[b] = tbl[z];</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;                }</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;        }</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;}</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;</div><div class="line"><a name="l00179"></a><span class="lineno"><a class="line" href="comp128_8c.html#a7f442d38026c015efd256e76a921990b">  179</a></span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="comp128_8c.html#a7f442d38026c015efd256e76a921990b">_comp128_compression</a>(uint8_t *x)</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;{</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;        <span class="keywordtype">int</span> <a class="code" href="acutest_8h.html#a4eacae1d9e7c39f8236bb36d4ececa77">n</a>;</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;        <span class="keywordflow">for</span> (n = 0; n &lt; 5; n++) {</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;                <a class="code" href="comp128_8c.html#a0304701c01325fbee210e956ecfb5d8a">_comp128_compression_round</a>(x, n, _comp128_table[n]);</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;        }</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;}</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;</div><div class="line"><a name="l00187"></a><span class="lineno"><a class="line" href="comp128_8c.html#a5e99217608aeb1dabc679eeb9d2b22fd">  187</a></span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="comp128_8c.html#a5e99217608aeb1dabc679eeb9d2b22fd">_comp128_bitsfrombytes</a>(uint8_t *x, uint8_t *bits)</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;{</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;        <span class="keywordtype">int</span> i;</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;        memset(bits, 0x00, 128);</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;        <span class="keywordflow">for</span> (i = 0; i &lt; 128; i++) {</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;                <span class="keywordflow">if</span> (x[i &gt;&gt; 2] &amp; (1 &lt;&lt; (3 - (i &amp; 3)))) {</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;                        bits[i] = 1;</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;                }</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;        }</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;}</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;</div><div class="line"><a name="l00199"></a><span class="lineno"><a class="line" href="comp128_8c.html#a4c473f3b288df76d3bed9004d14ac1e5">  199</a></span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="comp128_8c.html#a4c473f3b288df76d3bed9004d14ac1e5">_comp128_permutation</a>(uint8_t *x, uint8_t *bits)</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;{</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;        <span class="keywordtype">int</span> i;</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;        memset(&amp;x[16], 0x00, 16);</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;        <span class="keywordflow">for</span> (i = 0; i &lt; 128; i++) {</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;                x[(i &gt;&gt; 3) + 16] |= bits[(i * 17) &amp; 127] &lt;&lt; (7 - (i &amp; 7));</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;        }</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;}</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;<span class="comment">/** Calculate comp128v1 sres and kc from ki and rand</span></div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;<span class="comment"> * This code derived from a leaked document from the GSM standards.</span></div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;<span class="comment"> * Some missing pieces were filled in by reverse-engineering a working SIM.</span></div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;<span class="comment"> * We have verified that this is the correct COMP128 algorithm.</span></div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;<span class="comment"> * The first page of the document identifies it as</span></div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;<span class="comment"> *      _Technical Information: GSM System Security Study_.</span></div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;<span class="comment"> *      10-1617-01, 10th June 1988.</span></div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;<span class="comment"> * The bottom of the title page is marked</span></div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;<span class="comment"> *      Racal Research Ltd.</span></div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;<span class="comment"> *      Worton Drive, Worton Grange Industrial Estate,</span></div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;<span class="comment"> *      Reading, Berks. RG2 0SB, England.</span></div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;<span class="comment"> *      Telephone: Reading (0734) 868601   Telex: 847152</span></div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;<span class="comment"> * The relevant bits are in Part I, Section 20 (pages 66--67).  Enjoy!</span></div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;<span class="comment"> * Note: There are three typos in the spec (discovered by reverse-engineering).</span></div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;<span class="comment"> * First, &quot;z = (2 * x[n] + x[n]) mod 2^(9-j)&quot; should clearly read</span></div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;<span class="comment"> *      &quot;z = (2 * x[m] + x[n]) mod 2^(9-j)&quot;.</span></div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;<span class="comment"> * Second, the &quot;k&quot; loop in the &quot;Form bits from bytes&quot; section is severely</span></div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;<span class="comment"> * botched: the k index should run only from 0 to 3, and clearly the range</span></div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;<span class="comment"> * on &quot;the (8-k)th bit of byte j&quot; is also off (should be 0..7, not 1..8,</span></div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;<span class="comment"> * to be consistent with the subsequent section).</span></div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;<span class="comment"> * Third, SRES is taken from the first 8 nibbles of x[], not the last 8 as</span></div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;<span class="comment"> * claimed in the document.  (And the document doesn&#39;t specify how Kc is</span></div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;<span class="comment"> * derived, but that was also easily discovered with reverse engineering.)</span></div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;<span class="comment"> * All of these typos have been corrected in the following code.</span></div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;<span class="comment"> * @param[out] sres     4 byte value derived from ki and rand.</span></div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;<span class="comment"> * @param[out] kc       8 byte value derived from ki and rand.</span></div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;<span class="comment"> * @param[in] ki        known only by the SIM and AuC (us in this case).</span></div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;<span class="comment"> * @param[in] rand      16 bytes of randomness.</span></div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00241"></a><span class="lineno"><a class="line" href="comp128_8h.html#a35fa4083227dc609086c80b66d05950d">  241</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="comp128_8c.html#a35fa4083227dc609086c80b66d05950d">comp128v1</a>(uint8_t sres[<span class="keyword">static</span> 4], uint8_t kc[<span class="keyword">static</span> 8],</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;               uint8_t <span class="keyword">const</span> ki[<span class="keyword">static</span> 16], uint8_t <span class="keyword">const</span> rand[<span class="keyword">static</span> 16])</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;{</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;        <span class="keywordtype">int</span> i;</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;        uint8_t x[32], bits[128];</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;        <span class="comment">/* x[16-31] = RAND */</span></div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;        memcpy(&amp;x[16], rand, 16);</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;        <span class="comment">/*</span></div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;<span class="comment">         *      Round 1-7</span></div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;<span class="comment">         */</span></div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;        <span class="keywordflow">for</span> (i = 0; i &lt; 7; i++) {</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;                <span class="comment">/* x[0-15] = Ki */</span></div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;                memcpy(x, ki, 16);      <span class="comment">//-V512</span></div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;                <span class="comment">/* Compression */</span></div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;                <a class="code" href="comp128_8c.html#a7f442d38026c015efd256e76a921990b">_comp128_compression</a>(x);</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;                <span class="comment">/* FormBitFromBytes */</span></div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;                <a class="code" href="comp128_8c.html#a5e99217608aeb1dabc679eeb9d2b22fd">_comp128_bitsfrombytes</a>(x, bits);</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;                <span class="comment">/* Permutation */</span></div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;                <a class="code" href="comp128_8c.html#a4c473f3b288df76d3bed9004d14ac1e5">_comp128_permutation</a>(x, bits);</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;        }</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;        <span class="comment">/*</span></div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;<span class="comment">         *      Round 8 (final)</span></div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;<span class="comment">         *      x[0-15] = Ki</span></div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;<span class="comment">         */</span></div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;        memcpy(x, ki, 16);              <span class="comment">//-V512</span></div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;        <span class="comment">/* Compression */</span></div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;        <a class="code" href="comp128_8c.html#a7f442d38026c015efd256e76a921990b">_comp128_compression</a>(x);</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;        <span class="comment">/* Output stage */</span></div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;        <span class="keywordflow">for</span> (i = 0; i &lt; 8; i += 2) sres[i &gt;&gt; 1] = x[i] &lt;&lt; 4 | x[i + 1];</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;        <span class="keywordflow">for</span> (i = 0; i &lt; 12; i += 2) {</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;                kc[i&gt;&gt;1] = (x[i + 18] &lt;&lt; 6) |</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;                           (x[i + 19] &lt;&lt; 2) |</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;                           (x[i + 20] &gt;&gt; 2);</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;        }</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;        kc[6] = (x[30] &lt;&lt; 6) | (x[31] &lt;&lt; 2);</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;        kc[7] = 0;</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;}</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;</div><div class="line"><a name="l00289"></a><span class="lineno"><a class="line" href="comp128_8c.html#aa9ad473cf971e220b69a35299eaaf4de">  289</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="comp128_8c.html#aa9ad473cf971e220b69a35299eaaf4de">_comp128v23</a>(uint8_t *rand, uint8_t <span class="keyword">const</span> *kxor)</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;{</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;        uint8_t temp[16];</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;        uint8_t km_rm[32];</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;        <span class="keywordtype">int</span> i, j, k, z;</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;        memset(&amp;temp, 0, <span class="keyword">sizeof</span>(temp));</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;        memcpy(km_rm, rand, 16);</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;        memcpy(km_rm + 16, kxor, 16);</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;        memset(rand, 0, 16);</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;        <span class="keywordflow">for</span> (i = 0; i &lt; 5; i++) {</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;                j = 0;</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;                <span class="keywordflow">for</span> (z = 0; z &lt; 16; z++) {</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;                        temp[z] = comp128v23_t0[comp128v23_t1[km_rm[16 + z]] ^ km_rm[z]];</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;                }</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;                <span class="keywordflow">while</span> ((1 &lt;&lt; i) &gt; j) {</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;                        k = 0;</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;                        <span class="keywordflow">while</span> ((1 &lt;&lt; (4 - i)) &gt; k) {</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;                                km_rm[(((2 * k) + 1) &lt;&lt; i) + j] =</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;                                        comp128v23_t0[comp128v23_t1[temp[(k &lt;&lt; i) + j]] ^ (km_rm[(k &lt;&lt; i) + 16 + j])];</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;                                km_rm[(k &lt;&lt; (i + 1)) + j] = temp[(k &lt;&lt; i) + j];</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;                                k++;</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;                        }</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;                        j++;</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;                }</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;        }</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;        <span class="keywordflow">for</span> (i = 0; i &lt; 16; i++) {</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;                <span class="keywordflow">for</span> (j = 0; j &lt; 8; j++) {</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;                        rand[i] = rand[i] ^ (((km_rm[(19 * (j + 8 * i) + 19) % 256 / 8] &gt;&gt; (3 * j + 3) % 8) &amp; 1) &lt;&lt; j);</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;                }</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;        }</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;}</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;<span class="comment">/** Calculate comp128v2 or comp128v3 sres and kc from ki and rand</span></div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;<span class="comment"> * @param[out] sres     4 byte value derived from ki and rand.</span></div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;<span class="comment"> * @param[out] kc       8 byte value derived from ki and rand.</span></div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;<span class="comment"> * @param[in] ki        known only by the SIM and AuC (us in this case).</span></div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;<span class="comment"> * @param[in] rand      16 bytes of randomness.</span></div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;<span class="comment"> * @param[in] v2        if true we use version comp128-2 else we use comp128-3.</span></div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00336"></a><span class="lineno"><a class="line" href="comp128_8h.html#a5d4168028ccd505946cb69b67abdd297">  336</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="comp128_8c.html#a5d4168028ccd505946cb69b67abdd297">comp128v23</a>(uint8_t sres[<span class="keyword">static</span> 4], uint8_t kc[<span class="keyword">static</span> 8],</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;                uint8_t <span class="keyword">const</span> ki[<span class="keyword">static</span> 16], uint8_t <span class="keyword">const</span> rand[<span class="keyword">static</span> 16], <span class="keywordtype">bool</span> v2)</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;{</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;        uint8_t k_mix[16];</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;        uint8_t rand_mix[16];</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;        uint8_t katyvasz[16];</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;        uint8_t <a class="code" href="acutest_8h.html#a1774127cd71a8c01a10b5afcf19f44e6">buffer</a>[16];</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;        <span class="comment">/* Every day IM suffling... */</span></div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;        <span class="keywordtype">int</span> i;</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;        <span class="keywordflow">for</span> (i = 0; i &lt; 8; i++) {</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;                k_mix[i] = ki[15 - i];</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;                k_mix[15 - i] = ki[i];</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;        }</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;        <span class="keywordflow">for</span> (i = 0; i &lt; 8; i++) {</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;                rand_mix[i] = rand[15 - i];</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;                rand_mix[15 - i] = rand[i];</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;        }</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;        <span class="keywordflow">for</span> (i = 0; i &lt; 16; i++) {</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;                katyvasz[i] = k_mix[i] ^ rand_mix[i];</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;        }</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;        <span class="keywordflow">for</span> (i = 0; i &lt; 8; i++) {</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;                <a class="code" href="comp128_8c.html#aa9ad473cf971e220b69a35299eaaf4de">_comp128v23</a>(rand_mix, katyvasz);</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;        }</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;        <span class="keywordflow">for</span> (i = 0; i &lt; 16; i++) {</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;                buffer[i] = rand_mix[15 - i];</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;        }</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;        <span class="keywordflow">if</span> (v2) {</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;                buffer[15] = 0x00;</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;                buffer[14] = 4 * (buffer[14] &gt;&gt; 2);</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;        }</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;        <span class="keywordflow">for</span> (i = 0; i &lt; 4; i++) {</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;                buffer[8 + i - 4] = buffer[8 + i];</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;                buffer[8 + i] = buffer[8 + i + 4];</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;        }</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;        <span class="comment">/*</span></div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;<span class="comment">         *      The algorithm uses 16 bytes until this point, but only 12 bytes are effective</span></div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;<span class="comment">         *      also 12 bytes coming out from the SIM card.</span></div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;<span class="comment">         */</span></div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;        memcpy(sres, buffer, 4);</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;        memcpy(kc, buffer + 4, 8);</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;}</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;<span class="preprocessor">#if 0</span></div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;<span class="preprocessor">#include &lt;stdlib.h&gt;</span></div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;<span class="preprocessor">#include &lt;ctype.h&gt;</span></div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> hextoint(<span class="keywordtype">char</span> x)</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;{</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;        x = toupper(x);</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;        <span class="keywordflow">if</span> (x &gt;= <span class="charliteral">&#39;A&#39;</span> &amp;&amp; x &lt;= <span class="charliteral">&#39;F&#39;</span>) {</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;                <span class="keywordflow">return</span> x-<span class="charliteral">&#39;A&#39;</span> + 10;</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (x &gt;= <span class="charliteral">&#39;0&#39;</span> &amp;&amp; x &lt;= <span class="charliteral">&#39;9&#39;</span>) {</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;                <span class="keywordflow">return</span> x-<span class="charliteral">&#39;0&#39;</span>;</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;        }</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;        fprintf(stderr, <span class="stringliteral">&quot;Bad input.\n&quot;</span>);</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;        <a class="code" href="debug_8h.html#afc219e3f1054a6c4869cea9866aaa594">fr_exit_now</a>(EXIT_FAILURE);</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;}</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;<span class="keywordtype">int</span> <a class="code" href="radclient_8c.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a>(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> **argv)</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;{</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;        uint8_t rand[16], key[16], sres[4], kc[8];</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;        <span class="keywordtype">int</span> version;</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;        <span class="keywordtype">int</span> i;</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;        <span class="keywordflow">if</span> ((argc != 4) ||</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;            (strlen(argv[1]) != 34) || (strlen(argv[2]) != 34) ||</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;            (strncmp(argv[1], <span class="stringliteral">&quot;0x&quot;</span>, 2) != 0) || (strncmp(argv[2], <span class="stringliteral">&quot;0x&quot;</span>, 2) != 0) ||</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;            !(version = atoi(argv[3]))) {</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;        error:</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;                fprintf(stderr, <span class="stringliteral">&quot;Usage: %s 0x&lt;key&gt; 0x&lt;rand&gt; [1|2|3]\n&quot;</span>, argv[0]);</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;                <a class="code" href="debug_8h.html#afc219e3f1054a6c4869cea9866aaa594">fr_exit_now</a>(EXIT_FAILURE);</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;        }</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;        <span class="keywordflow">for</span> (i = 0; i &lt; 16; i++) {</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;                key[i] = (hextoint(argv[1][(2 * i) + 2]) &lt;&lt; 4) | hextoint(argv[1][(2 * i) + 3]);</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;        }</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;        <span class="keywordflow">for</span> (i = 0; i &lt; 16; i++) {</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;                rand[i] = (hextoint(argv[2][(2 * i) + 2]) &lt;&lt; 4) | hextoint(argv[2][(2 * i) + 3]);</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;        }</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;        <span class="keywordflow">switch</span> (version) {</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;        <span class="keywordflow">case</span> 3:</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;                <a class="code" href="comp128_8c.html#a5d4168028ccd505946cb69b67abdd297">comp128v23</a>(sres, kc, key, rand, <span class="keyword">false</span>);</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;        <span class="keywordflow">case</span> 2:</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;                <a class="code" href="comp128_8c.html#a5d4168028ccd505946cb69b67abdd297">comp128v23</a>(sres, kc, key, rand, <span class="keyword">true</span>);</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;        <span class="keywordflow">case</span> 1:</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;                <a class="code" href="comp128_8c.html#a35fa4083227dc609086c80b66d05950d">comp128v1</a>(sres, kc, key, rand);</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;        <span class="keywordflow">default</span>:</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;                fprintf(stderr, <span class="stringliteral">&quot;Invalid version, must be 1, 2 or 3&quot;</span>);</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;                <span class="keywordflow">goto</span> error;</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;        }</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;        <span class="comment">/* Output in vector format &lt;Ki&gt;,&lt;rand&gt;,&lt;sres&gt;&lt;Kc&gt; */</span></div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;        <span class="keywordflow">for</span> (i = 0; i &lt; 16; i++) {</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;                printf(<span class="stringliteral">&quot;%02X&quot;</span>, key[i]);</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;        }</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;        printf(<span class="stringliteral">&quot;,&quot;</span>);</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;        <span class="keywordflow">for</span> (i = 0; i &lt; 16; i++) {</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;                printf(<span class="stringliteral">&quot;%02X&quot;</span>, rand[i]);</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;        }</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;        printf(<span class="stringliteral">&quot;,&quot;</span>);</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;        <span class="keywordflow">for</span> (i = 0; i &lt; 4; i++) {</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;                printf(<span class="stringliteral">&quot;%02X&quot;</span>, sres[i]);</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;        }</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;        <span class="keywordflow">for</span> (i = 0; i &lt; 8; i++) {</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;                printf(<span class="stringliteral">&quot;%02X&quot;</span>, kc[i]);</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;        }</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;        printf(<span class="stringliteral">&quot;\n&quot;</span>);</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;        <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;}</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;<span class="preprocessor">#endif</span></div><div class="ttc" id="comp128_8c_html_a35fa4083227dc609086c80b66d05950d"><div class="ttname"><a href="comp128_8c.html#a35fa4083227dc609086c80b66d05950d">comp128v1</a></div><div class="ttdeci">void comp128v1(uint8_t sres[static 4], uint8_t kc[static 8], uint8_t const ki[static 16], uint8_t const rand[static 16])</div><div class="ttdoc">Calculate comp128v1 sres and kc from ki and rand. </div><div class="ttdef"><b>Definition:</b> <a href="comp128_8c_source.html#l00241">comp128.c:241</a></div></div>
<div class="ttc" id="debug_8h_html_afc219e3f1054a6c4869cea9866aaa594"><div class="ttname"><a href="debug_8h.html#afc219e3f1054a6c4869cea9866aaa594">fr_exit_now</a></div><div class="ttdeci">#define fr_exit_now(_x)</div><div class="ttdoc">Exit without calling atexit() handlers, producing a log message in debug builds. </div><div class="ttdef"><b>Definition:</b> <a href="debug_8h_source.html#l00231">debug.h:231</a></div></div>
<div class="ttc" id="comp128_8c_html_a0304701c01325fbee210e956ecfb5d8a"><div class="ttname"><a href="comp128_8c.html#a0304701c01325fbee210e956ecfb5d8a">_comp128_compression_round</a></div><div class="ttdeci">static void _comp128_compression_round(uint8_t *x, int n, const uint8_t *tbl)</div><div class="ttdef"><b>Definition:</b> <a href="comp128_8c_source.html#l00163">comp128.c:163</a></div></div>
<div class="ttc" id="comp128_8c_html_a7f442d38026c015efd256e76a921990b"><div class="ttname"><a href="comp128_8c.html#a7f442d38026c015efd256e76a921990b">_comp128_compression</a></div><div class="ttdeci">static void _comp128_compression(uint8_t *x)</div><div class="ttdef"><b>Definition:</b> <a href="comp128_8c_source.html#l00179">comp128.c:179</a></div></div>
<div class="ttc" id="radclient_8c_html_a3c04138a5bfe5d72780bb7e82a18e627"><div class="ttname"><a href="radclient_8c.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a></div><div class="ttdeci">int main(int argc, char **argv)</div><div class="ttdef"><b>Definition:</b> <a href="radclient_8c_source.html#l01115">radclient.c:1115</a></div></div>
<div class="ttc" id="comp128_8c_html_a5e99217608aeb1dabc679eeb9d2b22fd"><div class="ttname"><a href="comp128_8c.html#a5e99217608aeb1dabc679eeb9d2b22fd">_comp128_bitsfrombytes</a></div><div class="ttdeci">static void _comp128_bitsfrombytes(uint8_t *x, uint8_t *bits)</div><div class="ttdef"><b>Definition:</b> <a href="comp128_8c_source.html#l00187">comp128.c:187</a></div></div>
<div class="ttc" id="comp128_8c_html_a62590521aad292649cc57f0a453c8489"><div class="ttname"><a href="comp128_8c.html#a62590521aad292649cc57f0a453c8489">comp128v1_t0</a></div><div class="ttdeci">static uint8_t const comp128v1_t0[]</div><div class="ttdef"><b>Definition:</b> <a href="comp128_8c_source.html#l00045">comp128.c:45</a></div></div>
<div class="ttc" id="acutest_8h_html_a1774127cd71a8c01a10b5afcf19f44e6"><div class="ttname"><a href="acutest_8h.html#a1774127cd71a8c01a10b5afcf19f44e6">buffer</a></div><div class="ttdeci">static int const char char buffer[256]</div><div class="ttdef"><b>Definition:</b> <a href="acutest_8h_source.html#l00473">acutest.h:473</a></div></div>
<div class="ttc" id="comp128_8c_html_a4c473f3b288df76d3bed9004d14ac1e5"><div class="ttname"><a href="comp128_8c.html#a4c473f3b288df76d3bed9004d14ac1e5">_comp128_permutation</a></div><div class="ttdeci">static void _comp128_permutation(uint8_t *x, uint8_t *bits)</div><div class="ttdef"><b>Definition:</b> <a href="comp128_8c_source.html#l00199">comp128.c:199</a></div></div>
<div class="ttc" id="comp128_8c_html_a63efe01c33d76cb7f35cd6bb1bbe95ee"><div class="ttname"><a href="comp128_8c.html#a63efe01c33d76cb7f35cd6bb1bbe95ee">comp128v1_t2</a></div><div class="ttdeci">static uint8_t const comp128v1_t2[]</div><div class="ttdef"><b>Definition:</b> <a href="comp128_8c_source.html#l00099">comp128.c:99</a></div></div>
<div class="ttc" id="acutest_8h_html_a4eacae1d9e7c39f8236bb36d4ececa77"><div class="ttname"><a href="acutest_8h.html#a4eacae1d9e7c39f8236bb36d4ececa77">n</a></div><div class="ttdeci">int n</div><div class="ttdef"><b>Definition:</b> <a href="acutest_8h_source.html#l00476">acutest.h:476</a></div></div>
<div class="ttc" id="comp128_8c_html_a5d4168028ccd505946cb69b67abdd297"><div class="ttname"><a href="comp128_8c.html#a5d4168028ccd505946cb69b67abdd297">comp128v23</a></div><div class="ttdeci">void comp128v23(uint8_t sres[static 4], uint8_t kc[static 8], uint8_t const ki[static 16], uint8_t const rand[static 16], bool v2)</div><div class="ttdoc">Calculate comp128v2 or comp128v3 sres and kc from ki and rand. </div><div class="ttdef"><b>Definition:</b> <a href="comp128_8c_source.html#l00336">comp128.c:336</a></div></div>
<div class="ttc" id="build_8h_html_a17c6430174bd106c2fa80061361f0f7b"><div class="ttname"><a href="build_8h.html#a17c6430174bd106c2fa80061361f0f7b">RCSID</a></div><div class="ttdeci">#define RCSID(id)</div><div class="ttdef"><b>Definition:</b> <a href="build_8h_source.html#l00218">build.h:218</a></div></div>
<div class="ttc" id="comp128_8c_html_aa9ad473cf971e220b69a35299eaaf4de"><div class="ttname"><a href="comp128_8c.html#aa9ad473cf971e220b69a35299eaaf4de">_comp128v23</a></div><div class="ttdeci">static void _comp128v23(uint8_t *rand, uint8_t const *kxor)</div><div class="ttdef"><b>Definition:</b> <a href="comp128_8c_source.html#l00289">comp128.c:289</a></div></div>
<div class="ttc" id="comp128_8c_html_ad4bff799d424f4f9897aed3c53f973fb"><div class="ttname"><a href="comp128_8c.html#ad4bff799d424f4f9897aed3c53f973fb">comp128v1_t1</a></div><div class="ttdeci">static uint8_t const comp128v1_t1[]</div><div class="ttdef"><b>Definition:</b> <a href="comp128_8c_source.html#l00080">comp128.c:80</a></div></div>
<div class="ttc" id="comp128_8c_html_ab449497d51d9e65dabf2cd58626fbb90"><div class="ttname"><a href="comp128_8c.html#ab449497d51d9e65dabf2cd58626fbb90">comp128v1_t3</a></div><div class="ttdeci">static uint8_t const comp128v1_t3[]</div><div class="ttdef"><b>Definition:</b> <a href="comp128_8c_source.html#l00110">comp128.c:110</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Thu Nov 12 2020 17:24:32 by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
